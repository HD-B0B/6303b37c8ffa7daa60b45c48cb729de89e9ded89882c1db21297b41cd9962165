---

Title: AI SAAS Realtime Video Sharing + Desktop App: AWS, Cloudfront, Nextjs, Electron, Express, Socket.io

---

$975 million that's how much Loom was acquired for but the question here for assas developers is not what they did to accomplish this but what goes into building an application so powerful and today you will learn how to build an application just as powerful as Loom from Real Time streaming to revolutionizing client acquisition this video is going to teach you far more than just SAS development the project that we'll be building today is called opal and opal is going to revolutionize client Outreach now before we start building the project we need to understand what we're building and how everything works under the hood so please do not skip this or the next module because I'm going to explain the backbone for the entire application now the target mark market for opal is Freelancers agency owners and business owners and instead of the traditional approach of sending thousands of CMS to prospects online opal can help them build personalized videos that they can send to their prospects that are instantly available when they stop recording that means in this project you will learn how to save and stream videos in real time and the best part is we're not going to be using a third-party Library we're going to build every single thing from scratch now the biggest problem with reaching out to prospects and sending them resources is you'll never know if they engaged with the resource that means did they even find it useful and you're not going to be able to follow up with your customers and for that reason when a viewer clicks on an opal video we will send our users a notification this way our users can follow up with their prospects and close more deals this strategy that I created was implemented in a student's business inside prodigy University and they took their business from $0 to $115,000 in less than 2 weeks you can also call this a loom clone if you like but we also implemented AI features into opal users who have a pay tier are going to get access to opal AI they can leverage AI to create titles descriptions a summary for the entire video and also extract the transcript from the video itself now if you are a creative person you could leverage this transcript itself and create an email marketing campaign using something like chat gbt the possibilities of opal is unlimited you could literally send a birthday wish to a friend in less than 5 seconds so the application that you're building today is extremely valuable that means you don't have to stick around that price point of $97 or $100 per month you can charge $500 per month if you have the value to offer and before we get started the sponsor of today's C coffee is 5 Minute Podcast 940 thank you so much for supporting us and giving back to the web prodigies Community this way we are able to give you so much more free value just like this and my goal here is very straightforward I want to help SAS developers quit their 9 to-5 and attain Financial Freedom through their SAS and the best way for me to do that is to give away all this value completely for free and then hopefully you take action and you start and scale your SAS to $20,000 per month and then yours truly can invest his time and energy into your SAS business and help you scale to the Moon with the strategies that I have seen working in companies over and over again and with that being said let's get started we will be using bun or npm AWS and S3 buckets shat C nuui Tailwind CSS neon for our database the latest stable version of nextjs Prisma node mailer stripe Z and react hook forms Redux clerk authentication typescript react query for server side States and caching electronjs VJs and vanilla react to build a native application for both Windows and Mac OS that allows users to connect their camera their microphone and their screens socket IO to upload video chunks in real time to AWS simultaneously Express to build a backend whisper AI for video transcriptions open AI for titles and descriptions CMS feature from Wix studio and finally voice flow for an advanced AI agent that can understand the video context allowing users to ask questions and get AI powered support here's a quick demo of opal opal has two different type of pricing plans the free tier and the Pro Plan now this slide is important because based on the plan that the user has we're going to need to build the application in such a way that we can give proplan members access to their premium features okay so take a mental screenshot of this we're going to need this in this project now free tier members can only upload 25 videos per month and each video can only be 5 minutes long recorded in 720p only okay now every member also gets access to a free workspace and this workspace acts as a personal workspace so users cannot invite other members into their personal workspace feature members also have the ability to try AI features before they commit to a pay plan super cool pricing model we're going to teach you how to do that okay the Pro Plan on the other hand gives the user unlimited access to opal that's it so all videos can also be recorded in 1080P with the Pro Plan and they can also swap between 1080P and 720p based on their preference users can sign into the application using Google authentication and once they are successfully signed up they're redirected to the library page this is where they can see the folders along with the videos that they have recorded now the best part of opal is not only are we going to be building a web application version we're also going to be building a native desktop application using electronjs the first awesome feature of opal is optimistic UI when the user tries to create a folder the data instantly reflects on the client side even though this is done on the server this means no more load times and your application is going to feel blazing fast to rename a folder just go ahead and double click the title now you can change it to whatever you like and if you click outside that's going to save the title name the notifications tab shows all of the notifications that the user received the bildings page shows their current plan and the settings page is going to give the user the ability to add light mode dark mode or even change enable first View mode this means when a prospect views a video the user will get a notification and that notification of course can be accessed through the notifications page the homeage acts like an onboarding guide that we will be building using CMS only that means our team members can get access to the CMS and they can launch campaigns or share new updates on newer features Fe inside opal the workspaces tab down here shows all of the public workspaces that the user has been invited into this means that the user is dedicated a personal workspace and they can also join other public workspaces as well if you click on a video right here this will take you into the video dashboard this is essentially the page where you can see the summary the AI given titles and the descriptions for the video as well you can also play this video if you'd like to watch it or you can click on the tabs on the right side the first one is opal AI which is our AI tool free tier members have the option to try AI features before purchasing a Pro Plan and if they want to pay they can also go ahead and upgrade their plan to get unlimited access to AI features the next tab is the transcript tab inside this tab you can see the transcript of the video and this feature is also powered by AI inside the activity tab prospects can leave comments on the user's video so for example I'm going to say amazing video and if I hit enter the comment will show right below these components are also recursive that means users can respond back to a comment and respond to comments infinitely if for some reason the AI did not do a good job with the title and the description you can update this information by clicking on the edit icon click on update and the information will also be updated in real time users can upgrade to a Pro Plan by clicking on the upgrade button and that takes them to a stripe hosted page where they can enter their credit card information for $99 per month so for example I'm going to go ahead and click on subscribe and this is going to take us back back into the dashboard once the payment is successful awesome and now because the user is on a Pro Plan we are no longer showing the upgrade button switching to a public workspace gives the user the ability to invite other users into their public workspace the invite to workspace button has an optimized search feature that gives the user the ability to search and add users directly into their workspace the invited user also gets an email notification where they can directly click on the link to accept their invite now because I am not signed in with the right account it's going to give me a not authorized page now I signed in with the correct account and I also have the new workspace that I just got invited into users can also move videos from one folder to another so as you can see I'm going to move this and just like that it is now moved into the client Outreach folder now the most powerful part of opal is users can directly copy a link to a video and they can share it with their prospects and if you open that link you will see a preview version now my favorite feature in opal is the embed code if you click on this button users get a piece of code that they can paste inside an email but this feature is so powerful because if you paste this link inside an email it will also show a custom thumbnail for that video this way you can instantly grab your prospects attention because they can see exactly what you're speaking about before they even click on the video and of course the title and the description is also pasted in here you can change it if you like to now let's quickly take a look at our electron version of our application first step is to go ahead and sign in into clerk Authentication so let's go ahead and click on sign in and then we can go ahead and click on the account that we wish to sign in with and that's pretty much it now the first step is to prompt the user to give security access to their microphone and desktop settings so let me go ahead and do that first all right there you go opal now has access to my microphone and the different screens that I have available on my computer the first step is opal will look into the database to see the settings that the user has set as a preset for their opal application so if I already created a preset or used some devices in the past opal is going to go ahead and remember that so the next time I sign in it's going to use the same devices now because I'm a new user it's going to look at the available devices and set the first device as the default setting now the next window that you're going to see down here is called the studio Tri this has access to the recording feature along with a popup that can show the screen that I am currently recording and you can access that widget by clicking on this icon and then setting the screen that you wish to see and you can see a small little recording here which I think is a really cool feature and this will also not show when you're recording the screen itself another feature is when the user starts to record the main window which we call the studio will also be hidden so that's not going to be there in the video as well now I hope you remember each tier has access to different features if you're on a Pro Plan you can record your screen and your video camera in 1080P and if you want to change that to a lower resolution you can select between the available options now we are saving and streaming this video from AWS so you're going to learn how to use Amazon web services in this video now because we are saving and streaming in real time which means we're going to be taking buffer data and sending it across into a server and then processing all this buffer data creating a temporary file and then pushing that file to AWS we're going to need web sockets and we will also be using socket.io in this project now to make this work we're also going to need a separate application that's essentially our server which is going to be made using our Express server so let's go ahead and take a look at that another cool feature to point out is our opal application is essentially a layout on top of all of other applications as well so even if you are on full screen mode you can still record your screen and now the first thing as you can see my socket is connected and my video chunks are being saved in real time that means as everything is running right now as we're recording it's being sent to AWS okay so we're creating this uh file essentially right here and then we're going to push this so now if I stop this video it's going to save everything and it's going to let me know that it's successfully uploaded to AWS so let's go ahead and stop this video there we go it's successfully uploaded now so let's go to our dashboard and take a look and see what's going on okay if you go to your dashboard now you can find the screen recording that I just made right here and if you click on it you're going to notice that we have an AI generated title a description and we also have the transcript that is instantly available to us and of course you can also play the video listen to it and watch it if you want to so before we get started I would like for you to understand the architecture of the entire application how do all the building blocks and opal connect to one another this is the most important part of this entire build so so please give me some of your attention stop what you're doing and focus because if you skip this part in this project nothing else will make sense from here on so just like every other application this application also has a couple building blocks the first one is nextjs nextjs will serve as the front end for our application we will also host a couple endpoints where we can call this application to store some data or get some data from the database as well the next one is our database so let's go ahead and say DB right here awesome the next building block is the authentication system for our app so I'm going to use clerk for our authentication system and finally we're going to need a way to connect our users native devices to our application as well because we not only want to record the browser we want to give the user to record their entire screen which means we're going to need access to the operating system and this is going to be possible through electronjs electronjs is a free open source software framework developed and maintained by openjs Foundation the framework is designed to create desktop applications using web technologies that are rendered using a version of the Chromium browser and the nodejs runtime environment and that's how we're able to build native applications using some like react or JavaScript now these building blocks serve as the main backbone for our app but there's more to this as a dependent you can think about it as a dependency for all of these to actually work so since we're using realtime data that means while the user is recording their screen we are instantly saving these video chunks which means we're going to need something that leverages sockets now since we can't use sockets in nextjs we got to figure out another way and the best way right now is to create another Express server right here and this Express server is going to have sockets listening to when data comes in from our electron application now we'll get to more details I just want to show you the overall building blocks of this app the next thing is we're going to need a file storage location and this time we are not using any sort of third party Library this time we're using AWS and in simple terms AWS offers a range of services cloud services to help SAS companies build such projects now AWS has more than 200 different services so we are not even going to scrape the surface cuz we're just using one of these services and the service that we'll be using this time is called S3 buckets so Amazon's S3 stands for simple storage service and it is a cloud object storage service that allows you or allows companies to store retrieve and manage files or data from anywhere and the final component here that's going to make all of this possible is cloudfront cloudfront is going to help us stream these videos or whatever we're storing inside our S3 bucket to our application and the reason why we need cloudfront is the S3 bucket is actually private and because of this we can't directly stream to our front end so we're going to need a service in between kind of like a middleman to help us do this so when the user first logs into our platform there are two actions that are needed to be performed first we need to send all the information to Clerk and authenticate the user and the second action is we need to create the user's profile itself inside opo so clerk is going to give us the clerk ID the profile stuff right like the image their Avatar image their name emails all that kind of stuff we're going to we're going to take that information and we're going to store it in our database so first request goes to clerk clerk will send a response back to our endpoint and this endpoint is the call back URL and once that is successful you'll immediately go and create the user inside the database like this and we'll get a response saying success as well and that's it for authentication with our front end application now in our native version which is our electronjs version we're also going to need to verify and authenticate the user here as well so in our electron version the user can also sign in and sign up so this is something that no one has showed you on YouTube which is how to use clerk in a native application so first thing we're going to do here is we're going to send a request to Clerk and clerk is going to send us the same profile info that we need and the main key here is through this process we're going to get the clerk ID okay this clerk ID is going to help us navigate our user from our database as well now our electronjs application also has settings for the user and what this means is what device are they're trying to record on their microphone settings their camera all this kind of stuff is stored inside our database so we're going to need this profile information so to get this profile object we're going to take this clerk ID we're going to make a request to our nextjs application our nextjs application is going to make a request to the database and it's going to send us this user profile and once this is successful we can go ahead and send that data to our electron version and now that we have all of the user profile information we can sync everything up with the electron app so they're going to have all the data stored directly in there but of course since the user is not already a part of the application they just opened up an account they're not going to have a setting for their default screen or the default microphone so what do we do now well the first thing let me just scroll down here is we need to get access to their native components right we're going to need the the available screens and the microphone so what we're going to do in our electron application is we're going to create some sort of an array and inside this array we're going to get access to all of the microphones that are available and all of the screens that are available as well okay and once we get access to this we're now going to take the first one from this and set it as the default okay and the same thing for the microphone as well at least this is how I would expect it to work being a user I would want it to immediately grab the first available microphone and screen and then of course since this is an array you you can swap between which screen you want to show microphone or camera now once the user is authenticated and all their information is in sync the next thing is we need to establish a connection between our electron application and the express server this way we can broadcast anything like the streaming files or establish a connection and show the user that everything is real time so here's what we're going to do to establish this connection first once the user signs up we're going to need to broadcast an API key so let me change that to API key just like this and this API key is going to go to our Express server right here and once the express server receives this it's going to send a uh pretty much send a response back to our electron application letting us know that the connection is successful now once this connection is established only then can we send chunks and data like recording files to this Express server using the socket connection okay now I'm going to break this down even more but I just want to show you why we need to establish the first connection so now that we have understood why we need an electronjs version of our application an Express server and a socket IO connection between these servers let's get into understanding the individual components within the electronjs version and and our Express server itself okay so first let's break down our electron application and let's understand how it truly works under the hood so in a traditional react application let's say this was the window right here or maybe let's go to a new page so let's say this was the window right or the browser if we wanted to have a component here that acts like the control panel well we would create a little div here right and if we needed a tray again we'll create another for the tray and if we're showing the users's camera or you know whatever if they have an image here then we'd also need to show a create another div for this just give it some styling and all of this would work under one browser right it's one react application but in electronjs it's slightly different so assuming that this is the user's computer and they are on a Mac I just created a little dock there I guess you get the whole point if we wanted to show a plugin sort of like a control panel right the exact same example but we're converting this to a native application and then we have the tray at the bottom here and we have the users camera we would need to create individual applications or individual renders for each of these so this in itself is a window okay so we need to render three windows and each of these windows act as an individual react application so very different from the other approach which is in the browser because in the browser we have one react application and we're just creating little elements around here and there right but in this one it's essentially three different renders itself so three different Windows which act like three different react applications and our main file is going to help us create those windows when we start the application first okay so we're going to create three Windows here 1 2 3 just like this and that's the task of the main file now there are more tasks in the main file for example since each of these are individual react applications we also need to have individual HTML files for each of these windows correct so that's why we're going to have the HTML files also load into these applications in the main file as well so the main file takes care of setting up these HTML files right and kind of like injecting it into the renders the windows itself and of course it's also going to initiate an instantiate the windows to render on the user's computer okay the other thing we're doing inside the main is we're setting up something called IPC events now if the word sounds crazy it is very simple think about it this way now if we have three different windows and we want to transfer information or data between different windows we would need to use some sort of a state provider so IPC renders allow us to sort of share this state or share information or events between different windows so let's say the user logged in on this window and we need to share that state into all other windows as well we can use the IPC event to fire an event on all of these windows these listeners will basically look for these events and when the events occur it's going to understand that okay I have some data coming in so I'm going to pretty much sync up whatever is coming in as well right so that's the whole point of IPC events let's summarize that IPC events is kind of like triggering an event to a different window okay that's pretty much it so we're going to also set that up inside the main file so it's safe to say that we have one more component that we can add to this which is IPC renderer and the IPC renderer is kind of like the API that gives us access to the IPC events the next one is called called the media resource and the job of the media resource is essentially to just get access to the users screens okay so remember when I told you in the beginning we are getting the user settings from our database right which is a one single ID and based on the preferred screen we're going to look at the available screens on the user's computer and we're going to use the first one if they don't have anything set already right so this media resource is going to help us get all of the screens that are available on the user's computer and if the user has a saved preference inside the database we're going to use that setting that they provided in there and we're going to select that from this media resource array and pick that specific screen and set it as a current default okay and if there's nothing of course we're just going to take the first element from this array and set it in here so you see why we need the media resource part of the electron application now the next part of the electron application which is also the most important one is the media stream this section is going to pretty much consist of everything related to using an API to create a buffer stream so we can send it to another backend okay and I'll show you what we're using in here to make this work so un under the media stream we have something called the Navigator API this Navigator API does one simple task which is it provides buffer streams for our screen recording buffer stream data essentially so we can use this buffer stream data and send it somewhere but something needs to record the screen for us to get buffer stream data from that so essentially the media stream is responsible for recording the screen okay so we record the screen recording the screen let me put it here so you guys can see and the Navigator API is responsible for providing the buffer stream data okay so now you see how these to kind of uh come together right so now that we have the buffer stream data and we have you know I mean which we're getting from the screen recording stuff we also need to send this data or perform some actions on this data how can we do that well that's the next section of the electron application which is called the media recorder the media recorder is responsible for giving you an API into which you can pass in the stream data so the media stream that we have you can pass it into the media recorder and the media recorder is going to give you access to some methods okay that you can use on the media stream which is start so start recording or stop recording and finally the most important one which is data available and I think there are more methods as well but I I think you get the point right this media stream once it's passed into the media recorder gives us access to these three methods and we can invoke these methods on the media recorder to essentially perform the following actions which is to start recording or to stop right so this is basically like an it's just an API like an instance that we're creating passing it into the media recorder and then we can use all these actions right here now what is the point of the data available method the reason why this application is so powerful is because we are sending and saving realtime video stream data which means if we have a client here we're literally sending videos as the user is recording them on their screen that way we can create a file on the server side right on our Express server and we can store all this buffer stream data into this as time goes and eventually when the user is done recording we can start and then save this file as a whole right so that's what this data available is going to help us with which is creating a timer like structure So based on a timer we can send the data to our backend which is send these chunks the buffer stream chunks to our Express server so let me just also mention it right here so when you start recording you can add a timer okay this is the benefit of using the data available method and this timer right now in our application is 1 second okay so every second it's going to fire the call back think about it that way right and the Callback function will essentially send the buffer stream chunks to our Express server and again we're doing this with the help of web sockets and this is why we need our websocket connection before we start anything all right so these are all the components in our electron application there's still more but hopefully this makes sense I told you it was a complex project I mean it makes sense the application was sold for $800 million and it solved such a big problem right so there's a lot that goes into this and we're building it completely from scratch right we're not using any thirdparty Library so as a result it is going to be quite complex so just bear with me but I'm trying to make this as easy as possible to follow by explaining every single step so you understand exactly what we're typing in the code okay so the next thing I want to help you understand is what happens while we're using the data available method and constantly streaming data to our Express server what does the express server do while the data is being streamed in real time so before we jump into what happens when we stop or you know the final uh pretty much the final stage of uploading the video Let's understand what happens on the express side with the Stream data being sent in real time to the express server okay so our Express server again is made out of you know a couple stages right so when the data first comes in the first thing we're doing is we're creating something we call a buffer array and these uh the buffer array essentially takes each chunk that is sent in real time and append it to this buffer array then our next step is we're going to convert this buffer array to to a blob and once we convert it into a blob we need to create a readable stream and now that we have this readable stream we need to pipe the readable stream to a right stream into the file system right so essentially we create this file that's inside the express servers file system and we are constantly piping the data that comes in and gets appended to our buffer array right we're going to constantly append it kind of like I mean you can think about it as a pending right but we're adding it to this files uh this file that we created inside our file system that's pretty much what we're doing okay we're piping the readable stream data so let me go ahead and mention that here so pipe a readable stream to a WR stream okay and this way we can send it to the file system all right so these are the steps that take place in our express application nothing too complex is just a sequence of steps that happen while we are sending data sending our buffer chunks in real time okay so please understand that it happens during the process not after okay now let's understand what happens after we stop so after we stop what happens after this stage so as we all know once we stop the first step is we're going to send the final stream data if anything is needed to our Express backend to pretty much handle that all right and then inside our Express server again going back to our Express server we have another I guess you can call it another segment or a section of our Express server and this part handles dealing with finding the file inside the file system and uploading it to AWS okay so the first stage is we're going to find the file okay and this is located like I mentioned inside the file system and the next step is we're going to create a placeholder entry into our database okay and the reason why we're doing this is we need to indicate to our you know to our users that we are trying to upload the video we're trying to process everything right because there are so many chunks and in case it took a little bit of a delay we want to make sure that the user is aware that it's still processing right so our next step is create the processing entry in the database okay and all we're doing is I'm setting a Boolean property that's it so I'm setting a Boolean property to true and I think it's called processing right now so that's it we're just going to set this to true and this way when the vi when the user tries to open that video before it was uploaded and successfully processed right they get to see a processing uh kind of placeholder the next one is we're going to initialize the AWS stuff so essentially anything that's needed to upload to our S3 bucket and since we have the file here all we're going to do in the next step is just simply upload this file so we're going to upload it to our S3 bucket now while this while this is being uploaded to AWS since we already have the file in here right we don't need to make another API request to AWS we already have the file so what we're going to do is we're going to start our AI sequence so what's going to happen in here is we're first going to make a check to see if the user has a pay tier right and if they have a pay tier then only then will we proceed with creating all the AI related stuff okay but let's say they do have a pay tier in this case so if they do the first thing we're going to do is we will be using whisper Ai and Whisper AI is going to take in our video and it's going to give us a transcript and this transcript is what we can use to pretty much show inside the application okay so the users can see what's what's being said as well and once we have the transcript from whisper AI we're going to take this transcript and we're going to leverage open AI and open aai is going to give us a description it's also going to give us the title for the video so everything is handled by this AI essentially it just does the process of understanding what the video is talking about it creates an appropriate title and the description for the video now again the architecture was built in such a way that you can expand on this and leverage more AI features in this okay we just want to give you a base template so you can pretty much use it for whatever you want now there's another powerful feature and we will be using voice flow to make this work and what voice flow does is now that we have the transcript we can use this transcript either manually or automatically right through code because they do have an API and we're going to pass in our transcript into a knowledge base and this is why it becomes super super powerful because now users can ask questions from the video ask the knowledgebase agent a question and based on the transcript data that it has for that video it'll essentially give you a summary or an answer for your question and this is a solution that I found to help students better understand course material from you know course videos right because the problem now is if there's a 2-hour course you have to watch the entire 2-hour course to understand or you're going to need to download the transcript and now you can't really do anything with that transcript cuz if you put it into chat gbt it's going to scream at you cuz it's too big right you would have to create a data set and maybe custom kind of train the Bots and then put all the data into that it's very timec consuming so if you use something like voice flow you can upload all the data into the knowledge base or you don't you can use any AI you want for that reason it's just this agent makes it super capable to give us relevant information or data from the transcripts and when you store it in that knowledge base when students ask questions they can directly ask the course module I love the solution right so yeah that's what I thought would be the solution to help out students even more and that's why I felt this solution would be great okay so that's what happens during our AI process now let's go back up right here and I'm just going to create Point number five which is the AI process I think we're probably going to be doing this asynchronously right and down here we're going to update our nextjs entry right so we're going to make an a call to next s and pretty much update the processing entry to done processing so this is pretty much nextjs right so we're not making the API request directly from here because nextjs has uh has access to all the credentials right so we're going to make a call to nextjs and we're going to update the entry and then our final step here is we need to delete the file from file storage or from our file system that's pretty much it that is the entire application so let's complete this diagram now so what Express is going to do here is once we have all the data coming from electron it's going to create uh writable streams right and put it into the file system okay so it's going to constantly update this and keep keep that file up to dat and once we close or stop the file we will search for the file itself and pretty much you know kind of remember where it is then we will create a request to nextjs to create our processing entry in the database then we will initialize the process I mean we're also going to get a response back from nextjs of course so we'll get the response back saying successful nice and then after that we're going to make a request to AWS and pretty much start our AWS process to upload our video our file that we just got here into our S3 buckets and once that process is done we're going to start the AI part of our application right so we're going to send this file directly into the AI or our AI process which will leverage whisper AI open Ai and voice flow then we're going to make another request to nextjs just to update the data inside our database from processing to completed and then we'll quickly delete this file from here and that's pretty much it now where does cloudfront come in handy so cloudfront is another feature inside AWS so technically I don't know if it's a standalone element we should mention here but what it helps uh what it helps us accomplish is when our nextjs application needs to get this video from our S3 bucket we're going to need to bypass our privacy settings we're not really bypassing but all we're doing is we're giving cloudfront the permissions to grab the video from AWS and stream it to our front end so that's pretty much it so cloudfront all it's doing is with the help of the permissions we give it it's going to grab the specific video by the ID from our AWS right from our S3 bucket and all it's going to do is help stream that video to our nextjs application when our nextjs application requests for it and that's pretty much it so throughout this video if you are ever confused or lost and you need some guidance please reverse all the way back to this slide and watch this entire module again because you're going to understand how everything works under the hood if you don't understand this part nothing else will make sense okay so please watch this over and over again until you understand the entire architecture and only then will you move forward to the next stage okay now I'm super excited to build this project already so let's jump straight right into it hey guys how's it going just real quick enrollment for prodigies University to get lifetime access for a one-time fee has finally begun now because we are offering lifetime access and we also have weekly coaching calls inside prodigies University we can only ever offer eight spots every 2 to 3 months so if you missed the opportunity to join today you would have to wait for the next three months to join and this price will never be the same we increase the price every single enrollment period now I do want to let you know that the last time we did this we ran out of spots in less than 3 minutes so the possibilities are high that you're probably not going to be able to apply to join inside prodigies University today but I'll leave a link down below or you can go to web prodigy.com you can see if we have available a ability and if not no worries you can always join the wait list so in the next 3 months again when we start enrollment you can join immediately because we'll send you a notification before we make the offer public and another thing is the unlimited lifetime access is only something we're doing right now so if you're watching this video maybe 2 years from now I'm sorry we probably don't have unlimited lifetime access anymore okay you can take a look at our website and I'll probably give you more information so if you want to join prodigies University at our current lowest price you can click the link in the description deson and get started all right guys so grab your phone and open up this link it's a direct link into our Discord channel for SAS business owners and SAS developers so if you ever wanted to start your SAS or learn how to make money through your code this is the best opportunity for you to do so because it's completely free now we have provided so many resources different ways for you to get support the first is a prodigy Community itself there's so many SAS business owners in there they can help you and give you the guidance and the other cool thing is you get a free coaching call from our team and yours truly every single month okay we host these calls we hang out in there we just get to know you guys and give you the support and guidance you need to reach your goals okay so just join this link so you can get assistance while you're building such powerful SAS applications okay now let's move on now the next amazing tool that we're going to be using in today's project is cursor cursor is an AI powered code editor it knows your codebase so you can ask it questions it can also edit your code for you based on prompts so you can literally tell it what to do and it will type out the entire code and my favorite part which they actually haven't mentioned anywhere in here is you can reference documentation from external websites so you can create a documentation composer and you can kind of like mention it like how they're mentioning right here and let's say if you're using nextjs documentation you could directly refer the documentation in here and tell it to implement some of the features that were mentioned in the in the documentation itself and the AI will do it for you now this is really cool we're not sponsored by them but we just want to show you the power of AI and uh the power of AI in web developments so you can go ahead and download it from here and you can get started and that's exactly what I'm doing as well if not you can use Visual Studio code no problem now I'm also on the free tier so that should be fine and I think just for this project the free tier is more than enough so the first thing I'm going to do is I'm going to create a folder in here and I'm going to call it opo / web prodigies please use this exact um naming convention then I'm going to drag and drop it into my cursor folder okay my cursor window and that's going to open up my project now we can open up the terminal and we can use the following command to initiate a nextjs application now I'm using bun you can use npm you can pretty much use whatever you want but I'll be using bun in this project okay so I'm going to say bun X create-- apppp at latest space and put a period sign and hit enter okay and that's going to install everything in this rout directory so first for typescript yes yes for eslint yes for Tailwind yes for Source yes for app router and we're going to do no for this and that should do that awesome and now you should have a folder structure just like this and the next thing we're going to need is shat ceni okay so go ahead and say U bun x-- bun and you can also copy it directly from shaty nuui if you go to the documentation page you can copy it right from here okay so we're going to say latest and uh chaten at latest and we're going to say in it and I think it's saying you can use- D flag for defaults okay so we're just going to do this right now and it's going to install something for us real quick and I'm going to select New York and let's select neutral and yes for CSS variables and that's pretty much it and now if you open up your folder structure you should find a components. Json file in here okay so the next thing we need to do now is create the components folder and you actually don't have to do that directly in here because uh we are going to use bun to just install all the components all at once so we can say bun x-- bun shaten at latest add and instead of button you're just going to remove that and hit enter now it's going to add ask you which components would you like to add but we're going to click on a and that's going to select everything okay so click on a on your keyboard and hit enter and that will install all the components now this is going to take a while if you're not using bun but um because I'm using bun I'm done in just a second okay so that's why I love shat cnii with bun or just using bun in general for development and now if everything was successful inside your components folder you'll find a UI folder which will have all the components that we need for for our application now the next thing is please scroll to the description because all important links are going to be in the description okay that's going to take you exactly to the pages that you need to land on so this is our GitHub repository which of course is completely free right now but if you want to monetize it yes you will need to purchase a license okay so this is strictly only for educational use a lot of time and effort went into developing this so if you want to support the channel at the same time you want to make money and Leverage our code and our you know pretty much our Snippets for your SAS application you can go ahead and go to web prodigy.com and you can purchase the license to monetize this code okay but right now it's completely free to learn so you can download it test it do whatever you want and when you're ready you can go grab that license so first thing is scroll to the description click on that link it's going to take you here and I want you to go into the source folder and inside the app folder we're going to get the CSS from here and you're going to copy all the Cs Cs and paste it into your CSS file okay go ahead and do that and I'm going to do it as well now the reason is because these are just colors so we're not going to waste even a single second just talking over you know each and every single thing of um every single style here but basically we just used you know shaan's colors and we just pasted it in here right so you can get it from shaten right in here so if you go to the uh let me search if I can find it okay it's called theming if you click on theming or themes actually you can find everything in here so you can customize select whatever color you want I think we picked neutral and we selected dark mode and then we hit copy code and it gave us all the code we needed okay so you can do something similar and that way you save time you see we are pretty much using the same colors here okay so this can help you create custom themes for your application now the other things that we have down here first is we're setting a default background color and we're also applying the Border color to our layers as well okay so everything is going to have border which is border the new color we used and then for body we're going to send uh the background right here and text foreground I think this stuff also comes with Tailwind so you shouldn't worry about that but the other thing that we added are these custom classes at the bottom okay the first one is the fade layer so you can essentially create a really cool fade effect on right on the right side left side or bottom and top corners of your your images or div elements so it looks like it's fading off into you know it's just fading all the elements right and this simple line of CSS can actually do it I remember in the last video I used like a div and then put it to the left side and then put another div on the right side to create a fade effect but this is all you need to do and that will do it for you okay so this is that class right here and then we have another mask image which is very similar but this is for an image but it's on the side okay so in instead of two top it's two left okay we're going to remove two variables and that's pretty much it and for radial this is basically where we're having sort of a gradient color for a text color for a text um for a piece of text on our UI okay just some additional styling you don't have to care but I'm just explaining so you're not confused where we got some random style uh random class names from okay and then finally we have another gradient down here which is to bottom okay that's pretty much it the next thing is you're going to open up your folder structure you're going to scroll down to Tailwind config and this is basically a way to tell Tailwind CSS about new class names or new colors you would like to create and if you take a look at our figma design which we created in great detail you can see all the you know the states and what we did for the colors and stuff like that we also have custom components that we used for this application of course so this helped us design the application very quickly and and also have a standard right like a standard set of colors and uh globals for our application like font styling and colors for the fonts and stuff like that okay so if you want to grab this as well we are now giving away all the figma designs there's a link in the description she can grab it from there as well okay so first thing is we're going to go and grab all these colors from our Tailwind config file and I just wanted to show you the figma design because we did create some custom colors like the Border and some other elements inside our design so you see we have some custom colors here right so we just need to add those colors into our Tailwind config file and once you copy that from the GitHub repository you can replace everything inside your Tailwind config file now there's one problem here and the problem is for some reason shaty and UI did not replace something here I don't know what exactly is going on I think it's something to do right here so let me see if I can fix this so because we're using cursor AI we might be able to leverage the AI to fix it directly in here so I'm going to click on this and we're going to take a look at what it says okay now of course I know the solution and I know why this error happened but if you do not know what's going on then this can be a really powerful tool this is why anyone can build web applications now you don't even need to know code because cursor AI can help you build everything so there's absolutely no excuse for you not to own a SAS company so I'm going to go ahead and click on accept and that should import whatever I need up top right here and you can go ahead and accept this all right awesome that's it and it made the change for me so I'm not going to have that error anymore and for those of you who don't know what the error was it was because we were using the commonjs syntax to import a module in here okay but we were supposed to use the es module syntax which is import right I think it's already an old story I probably shouldn't be explaining this but yeah that's it that was the answer here and uh we just had to change that and that fixed our problem the next thing you're going to do is go into your do get ignore right here scroll down and you're going to say EnV and now we're going to go into the GitHub again and you're going to copy the env. example file in the root directory okay and in here you're going to create that environment file and you can now paste all of these variables directly in here now the next thing we're going to need for our application is a powerful database and today we're going to be using neon neon is a cloud-based postgress database it offers autonomous scaling where you don't have to do a single thing and your database will automatically Scale based on the traffic that your application generates and they also have some Advanced branching features so you can create cicd pipelines and you can keep track of changes that are made to the database schema super powerful stuff here and we need to support this company guys because they are supporting us as well and the best part is they have a completely free tier that you can use to get started with your projects unlike other database providers where you need to give a credit card neon does not require this so if you are just getting started with your SAS application this is the best way to do so so if you click on the link in the description it's going to take you directly to this page and if it doesn't all you have to do is log in and then go into your root dashboard okay and then in here go ahead and put the project name and please call it opal dweb prodigies and down here for the database itself so this is the project this is the database name okay just going to call it opal and you don't have to set up anything else just go ahead and click on create project and that's it you can go into your environment file and you can paste your postgress uh link just like this and check it out I think it already gave me something oh that's weird I think it's trying to autofill it for us but I think it's looking at other stuff and kind of giving us placeholders but uh yeah that's pretty much it so I just copied the key from here and I just pasted it inside my codebase now that we have our database set up we need a way to communicate with the database and the best way to do this is using Prisma so go ahead and say bun X or bun add I think this is the command sorry about that so say bunad Prisma and go ahead and hit enter and next we're going to need a way to handle users in our application so we will be using clerk authentication so go ahead scroll to the bottom and click the link in the description that's going to take you to this exact page and then you can go right into your dashboard if you have already used clerk you can essentially click on your organization and then you can click on create application right here and again I'm just going to call this opal web prodigies just like how we did on other platforms as well and I'm going to turn off email because we only need Google authentication for this project and go ahead and click on create application and that's pretty much it now clerk immediately tells you exactly what you need okay so that's why this really helps when you are a developer and you don't want to care about stuff like authentication in your application right so what I'm going to do here is I'm going to copy this and I'm going to say bun add and paste this command and hit enter and I'm going to copy my environment variables I'm going to go into myv file and when I find the clerk publishable key right here I'm going to replace this with the following keys that I just got next you want to copy the middleware typescript file and I'm going to open up my folder structure and in the root of my folder which is inside the source folder I'm going to create a middleware do typescript file and inside this I'm going to paste whatever I just copied from clerk authentication next we're going to make a a quick upgrade to this so we're going to say const is protected routes and we're going to set it equal to the create route matcher which comes from clerk authentication and we're going to invoke this and pass in an array and this array is essentially all the paths that you want to validate against okay so you see how a cursor AI is already giving you a bunch of stuff but we already did it here so it knows exactly what to put but we don't need it so we're going to use some custom stuff right so in here I'm going to hit enter and the first thing I'm going to put is the following so I'm going to say slash dashboard open these parentheses say dot and star so everything after this is technically a protected route and then we have the API so/ API payment and finally our next route is anything after payment as well okay and you want to move this right above the clerk middleware and now in here you're going to get access to a call back so we're going to get this right here and we're going to destructure off and request and this is going to be an async call back function so let's get that as well and now we have to say if protect protected we're going to pass in the request and then we're going to say o. protect so you see how it's giving us everything so I don't have to do a lot of stuff right so right here of course we don't need the URL we're just going to say if is protected for request then in here we're going to say off like this we're going to invoke it and we're going to get protect from this and invoke that as well okay so looks like I made an error let's just quickly fix that with cursor AI all right awesome awesome and now I'm going to open up my folder structure I'm going to go into app right here and you're going to find a layout page and in this page we're going to do a bunch of setup for our application so the first thing is we don't need all the stuff here I don't even need why we I mean I don't know why this is here so I'm going to remove this and for metadata I'm going to pass an opal and I'm going to say shared AI powered uh videos with your friends okay awesome so they were using another font and we're not going to be using that and that's why we had that issue right we deleted that so we have to create our own so to create a font we have to say const men rope equal to men rope like this and you want to invoke it and I'm just using cursor AI so it's giving me all the autofill and of course you need to import this as well and of course cursor AI can help you with that as well right so once that's done importing you have to provide the subsets so we're going to say subsets Latin just like this now you want to go down here and you're going to change this to body tag and you're going to pass in men rope like this do class name and you're going to set the background to this following uh style okay this exact color and then you're just going to render out all the children inside this now clerk tells us to put the clerk provider around this application I'm going to grab the clerk provider as well and let's quickly import it and I'm going to wrap my entire application inside this provider next I'm going to go into shaten because I need to also wire up themes into my application right this is only if you need it it's not really a compulsion but I'm going to do it right now so that that way you guys can set it up if you want right so open up the um let me open this like this so you guys can see so I'm going to go into documentation and I'm going to click on theming actually sorry guys click on dark mode I I wish they actually put this under theming it doesn't make any sense to have it separately but uh I'm going to click on the nextjs I'm going to copy this command in bun and I'm going to open up the terminal I'm going to paste that and hit enter and that's going to install next themes for us okay so now you want to copy this component they're telling you to copy here this is a provider okay and this provider is used uh used by shaten to essentially change the themes or the class names okay so it's basically wired up with Tailwind so go into your folder structure and inside the components folder we're just going to create theme like this and inside that an index. TSX and all we're going to do is just paste whatever we just copied inside this file so you see it's just wrapping the the theme provider and it's passing all the children elements inside it so that way we can control the theme of the application okay so let's go back to the root file which is our root uh root layout. TSX and now after the body tag right here so before the children elements we're just going to hit enter and we're going to wrap this this uh theme provider that we just created okay so let me move this up top right here and also import import the component SL themes component and put the children component inside the theme provider itself okay so now I think it's a good time to open up our terminal and say bun runev and now I'm going to open up Local Host I remember someone asked me this question and I was so confused but guys you need to First make a request to the server to get something correct so you have to look up local host in order to see what you want okay which is see your application first so by default I I remember in one of our past projects I taught you guys how to use a local host in HTTPS that's why it's defaulting to https but I'm just going to use HTTP right here and that should open up everything now of course it's going to look like this because we have hardcoded some stuff but don't worry we're going to fix this real quick so now I'm going to go into the page. TSX file which is right here and I'm simply just going to remove everything from here except for this main okay so remove everything keep the main Al remove this footer and I don't even need the class name so I'm going to remove that one as well and as you can see I'm rendering the root uh page. TSX right but now I want to create a better folder structure because right now this page. TSX does not tell other developers what it does of course it's the root page but we'd like to give more structure and meaning to our codebase so I'm going to create a route group here called website and inside this I'm going to create our page. TSX you can just drag and drop it in here and say move okay and you can also update all the Imports so say always like this hey guys how's it going this is paren here from the future so in this section of the video we essentially skipped the landing page because I received a lot of feedback from you guys saying you want to focus on more important aspects of the project so for that reason I also want to show you how you can you know not spend too much time and still build a website in less than 10 minutes okay this is a super cool way to leverage Ai and no we're not going to be using chat gbt I promise you this is something that's genuinely impressive so let's go ahead and see how you can build a website leveraging Ai and then we'll proceed with the video the tool that we will be using to make this work is reloom now reloom is not a sponsor of this video I just believe in reloom so much because I've been using them for a very long time including all the students inside prodigies University vom leverages AI to essentially create sit maps for your website and it can also get you the wireframes for the website instantly done okay and their next thing their next uh objective is essentially to also leverage AI to create a UI style guide okay so I think they're also go going to pretty much get into the styling of the website as well which is really really cool but so far these two features itself is more than enough because once you have the wireframes all you have to do is put a little bit of thinking and in just a few minutes you can get everything up and going so go ahead and scroll to the description you're going to find a link and this is my affiliate link if you want to support me if not no worries just go ahead and look up reloom and then go ahead and create an account so I've already created an account but before you do it's going to take you to a page that looks like this and I just want to point out that reloom is completely free to get started so this is really nice and this is why I want to support them and now you should be redirected into your dashboard and I'm going to go ahead and click on new project and it's going to require me to essentially put a um a prompt in here so I'm going to say a web application so a web application that allows users to share to record and share videos instantly with their prospects okay I think this is nice and also let's not forget with the power of AI okay now you can select the number of pages I'm just going to keep it at 1 to five because I just want to show you like a demo and then I'm going to go ahead and click on site map now if you don't know what a site map is it's essentially the skeleton for your website this is super important okay because before you create the website you want to know which sections you need to create okay and you can also leverage AI like chat GPT to make this work but they do it directly in here thank it's super nice okay and once this is done again you can click on each section you can rename it you can redo each individual section as well and you can tell it to continue generating all the content for all the other websites as well okay and once you're done with the sit map once you're satisfied you can go ahead and click on the wireframes page and this is going to essentially instantly spin up a design for your website now this is not the design itself this is what we call wireframes okay sorry about that and what a wireframe mean uh means is essentially just what the website could look like right it's not the final product it's what you can send over to your client to get an approval so that's why you have this share button right here and you can send this to your clients and only once they approve should you move forward in the development process okay never never move forward without getting their word on the design or without without getting any approval on code or features Etc okay so once this is done guys what you could do is you can open up figma so I've already opened up figma right here and you want to open this click on this button right here and look for a plugin called reloom okay and once you click on that it's going to show a popup and it's going to essentially ask you to connect your reloom account so go ahead and connect the account I've already done it and I've already built another project and dragged and dropped the um the wireframe in here and I'll tell you how to do that as well okay so once you do that and once you click on the ROM the the re loom project uh plugin it's going to take you into this page and down here you see I have the project I'm going to click on that and I can see the sit map and the wireframe so if you click on ADD wireframe it's going to instantly do some crazy AI stuff and it's going to build out the full wireframe inside uh your figma file okay and the cool thing is it also wires it up with text Styles and you know reusable colors so you don't have to go crazy trying to build the entire standards file and they also have a free kit that you can use as a starter kit and you can I mean it it looks decent to me I haven't used it in the past but essentially you can use the wireframes that they're giving you and use their starter kit and you can essentially um leverage all the styling that they create okay so now once this is done we're going to click on the plugins again and we're going to click on builder. I okay and builder. iio is essentially going to ask you to log in or maybe create an account but I don't think I have to do it but if you have to go ahead and do that as well and then make sure you click on the frame okay so click on this one right here and then you're going to find a button button here called generate code so go ahead and click on this as well and that's going to take you into a tab that looks like this okay they're going to show you the responsive View and the regular view of your website as well okay so you can take a look at whatever you want I just want to show you you know the capabilities I'm not really going to focus on design but once you are done designing of course don't do it right away right the wireframes are not the design you want to finish um creating your designs and colors themes all that kind of stuff make it pretty much like the final products right and once you're done with that only then use Builder IO and once you do Builder IO you can essentially click on jsx down here and it's going to spit out a a JavaScript component a react component essentially so you can copy all of this and you can go into your project and paste it that's pretty much it the other thing that I thought was really annoying is this name tag right you probably don't need this I think this was like an ID or I think this is because they using something called use Styles here I'm not entirely sure what this is or why they have this it's probably an ID right but we we don't really need it because it's also using Tailwind CSS under the hood okay so let's go ahead and put this into our project so I can show you what that would look like so I'm going to go back to our website and let's go ahead and paste this and I've also removed that that variable right and that weird actually I did not remove it I didn't remove it from everything I removed it from some of them but that's pretty much it guys it will put your your website inside uh I mean it will give you the website in tailwind and table and then jsx so you can just paste it into your project and you're all set that's literally it okay so if you need to spin up an MVP as fast as possible this is the fastest way to do it okay now of course there's a lot of things that that are missing here I mean there's literally no images in here and the reason because it was using a placeholder okay so just go ahead and fill in the placeholder the text or I mean the titles whatever you need and you can proceed that way or you can just proceed with the video which is we're just going to have a nav bar on the top that's going to allow the user to log into the application all right awesome hopefully you loved this AI feature because I think this is really cool and inside our website page we're also going to create another layout. TSX just like this and this layout. TSX is going to wrap our page. TSX which is the website right here okay so first thing we're going to do is we're going to return a component so I'm just going to use the uh Snippets and I'm going to call this layout component and in here I'm going to grab the children so I'm going to say children from react. react node and down here I'm going to destructure and grab the children elements as well and here you can see it says layout this is exactly what we want but now going to create a div say Flex Flex Das column py of 10 padding X of 10 from extra large devices we'll set padding X to Zero and we'll add our container class in here and now we can pass in our children components inside this and in our page. TSX I'm just going to call this a page so I can see what's going on all right awesome there we go now the first component we're going to create in here is called landing page navbar just like this okay so open up your folder structure you're going to create another folder in here called components and inside this you're going to create the navb bar. TSX and you can use the snippet again to import this component right like a template and we're going to say landing page Navar we're going to change everything in here right so let's go back and quickly import this component awesome and now we can go back in here and make the changes we need now the first thing I did is I also swap to Safari because I think I had a plugin in the old browser and was just acting weird so I'm switching to Safari here but I don't think you should see this problem right because clearly we mentioned the default theme is dark I don't know why it's really doing that but now everything should be working perfectly now our landing page is going to have class names for this so we're going to say Flex with- full justify between like this items Das Center and inside this we're going to create another div and this is going to have the following class name so we're going to say text- 3x font D semi bold Flex I It Center and GAP D x-3 okay and now in here you can put whatever you want and it's going to show on the screen so first thing is we need a menu bar right so we're going to import this menu bar icon which comes from Lucid react so scroll down and hopefully we can find menu icon let me see if I can import that okay awesome okay so I imported it from Lucid react and now it's going to render out this for us on the page okay next next we're going to create an image here so I'm going to import the image tag which comes from nextjs so next image and set the alt equal to logo we're going to set the source and the source here is going to be op- logo.svg and of course we don't have this and I'll get to that in just a second and I'm going to change the width and height to 40 okay and the next thing I'm going to do here is I'm going to open up my GitHub and I'm going to go into the public folder and I want you to download all of these pictures and drag and drop it into into your public folder right here okay so we need the opal logo here and the snippet uh which we can use for the landing page okay I'm not going to actually Focus too much on the landing page this time because it's really a waste of time I've done it for you know every single project so you guys can you know make it look as pretty as you want but I'm going to focus more on functionality okay but we'll come back to the landing page later on when we have time so we can add more designs to it okay but yeah make sure you get these two images in here next after this image here I'm going to say opal just like this and that's how we create the title and you can also change this from 6 to 8 if you'd like just to have a slightly bigger Navar okay and of course you can hide it on uh on mobile devices but I'm just going to keep it like this for now next after this we're going to create another div and the div is going to have hidden Gap X of 10 item Center and flex from large devices okay and inside this div we're going to have the link which is the login link or sorry the home link this is the nav bar right so go ahead and say link like this and import it from next link and as you can see it's giving us a bunch of Snippets so all we have to do is change this I'm just going to say home here and for this one I'm going to set it to pricing and the reason why we don't see this is because we're on small devices so if you increase the screen width you will now see the Navar okay and we have a container in here so everything is going to be contained but uh I'm just going to shrink it for now okay and then for the homepage so since we're not really focusing on that uh I think we can first finish this part here so change this to contact like this and now here we're going to pass in the hre so okay HF is already passed and so we're good to go so I think the cursor AI already handled that uh we're going to we're going to need a class name uh so from for some Styles we're going to say BG we're going to pass in this color code we're going to say padding y of two uh adding X ofi font semi bold text large rounded full hover background and we're going to pass in this color and we're going to have some opacity on it okay so that means the element is selected or actually it's hovered so when you're hovering over something then we're going to turn that on okay so you see it's changing the color now after this div here we're going to create one more link so copy this link from here and you can paste this link down here and I'm going to change this to login and just to make my life easier I'm going to put a button element in here so I'm going to change this to button like this and import it from components UI and let's also close this and bring the login inside this now also don't forget to remove this landing page Navar just causing some problems all right awesome so let's shrink this screen and now you can see the login button so go ahead and change this href to au/ sign-in and now when the user clicks on this page it's going to take them to the signup page okay so authentication basically I'm also using a user icon so you can import this user icon and it comes from Lucid reacts as well just put it in here and give it a fill okay and I'm going to say login in here and that's pretty much it we're done with this nav bar so if I click on login it's going to take me to a44 page because the Au signin page does not actually exist okay so let's go ahead and set that up so inside your app folder you're going to create another folder in here called o and inside o you're going to create a callback route and this call back route is what cler authentication will send a um an API call to to let us know that everything is successful right remember so if you go back to the diagram this is going to make sense now and then I'm also going to say sign in right here and we need one more route so this route is going to be called sign-up and of course for all of this we're also going to have a layout page so create a layouts. TSX and we can wrap everything inside this okay so in here I'm just going to use typescript um the Snippets and right here first thing we need is children components and because I'm using this I think I can just grab it from here awesome nice and I can destructure children from here as well and now I can use the children the children prop right in here let's go ahead and pl in uh pass in the class name we're going to say container height of screen Flex justify Center and let's go to that page actually okay we're not going to see anything because we don't have the signin so let me go into sign in and create a page uh I think we have to do something else not page guys sorry about this so let's delete this go inside sign in and you're going to create another folder you're going to put two brackets like this okay you're going to use the spread operator and pass in sign in okay and in here you're going to create the page. TSX and I'm just going to return a basic component right here that says sign in component okay sign in just like this and now let's go back so now you can see the sign in clearly right so in our layout page now we can make the design changes and we can see it in real time and we also need item Center on this class so now everything is perfectly centered okay so our elements will be right in the center of the screen so go back into the sign in route and we're going to remove what we're returning here and we're going to return the sign-in component or not the signin button sorry we're going to return the signin component itself from clerk JS okay so let's go ahead and import this one like this sign in and that's it now we are done with the signin page so let's also quickly finish up the signup page so in here all I'm going to do is create another folder and we're going to say sign-up and create a page. TSX and all I'm going to do is now instead of the sign up signin page or sign-in component I'm going to return the sign up component okay also just to show you the protected route if I try to access something like dashboard well I actually don't have it right now but if I try to it's going to send me back to the sign in page if I'm not signed in okay that's why we did that middleware setup so now is a good time to create our dashboard route so I'm going to open up the rot of the app and I'm going to create um a folder itself called dashboard like this and inside this I'm going to create a page. TSX and we're also going to create another one which is a dynamic route called workspace ID and this workspace ID is essentially when the user opens a specific workspace we'll send them into that page okay but let's understand what happens inside this page. TSX so inside this page we're going to do the following so first thing is we need to authenticate the user right so authentication so once we do get the authentication and we check the user is authenticated we also want to check if the user already has an account so if accounts exist then what we're going to do is just redirect them right so pretty much just send them to the right page but if the account does not exist then we're going to need to create the account in the database if you remember the diagram remember I told you once we get the response back from clerk we're going to need to update this right we're going to need to put their data into the database essentially right and we get that from the call back routes and right after this we'll go ahead and create that call back as well right remember we created it right here so we'll build that out but that's what we're doing in here so now let's go ahead and create that authentication functionality now we can do this using AIO or making an API request or creating an API endpoints in here but we like to leverage server actions to make this work and if you are been a part of this channel you'll know that we absolutely love server actions okay so we're going to do that uh by creating our actions folder inside our source folder right here okay so you want to say actions and inside this we're going to create a user. typescript file and now to create a user action uh we need to First have a file that's set as used server and you can see it literally shows right here right so I'm just going to hit tab but we don't need this I'm just going to remove it okay so go ahead and type this with me so we're going to say export const on authenticated user or on authenticate user this is fine as well we're going to create an async function and next we're going to create a TR catch block so I'm going to import that as well and now to get the user we need to say const user equal await current user which comes from Clerk nextjs /s server and then if there's no user we're going to throw an error right saying user not found or even better we can return a status of 403 so what I'm going to do here is replace this with 403 instead okay next we want to make sure the user exists so I'm going to hit tab here you see it this is really helping me a lot but essentially what we're going to do is we're we're going to need to go into the database and find for this exact user to check if the user exists but now we can't do this because we did not set up Prisma completely right we got the database but we have to set up our Prisma schema and our Prisma client so now is the time for us to go ahead and set that up so I just deleted this whatever I just created I'm going to go into the libs folder I'm going to create a Prisma do typescript file and in here I'm going to import Prisma client from Prisma client like this next I'm doing this because I don't want Prisma client to keep reinitiating on the hot reload so I'm going to declare Global and I'm going to save our Prisma Prisma clients set it to undefined we're going to export the DB itself this is what we need so I'm going to call this client actually this is better and let's set this here as well so we're going to say client equal Global this. Prisma or new Prisma clients okay and then we're going to check the node environment if it is production then we're going to set Global this. Prisma to that client okay now we don't have this installed of course so let's go ahead and open up our terminal and we're going to say bunad at Prisma client and awesome just like that now we have Prisma client installed so now we can go back to our file and we can pretty much use that client that we just created just like this right but now we need to First create some sort of schemas for our uh for our data or else we cannot say uh client. user that's not possible right so this is what you're going to do you're going to open up your terminal again and you're going to say bun X Prisma in it and you're going to hit enter and just like that a Prisma file is created for us in the root directory and we can also see you know any other setup that is done for us right so this is good this is pretty much saving us some time so let's go ahead and now create our user model or modal I said modal all right guys so first thing is modal we're going to set it to um model we're going to set it to user and this is what the schema is going to look like so I don't want to spend too much time explaining what all of this is but just to give you an idea because I know a lot of you guys are still beginners and SAS and you want to understand how everything works so I'll try my best to explain okay so it's very simple this is just think about it like a table right we're creating the rows in the table where the columns in the table so we're telling this table called user is going to have the following data right it's going to be a type of ID it's going to have a string we're going to set it to a ID type and the default for this we're going to use db. ID okay so we'll go ahead and grab this as well okay it is DB generated gener uh generated random uu ID okay these are just syntax stuff guys you don't have to focus on this okay don't Focus too much it's just syntax just memorize and understand what's going on in here all right that's pretty much it and then the next thing is you see how um cursor is giving us a bunch of stuff that we can use right so this is really powerful so if I hit tab I'm going to have some things that I might need from here so first the clerk ID I'm going to change this to clerk ID just like this we're going to set it to a string we're going to set it to Unique as well and we also need the created and uh updated daytime you can put that in here if you want as well so that's it we're creating the columns right we're telling what this column is which is it's an ID of type string with this specific type of um you know whether it's a number string or whatever that is right that's what we're passing it in here and that's it same thing for clerk ID same thing for created at and of course there's more to this so we're going to go ahead and create that as well okay so the first thing is every user is going to have a type of media setting remember for electronjs we're going to need to know which mic or camera or screen the user prefers so we need to create another uh model to store that data as well so I'm going to say model media and this is going to have an ID which is a string we're going to have the screen itself which is also a string we need the mic we need the camera as well and then we're going to have something called preset and this preset is going to give our users the ability to select between high definition or low def okay so right now we're going to create an enum called preset in here so we can give it these two values so we're kind of hardcoding it that way when we get type intelligence we know exactly which value can only be passed into into the database when we're creating stuff okay and again these are controlled by different tiers so if the user is under a paid tier then we will have only I mean we can give access to high definition right if not we're giving the low Def One all right next we're going to need to connect this media to this user so I'd like for you to take up a challenge pause this video and try to do some research to see how to create a foreign key in one table and connect it to another table using Prisma all right awesome hopefully you got the right answer if you didn't no problem I'm going to show you exactly what to do so we're going to set this to Studio because that's what we're going to call it in here and we're going to refer this media right here the media model and we're going to set it down here okay so that's what we're doing essentially saying Studio refers to this type of data and the the user is going to have the studio settings that's pretty much it okay and now down here we also have to link this back into this user table and the Syntax for that right here is as follows so first we have to show which field are we going to need from here to connect the user and that field is called user ID and this is going to be a string as well and this string of course is going to be unique and it's going to be DB uu ID okay that's how we're connecting this and now we have to pass in that uh the connection and say which field are we trying to connect in here that refers to this ID from here okay also guys please do not make any spelling errors if you want to save time just go to GitHub and copy this and paste it it's totally fine all right I'm just here to explain and help the other people who don't understand what's going on okay that's literally it and I'm not going to explain every single thing cuz we need to speed up there's a lot of stuff we need to do okay but yeah right here all we're going to say is we're going to say user like this we're going to set it to this specific um model type right here user and its relations is the fields this field right here user ID and it references this ID in the user table that's it so that's how we create a foreign key okay that's how we can create relationships between tables and you can also create many to one all that kind of stuff too you can create arrays here right so you can say multiple media settings in here as well whatever you want but I just just want to show you how this works all right next thing is I'm going to create another model here called workspace and this is going to have the following type of data so first we're going to need an ID the name and since each user can also have workspaces right we're going to say workspace and set it to an array of workspaces because one user can have multiple workspaces okay so we're going to create multiple here right and that's how we're linking it right here we're saying user and the relation is with this field right here and it references this ID field right here now there's another enum we have to create in here and this enum is called type so let's go ahead and create that as well so let's say enum type is going to be personal and public because there are different type of workspaces right we have public and personal workspaces so that's why we're providing that in here okay so now I have showed you everything so now I'm not going to sit and type every single thing I'm going to Leverage What I've already done inside the GitHub and then we'll walk through every single thing okay okay so this is the new updated schema so please go into GitHub copy the schema and paste it in here and follow along with me okay so we finished workspaces next is each user can also have multiple videos that are assigned to them and the video model is going to look like this down here we're going to have ID title description The Source right we're going to have created ATS we're going to have the folder that it belongs under we're going to have the folder ID as well because that's how we are linking it and now since this is a different type again of course we're going to need another uh model right here right so we created one more model called folder and this is going to have ID name created at and the workspace it belongs to okay and the workspace ID as well and videos right here and then down here we're going to also link the user with the user ID right same thing and each video can also be processing remember this so when we were explaining the architecture I mentioned the processing part right this is what that does and then this also belongs to a workspace so we're going to create the relation here and pass in the work workspace ID then views for each video and the summary okay I made a spelling error here but that's fine and that's it for videos Okay so let's go go back up top and then let's understand subscriptions so subscriptions is going to look as follows so we're going to have the ID again the user and the user ID so we can link a subscription to a specific user and there's only one subscription right so that's why it's not an array it's just one right here and then we're going to have the plan and their plan is essentially um a a different type right a different enum which is pro and free plan and that's the only plans that our application is offering right now you can custom customize it but we're just going to say free as default okay and then we need the customer ID and the updated ads so this actually comes from stripe all right we're getting stripe stuff and storing it in our database next the exact same thing for members so users and members right here are also a way to essentially show which um which member is assigned to the specific user accounts so you see we have the member table right so each workspace so let's go back to workspace right each workspace is going to have a bunch of members and a member is nothing else but a user so when you when we first created the workspaces right here we created the member then we um created these specific types so let me scroll down which is ID user ID and stuff like this because remember a member is a user and that's why we have to create this relation right here as well okay so don't think that okay the user goes into the member I mean yes they do technically but a user is a member that's why it's a relation right here okay so more specifically speaking um the member is a part of a workspace okay and a member is nothing else but a user so users are members that's why we have that connection there next we have notifications pretty same I mean pretty similar I'm not going to explain that then we have invites which is again the exact same thing we just have another model and we have a bunch of data stored in there and we have the receiver which which is you know someone who's sending it and the person who's receiving this invite as well and we're passing the same type of model in here and then we have the trial okay this is just going to help us understand if the user is on a trial period or not and the reason why we need this is I think we can leverage this when we're using AI features right so in your in our Express backend that time okay that took a very long time but I just wanted to help you out so I pretty much don't have to do it ever again okay so now you know what a Prisma schema means it's just it's literal English right you can read it and understand what it is and because you're using cursor you don't need my help anymore just doubleclick this click on chat and just ask it a question right so what is Media or how are things connected and it will give you an in-depth explanation of how your codebase works and it will pretty much break it down for you so once you're done with this open up your folder structure you're going to say bun X Prisma generate and you want to hit enter and next you want to say bun X Prisma DB push and hit enter okay and that's going to push all of our schemas and the data to our database awesome now to confirm that everything is working one thing is you can go into neon Tech and take a look at any changes that were made or you can also use B uh bun X Prisma studio and as you can see right here we have a bunch of models that were created awesome now let's move on to our authentication part so now we want to say const user exists right so user exists like that and we're going to go into client. user. find unique where their email is actually we don't need this we can use a clerk ID itself right so I'm going to say where clerk ID is like the user ID and we want to include the following data which is the workspace itself and for this specific user so when we create I mean when we're looking for the user if the user exist we're going to get this data along with that next if the user exists then we're going to send a status of 200 and we're going to also return the user data itself now if that's not the case then we need to create the user data and just taking a look at how intelligent cursor AI is this is insane like I don't have to even do anything but I'm just going to say um we're going to create the new data here but we also need some extra information so let's go ahead and pass that in as well so we passed in the clerk ID but then we also want to pass in the user's first name and last name okay so go ahead and pass it in as well next the Avatar image also comes back from the user data right so we're going to pass in the user data in here next for our studio settings we're going to create an empty object right and just store it like this and of course for subscriptions we're just going to click on I mean we're just going to enter create and this will use all the default values right so now the user has a free plan by default and then we need to create a workspace but by default every workspace a user gets once they sign sign into the application is considered a personal workspace so we're going to put their personal name right so first name comma apostrophe s workspace so for example web prodigies is workspace or parents workspace okay and the type is personal next once all of this is completed we're going to include the following data so we're going to get the workspace where the user for the user where the user's clerk ID is like this user ID and I think you actually don't have to do this you could just return workspace true but since I have it in the code like this I'm just going to type it like this for now right so you can technically just change this to true I think it's the same thing and finally we also have to return the subscription plan right so we're going to return their subscription plan and we're going to select plan and get all the information in that all right done so we're going to scroll to the bottom here and I'm actually going to remove this 200 response right here because I have to do something else so if the new user was successful we're going to return 200 and we're going to return the new user that we just created and if not we can return response of 500 or 400 whatever you like and down here we're going to return 500 okay so I think this is better because it gives us more information on what error took place so now let's go back to our code inside our dashboard page. TSX and now we can continue and invoke this authentication okay so we're going to say const o equal to await on authenticated user we're going to invoke this and change this to an async function and now if the au. status is equal to 200 or au. status is equal to 2011 all right so I just want to make a quick change so I'm going to go back into the server action and I'm going to change this one to Ser to 2011 because we created an entry right so if this is equal to 200 or 2011 then we're going to need to do something in here we're going to return redirect to the dashboard page but this is not the right page we're going to send them to another page we're going to send them to the o. first user so your first name and after this we're going to pass in the next variable which is o. last name and then finally if the O status is 44 or it's 400 or 500 or even you can put 44 in here too right so I'm going to say 400 and 44 as well then we want to redirect the user to o/s signin okay awesome so now we have this part of the application set up that means when the user is uh pretty much when the account is created we're sending the user to the dashboard page right and the dashboard page is going to decide sorry guys when the user is authenticated we're sending the user to the dashboard page and the dashboard page is going to is going to decide whether we need to create the user or the users already you know authenticated and ready to go now our clerk authentication is going to send us a response and that response is going to go to our call back URL so we also have to keep track of that so let's go to our call back page and in here we're going to create a loading. TSX oops great SP great spellings all right it's loading. TSX and we also need ap. TSX and this is essentially the exact same thing as the other components okay so all we're going to do is I'm just going to copy exactly what's in the other page right so you can go to the dashboard page copy exactly what's in there and paste it in here as well so we're going to essentially create the user in here if we need to do it and inside our loading. TSX we're going to return a component in here called off loading just like this now we're going to return some class names we're going to say Flex height Das screen with full and item Center and we can also say justify Center like this and in here we're going to return a new component called the spinner components so open up your folder structure you want to go into components create another folder in here called Global and inside this you're going to create a folder called loader and you want an index. TSX sorry guys this is TSX not TS and you also want a spinner. TSX and this is an SVG so I'm not going to of course I'm not going to type it so please go to GitHub click on the global spinner. TSX and you can paste this in here okay it's just a SVG file and this way we don't have to sit and type all this stuff but yeah so paste that in here and the next thing is we're going to go into the index file and I'm going to return a component call it loader and this is going to take in some props I'm going to set State set to Boolean and the class name is going to be optional but this is going to be a string then we need color which is also a string which is optional and we also need children which comes from uh which is react props react. react node and we're going to go ahead and destructure everything from here and now we have to check if the state is true and if the state is true we're going to return the spinner components with the color prop passed into it so you see how cursor AI is already given it to me so I'm just going to go ahead and pass this in like this and also make sure you import the components and we also want to return all the children components if um if you know this was not satisfied right so have a better way to write this guys let's write it this way so we're going to say return State and in here we're going to pass in a div and if this is true awesome if not we're just going to return the children elements right and inside this div let's invoke this and we're going to pass in the CN function which comes from my utils file let's invoke that and pass in our class name as well and in here we're going to return that spinner component that we just imported okay so just import it like this and after this if you hit enter and just save the file that should reformat everything and this looks so much better now I can go back to the other file the Callback file and I'm going to import my spinner components okay all right looks like I mentioned justify Center twice I'm just going to remove that okay so now I think I pretty much set up the authentication so let's go ahead and give this a shot all right guys so I tried it of course it didn't work right and this is great because now I can show you the solution and you also have an opportunity to think like a SAS developer so go ahead and pause this video and try to guess what do you think happened here why did the user not get redirected to our callback route or the dashboard page okay awesome hopefully you said the answer is because we did not set up our redirect URL or we did not complete our environment file so that's the answer okay now there are two ways to do this one which is a slightly bit more complex and the other one which is the simpler approach and that's exactly what I want you to do which is the simpler approach now how this works is once the user signed in clerk gives us the options to essentially send us a web hook response okay now what you can do is you can set up web Hooks and to set up web hooks you need to go into your clerk dashboard and you'd have to go into endpoints and you have to create an endpoints in here but since we are on Local Host clerk is not going to know how to send the request to our Local Host right so as a result you will need to use an external tool like enro or other web hook listening tools that can essentially host your Local Host server on a published URL and that way enro can fire to that uh to that new address but of course that's very complex I don't have the patience to do that so the much simpler approach is just go to your environment file and you should all I mean you should probably already have this in there but all you have to do is add the next public clerk signin Force redirect URL and we're going to send the user to the call back route and if you notice we are doing the exact same thing even in the dashboard route right so you can do the same thing in there as well okay but now because I already signed in I got to sign out the user but I don't have the sign out button so how do I do this well that's exactly what I'm going to show you now so I'm glad this actually took place so just give me a second and U I'll show you what you need to do all right so go ahead open up inspect elements and you can go into your cookies you want to delete all the cookies right here so if you are on Chrome which you probably are I'm using Safari you would have clear cookies in there as well so you can clear the cookies uh by you know deleting everything from here and we also have some session storage I'm just going to delete all this stuff I don't even know why we need this um I think this might just be all clerk related stuff right so select everything and just clear all the cookies clear all local storage and session storage variables okay then you're going to go into your dashboard you're going to scroll down to users so right here and you're going to find your first user okay so if you have the sidebar open it's probably going to look oh maybe they changed it I'm not sure all right well I have users right here so I'm just going to click on this and if you have a sidebar guys just click on users okay it's going to take you to the same page and then you want to click on this and just delete the user okay so delete this user permanently from here and now if you refresh of course if you try to login it's going to take you to the signin page okay so that's how you can clear the session without having the sign sign up button okay the other alternative is of course get the sign up button and put it onto the you know onto the screen and then click on that and then it's too much work okay I I don't want to do that okay I just want to do it this way anyway so I'm going to close this and now I can sign our user in so let me make sure okay so we have A/C callback and I'm going to also take a look at my callback page. TSX okay we have the authenticator right here I'm going to also keep the terminal open in case something crash okay in in case something crashes okay so let me go ahead and sign in guys give me one second all right I see loading there we go nice so we see dashboard here and it's sent us to a specific ID as well all right this is exactly what we want to see and all right I think there's one more fix we need to make so copy this line guys right here from our callback page. TSX page right here just copy this and we're going to go back into our dashboard page. TSX and right here we're actually redirecting the user to first name/ last name and the reason why I did this initially is because I wanted to send the user to the you know if it's a personal account it looks so much cooler right to have the workspace or the personal name you can do that if you want to there's there's nothing that's stopping you but just you just have to make sure that everything is unique that's the only problem okay so using first name last name might cause some problems I'm just going to change this and I'm going to use the workspace ID of the user okay now of course we don't have that workspace ID so let's go ahead and create that as well okay so what I meant is we do have the workspace ID we just don't have the page. TSX inside the workspace ID Dynamic route that's what I meant okay so go into this route you're first going to create a page. TSX a layout. TSX and in here we're going to have all the sub routes right so for example the Builder uh the billing folder or the billing route the notifications route the settings route all that stuff is going to go in here okay so we're going to go into page. TSX and let me just stop real quick because someone in the Discord asked why is this showing up okay so if you see this error just read the error the default export is not a react component in SL dasboard and workspace ID so what is the default route first it's page. TSX so something is going on here the default export is not a react component there's nothing in here there's no react component right so because there's nothing being exported default export right there's no default export from this file it's going to show this error so even if you had another type of format uh let's see export on component stuff something like this right and this was an arrow function even if you had something like this it's still going to show you the same error because the default export from this component component is not from this page is not a component okay so read what you're typing so if this is export default and then we have cons something like this we would have to create sorry not like this guys what am I typing so at the bottom you can essentially export this component right so export default component stuff this is good to go okay and of course same thing for layout. TSX as well right because we didn't have anything in layout. TSX so it was screen you know there's an error in here all right so that's why it was showing it but that's pretty much what I wanted to help you understand which is the export default and if you don't have any component in here it's going to show this error so please don't ask me this error anymore inside the Discord okay all right so I'm going to go ahead and return a component from here I'm just going to call this page. TSX and same for the layouts. TSX as well okay please follow with me as well now this layout is going to get access to this ID right we want to get access to this ID and that way we can perform some actions in here so to get a param you can grab it from the props okay it comes through something called pams and you can destructure the pams itself to get the specific Dynamic ID that you passed in here okay so this is workspace ID so you can grab it like this and even nested elements also get access to the pams as well so you can grab it from there using uh the same pretty much the same thing okay so you can destructure like this and you can grab the other params that you need as well so I'm going to go ahead and just grab the first params prop and I'll also destructure this and store it under the workspace ID okay just like this and the next prop that I need from here is the children prop so I'm going to grab this as well from here and of course Let's uh put it in here as well so we don't get that error okay so first thing is we need to authenticate the user so we're going to change this to an async function and in here we're going to first authenticate to make sure the user is logged in Okay then if the user does is not logged in that means the user does not have a work sorry if the user does not have a workspace ID uh of course they are logged in because if they're not then you know this is just going to immediately send them back to the signin page or the default route right but if the user does not have a workspace ID for some reason then we're going to send them to the signin page okay because remember the workspace ID is created um when the user signs up right but for some reason if that does not exist then we have to check in here and redirect them to the signin page so let's go ahead and import this so all you have to say is if au. user. workpace if this does not exist then we're going to send the user to the signin page and then we also want to make sure that there's something inside here right and if that does exist that does not exist as well we'll send them to the signin page as well so this is just to satisfy typescript so we get don't get typescript errors later down this code okay the next thing is what if a user is trying to access a workspace that they don't have access to right you would want to check to make sure and verify that they have access to that specific workspace that they're trying to open so you can say const has access equal to await verify access to workspace and you can pass in the workspace ID so This Server action can help us look through the workspaces in our database and it can tell the user if they have access to it or not okay so let's go ahead and create the server action so scroll up right top right up top here into actions and we're going to create workspace do typescript first thing is change this to a use ser server page next we're going to say export const verify access to workspace equal to an async arrow function and as PMS we're going to change this to workspace ID because that's what we're getting in here and this is going to be of type string and next we need the tri catch block so I'm going to get the TR catch template from here and also get the current user so const user equal a weit current user and let's invoke that next step is if there is no user we're going to return a status of 403 awesome and if this is good then now we can go into the workspaces so is user in workspace equal to await client from Prisma workspaces or workspace doind uniique and inside this we have to pass in our query right so where the ID is like the workspace ID that the user just provided in the pams or where the user is a part of another uh you know workspace as well so if they if they are a member of another workspace right so we're going to say or right here and first thing is user and from this type we're going to select the clerk ID and say the clerk ID is equal to the current user's ID okay so if this is true and the other one is members for every where the user has the following clerk ID okay so if you don't know all this guys then I would suggest you just take some time after this course and try to learn a little bit more about Prisma or here's the best thing you can do just copy it and chat with the with the AI assistant just ask it to please explain what this means in more detail and it will tell you right so that's why I really like cursor and I suggest you use cursor as well okay so down here now if everything is successful just return a status of 200 and the other thing is we also need to return the data so we're going to say data workpace equal is user inside this workspace and if an error took place then we also have to return the error right so I'm just going to copy this and I'll paste this in here change the error message to 400 or 403 or uh I think this one is appropriate so change it to 403 and for the workspace we'll set the data to null all right awesome now of course we're getting this error that's because we did not import the verify access to workspace so let's go ahead and grab that as well and one more thing I want to point out so this is because of how nextjs Works under the hood so layouts. TSX pages are technically cached okay but I think in next 15 we are not using next 15 because it's very unstable but in next5 they're going to remove caching completely and as a result you would have to type it out individually if you want something to get cached right so because of that first we're going to be using a new library called react quer and this time we are just using the you know the basic thing which is we're just going to get cash responses from react query that's pretty much it okay we're not going to go above and beyond like last time and use um optimistic UI principles or all that kind of stuff you can pretty much handle that all right but right now we're just going to cash responses using the react query library and you can also set it according to what you want to cache and what you don't want to cash that's completely up to you so I'm kind of setting this up in such a way that if you choose to use next 15 in the future you're still fine right good to go because nothing's going to get uh I mean even then you should be fine cuz it's just new data right you're just not going to get cashing straight out the out the box you just have to set it up all right so I just want to point that out and the other thing that I want to point out is the layout. TSX page I think that's what I was talking about first so in layout. TSX Pages the layout itself is cached okay this is the behavior of nextjs under the hood and what that means is the layout essentially is going to be reused anyways right nothing is going to change in a layout it's called a layout because it wraps that component with a predefined layout usually a styling okay so if we make all these requests inside the layout page what's going to happen is the user will always be verified to access this workspace because it is all getting cached right so in next1 14 since the response is cached we would have to uh I mean we we would basically be getting outdated data right cuz if the user has disconnected or the user is removed as a member then our layout page does not get rendered so as a result it does not get the upto-date information right so just keep this in mind all right in next 15 you probably would not have this problem but I just want to bring this up right but for now I'm setting it up in such a way that if you switch to next1 15 you're not going to have that problem as well because it's going to be new data every single request okay but not sure how the layout. TSX Works in next 15 but I just wanted to inform you and educate you on how the layout. TSX page truly works under the hood okay it is Cash stuff that means it's not going to fire again so anytime you're making requests in here and you want to store that information and pass it as a prop or something like that just keep in mind that that data is always going to be cashed at least in next1 14 okay awesome so here's what we're going to do now we have this first thing is we're going to say if has access so the user has access and the status is not equal to 200 then we need to essentially return of redirect so we're going to say redirect right here let me see if I have to import this okay I don't need to so redirect the UR uh the user to their correct uh workspace ID right because we already we know that the user has a workspace so we're going to send them right here anyway and next we're going to say if they don't have access so has access. dat. workspaces right so workspace we're going to return null okay so even after all of this if there's something weird then we're just going to return null next we're going to say const query equal new query client and this is when we need react query okay so query client like this so we need to go ahead and install that so open up your terminal and let's go ahead and install query um react query okay so I just went to the website right here and if I clicked on installation and I see the bun command so I'm just going to copy that I'm going to quit the terminal and I'm going to paste this command in here all right awesome next I'm going to shrink this and now I can import this from here which is the query CL client itself from tanack react query okay so this should no longer throw that error and now that I have the query clients and guys you can also create the same query client in a in your lib file and you can just export it right the same way we did for Prisma you can do that as well all right I'm just going to write it here because it's just a habit for me but you can put it in that file if you'd like okay so now I'm going to say query. prefetch query okay and this way we can store this data in here right and we are prefetching and kind of like caching this stuff and you can take a look at it actually just look through this and read all the documentation so take a look at this right so prefetch query is an asynchronous method that can be used to prefetch a query before it's needed okay and this used query hook if you remember our last project we use this a lot right this used query Hook is essentially going to give us access to the data based on a key that we provide no as the query key okay and you can take a look at all that stuff let's click on this and see if it shows us the query key okay there's a lot more to read but um there is a query key that you can essentially pass some data into and then you can leverage that to pull it out of use Query later on all right there you go so I found it so at its core tan stack query manages to manages query caching for you based on query Keys okay exactly what I just mentioned so you can take a look at all this stuff there's plenty of resources in here to help you so I just wanted to give you that so you can go ahead and read more okay so first thing we need to pass in our query key right so our query key has to be inside an array and you have to pass in a string here and we're going to call this workspace folders okay that's the first thing and we're going to also pass in uh the function right here which is to get those folders so it's kind of like the server action and this this one is called workspace folders like this uh workspace folders all right this should be good and okay I need to pass in the ID as well right so that's for that and just keep this in mind we're just prefetching all of this data here that's pretty much it so we don't need it to store it somewhere and pass it as a prop or anything like that okay that's the benefits of using react query it would make no sense for us to pass it as as a prop or else it just beats the whole purpose right we're using this because we can cach all this data and use it anywhere it's kind of like State Management but for a server component right all right so um let's go ahead and build out the server action so we need a couple here so I'll also build those out real quick so the first thing we need is a workspace folders the next one is the user videos so all of their content then we need the user- workspaces and then finally we need the users notifications okay so a bunch right here please don't make any spelling errors in this inside the keys as well just copy paste or just verify look at my screen and make sure you have the exact same IDs and now of course I'm going to change this one to get all uh user videos this one I'm going to change it to get workspaces and here I'm going to pass in get notifications now for getting the users videos we need the workspace ID but to get the workspaces it's only for one user right so we can use the authenticated user and the same for notifications as well so now let's go ahead and create the first one so we want to scroll all the way here and I'm going to create workspace do typescript oh we already have it guys sorry about that so I'm just going to click on this one because we already created this and down here I'm going to say export cons get workspace folders and this is going to be an arrow function and we need the workspace ID which is going to be a string and this needs to be an async function as well and down here we need the TR catch block so let's grab that and we're going to say is folders equal to await client. folder. find many and in here we need to say where for this specific workspace ID right so we're going to say workspace ID is the workspace ID that was provided so you can technically just do it like this workspace ID all right let's change this okay there we go and next we also want to include some data from this so we want to include underscore count okay and select for the videos so how many videos are inside each um inside each workspace as well right so we're going to change this to videos and set it to true and at the bottom if is folders so if this exist and is folders. length Okay if this is greater than zero then we know it's good to go so we'll return a status of 200 and we're going to set the data to his folders next we're going to return a status of 404 if nothing exists and for data we're going to return an empty array now I'm going to copy this as well and under the error I'm just going to mention 500 okay or you can also say 403 this is more appropriate okay and same thing return an empt array all right so let's go back now and import our get workspace folders great so we're done with that next is the get all user videos server action so go back into the same file right the workspace typescript and at the bottom I'm going to export const get all user uh videos which is going to be an async function what what's going on async ER function all right not sure what was going on there and in here we also have to get the location or the workspace ID so I'm just going to say workspace ID like this and this is going to be a string as well and now let's get the TR catch block and in here we're going to say const user equal await current user and let's invoke this if there's no user return status of 404 next we're going to say const video or videos equal to await client. video. find many okay and we're going to find many for the following so please follow this okay we're going to say or here okay we're going to oops I made a spelling error so or like this and this is going to be an array okay because there's uh two different types here first one is workspace ID so we want to pass that in okay and the next one is the folder ID is also equal to this workspace ID okay so I made a spelling error here I'm just going to copy this and I'm going to replace this here so I can use the same format okay so just change the case sensitivity okay so workspace ID same exact thing here okay so for each of these and we're going to select the following data so we need the ID we're going to set this to true we're going to need Title created at source processing next we also need the folder right and we're going to select the ID and the name for that video then we can get the user information such as the first last and image then after that we're going to order by sorry guys it's after this so use user right here after the green uh bracket you want to say order by created at ascending order and next at the bottom we're going to say if the video if the videos and the videos actually exist we'll return 200 and send all the data now return 4 404 if there's any error and same thing for here as well I'm just going to return a 400 error okay that's pretty much it so let's go back and I'm going to import this one awesome now here's a challenge for you here's the next server action you need to create a server action that can get all the workspaces for the current logged in user so go ahead pause this video and try to give this a shot if you don't know how to do it I'm going to show you exactly how to do it okay hopefully you got the right answer if you didn't this is the right answer so we're going to say the exact same thing which is export cons get workspaces so please type with me okay it's an async arrow function and now we need the TR catch block and inside the try first we're going to get the current user so who's logged in right if there's no user the same thing we're going to return 404 now for workspaces we're going to do await clients. user. find unique for this clerk ID so the this exact user who's logged in okay now this part you might have gotten wrong and that's totally fine because this is just additional data that we're going to need so please follow through so first thing is we want to select the subscription plan so subscription we want to select the plan and set set it to true then we also need the workspace and the members inside the workspace as well so for workspace we need ID name and type for members we need the members who are part of this workspace so select for the workspace where we want to select only those that have the ID name and the type okay and that's it now we're going to go down here and we're going to return all the data if the status is 200 right so if work spaces exist return 200 if not we're going to return 400 awesome so I showed you how to do this now I want you to do get notifications as well okay so pause the video and try to do this and if you don't know how to I'll show you the answer okay awesome hopefully you got the right answer but if you didn't no problem now this is get notifications which is tailor to one user so the best way is to put it uh I think the best thing to do is to put it inside the user file right so that's the first thing I would do which is export const get notifications equal to an async arrow function which is going to have uh we don't need any params right here so I'm just going to remove this and in here we're going to have the TR catch block and first we need the user so const user equal await current user let's invoke that and now if there's no user you're going to return a status of 400 okay 404 actually and later uh the next thing we need to do is get all the notifications so this was the main part you had to do okay notifications equal A8 client. user. find unique or not find first find unique and in here we're going to say where this client or this clerk ID is set to user. ID okay and now we need to select the notification oops what's going on notification and we want to set this to True okay so we want all the notifications but we're also going to count them okay so select and we're going to select notifications set this to True okay so now we get a number as to how many notifications they have as well all right next if notification and and notifications. length notifications. notifications. length Okay like this then uh sorry it ALS has to be greater than zero and actually you can also pass in just the thing as well right because it's truthy value but this should be good so if this is true we're going to return status of 200 and data we're going to set it to Notifications okay just like this awesome and after this down here if this fails we're going to return oops sorry we're going to return status of 400 and we're also going to return the data but set it to an empty array I'm going to copy this and in here I'm going to paste the same thing and actually I'll change this to 404 okay now let's go back and I'm going to import my get notification server action as well okay awesome guys great job so far now when you're using query client all components that need to get access to use Query or to get access to this specific query that was prefetched and the data we need to wrap everything inside something called a hydration boundary if you don't know what that is you can take a look at the query uh T tanack queries documentation but it's essentially going to give us access to that state okay so that's exactly what we're going to do right now so create the hydration boundary first and we're going to set the state equal to and this is going to have a function in here which we need to invoke which is called dehydrate okay and that comes from tanack react query as well and go ahead invoke that and you want to pass in our query client so now it's going to give us all the state and pass it in here it's kind of like Redux guys okay it's basically a provider that gives states to our components okay next thing is we need a div in here so I'm going to create this div and this is going to have Flex height of screen and width of screen and in here we're going to pass in first component which is the sidebar okay and after the sidebar we're going to have some other components down here so first we'll finish the sidebar component and then we'll come to the rest okay so in our sidebar we're also going to need the default um active workspace correct so we're going to say active workspace ID is equal to the workspace ID we currently just cre just got okay or the user is trying to access sorry okay which which the user is trying to access is what is called the active workspace ID right because that's what they try to click on so now we're going to go down here and we're going to scroll down to components and inside Global we're going to create another folder fer called sidebar and inside this an index. TSX okay so go ahead and return a new component and rename it to sidebar and the first thing we need right here is the active workspace ID now before this error happens I'm going to go back and quickly import the sidebar component as well so we can see what we're doing and let's go back to Local Host let's make sure we say Bun Run Dev okay awesome and let's just give that a second to to restart okay great so the first thing we see is no query client set use Query client provider to set one so query client provider is essentially you you need to wrap your entire application inside this provider to get access to all this query client related stuff as well right we have the hydration boundary of course and that's going to give us the state of what we just created right here but we also have to wrap this around the entire component and if you're wondering how I know it I just read documentation okay so I'm going to go down all the way to our layout. TSX which is in the root file and you see the children components right here right we're going to create the react query provider like this so react query uh provider and we're going to pass in the children elements directly in here now the reason why I like to have this in a different file is because I don't like to do anything in the root layout file so I'm going to go down into our root folder right here and outside this I'm going to create react dqu and index provider or index. TSX okay and now I can return this react query provider new component right here and the reason why I said I like to do it this way is because now I can create the new query client and I can pass the client down here right and uh I don't want to do anything in the the root layout file so const client equal new query client just invoke it like this and import it from tanack query and now down here I'm going to go ahead and pass this into our query client provider so I'm going to say query client provider import this just like this okay and now the client is going to be equal to the client we just created and we also have to get the children right so we're going to say children are going is going to be react. react node and I'm going to import sorry destructure and grab the children elements and also pass in the children elements down in here now let's go back and quickly import our react query provider and that should solve this problem okay so another quick uh change we need to make so if you go down into your react query client which is uh the react query uh component there's one thing we need to change which is add a use client up top here I totally forgot to mention this and the reason is because this is a client component okay so we're going to need to put the used client up here because we're passing down uh some client related stuff into um I mean it's a if you remove this it's a server component and you can only pass in certain type of data right you can take a look and see what the error is only plain objects and few built-in can be passed into client components from server components right so this right here is just it does not satisfy this plane objects okay so that's why we need to change this to a client component now next thing is I'm going to go back to my layouts. TSX and now I can pretty much uh continue from here so inside my sidebar component I'm going to first get this and destructure it from our props just like this and I'm going to provide a class name with the background set to the following uh specific style and then I'm going to say Flex none relative padding of four height of full width of 250 pixels Flex Flex column gap of four and items Center okay and let's see what that does all right looks great now I'm going to remove this right here and I also want to add one more thing right here I'm going to say overflow hidden okay and inside this div I'm going to create another div with the following class name so please type this with me so I'm going to say background set it to the same color right and now I'm going to set the padding to four gap of two justify center items Center the margin bottom of four like this we want to say absolute we're going to say top of zero left of zero right of zero like this okay see I made an error here this is why I don't like to type this out guys but I saw some comments and you guys wanted me to type everything I don't really know what's the difference between me copy and pasting this and reading it out and just you know typing it out makes absolutely no difference but I think it's maybe for you I mean whatever you guys like I'm totally fine with it it's just going to take us a very long time and if you're okay with that I'm okay with it as well okay so let just let me know in the comments what method do you like more and I'm sure this time I've gone more in depth and more in detail I've explained every single thing uh because I read some comments and a few of you guys are beginners even though this channel is for more advanced U you know nextjs developers and SAS developers but at the same time I also want to you know help you guys out as well okay so that's why I'm explaining all right just let me know what you guys think is best so next I'm going to have an image component right here and I'm going to pass in the source as opal logo we don't need this I'm just going to remove this and let me make sure it's the same name okay opal logo.svg all right perfect and then we want to say the height the width and the logo right here as the all text and then right after that I'm going to create a paragraph tag with the following class names which is text- 2 XEL and then I'm going to call this opal all right so the reason why I'm not seeing the width is because I made an errow here this is why I like to copy paste because I don't have to deal with this but all right there we go all right so width 250 pixels okay so next after this paragraph down here we're going to create our select component so we can have a drop down right so something very similar to this right here right this is what we're trying to do so I'm going to go back here and I'm going to say select component and this comes from components UI okay and the default value is going to be equal to the active selected value okay because this is what the user was trying to access so we're going to give them access immediately and on value change we're going to set this equal to an onchange Handler now immediately when we need something that's client-based I'm going to go ahead and change this to use client up top here and now I can create that state so yeah we're not going to be using a state it's just a callback function right cuz it's an onv value change uh method here uh sorry prop which is basically just a callback function and it's just going to invoke it behind the scenes so we're going to say const on change active workspace and we're going to set this equal to an aror function and it's going to take in the value which is a string and all we're going to do is we're going to say router. push and we're going to send them to that specific value so if they try to change the drop down then we can then we can send the user to that specific location so since we need rout here we're also going to say con cons router equal use router and use router comes from next navigation so go ahead and import that one as well now we can copy this and I'm going to put it down here all right awesome so this is just the provider there's more stuff in this so first thing is we need the trigger element okay so I'm going to say select trig why did I say it that way select trigger and I'm going to pass in a class name if it can save me today hello excuse me all right there we go so margin top of 16 text- neutral uh we'll set this to 400 and in here background is going to be transparent and inside this we're going to say select value this is the same thing coming from uh components UI and inside this we're going to pass in a placeholder okay and the placeholder is going to say select a workspace oops typed it out of this select a workspace okay there you go looks amazing and if you you click on of course nothing's going to happen right now because we need to show the select components as well which is called the select content so we're going to say select content like this and if you don't know where I'm getting all this guys it's from Shaden UI right it's literally shaten you can go learn what they have learn about their components as well so I don't want to waste too much of your time uh I'm just going to go ahead and build this right here which is the select content and for that I'm going to need a different background color so I'm going to set this to the same color that we had before and I'm going to set the backdrop to blur but I'll change this to Exel okay next we're going to create a select group okay so select group like this and this group is going to need to have a label inside this so select label and the label is going to say workspaces so now if you click the drop- down you're going to see all the workspaces in here next we're going to need a separator so I'm going to import that one as well well and after this I'm going to Loop over the workspace which is a variable and we're going to get that from from used uh used query data right so we're going to get this from our query client that we created uh which is oh sorry react query so let's go up top here first thing we're going to say is const data and is fetched okay and this is equal to usequery data and this Hook is essentially um a custom hook that we're going to need so what we're going to do is open up our folder structure we're going to go into Hooks and we're going to create a file in here called usequery data. typescript and in here I'm going to export const use Query data which is equal to an arrow function just like this and in here we're going to get access to the query key okay and this is going to be of type query key from tan query and then we're also going to need the query function so query function and this is going to be of type query function of course so I'm going to import that one as well and finally we also need enabled so enabled which is going to be optional and this is going to be of type enabled nice and now in here we're going to say consta is pending and is fetched okay and here we're going to I mean we also need some more so refetch and finally is fetching okay and we're going to use use Query here so we can get access to all the the data that we prefetched right so we're going to get used query invoke this and this is going to take in our query key so query key first then the query function and then we need enabled okay so it looks like we don't need this anymore cuz I'm just looking at the documentation and I only see two two types of params right here which is okay that's fine we'll remove that okay not sure why that's happening but here it's also screaming again saying overload one of three all right just give me a second guys let me fix this bug so we have query use oh my God all right I love it when stuff like this happens man all right so this is actually if you open this you see it's it's a it's an object with a bunch of options right so we're going to pass in an object in here okay so let me just quickly fix this and for that we need query key we need query function and we need enabled okay so now this is going to work let's see okay so even then it's throwing the enabled error and I think that's because I'm not accepting it from the params okay so I think it just Auto removed that for me my life is just so difficult right now and this one is enabled enabled okay so let's import that okay nice and now we need to return all of this stuff so return data is pending we need is fetched we need refetch oops what happened ref fetched like this and is fetching okay so we can return all this data if anyone's using this hook okay so let's go back now and we're going to import this new hook that we just created and this Hook is called use Query data so let's import it I'm going to invoke and now all we have to do is pass in the key that we want so user workspaces right and we also need get workspaces which is the Callback function so we're going to say get workspaces like this okay from this action awesome and we can just pass it in here now I ultim made one more error this enabled is actually optional so I went back into the hook and I just put that question mark there and the next thing is you want to move this outside the um outside the query Keys okay so two different parameters all right phew that was a lot lot of work for nothing so I'm just going to go down here now after the separator and now I can Loop over our workspaces or actually I still have to get the data from this right so where did I make this call so we have data here I'm going to rename this to workspace or maybe um give me one second guys I think there's a better way to write this so right below this I want some types script right type intelligence because right now it's going to say type unknown so to do this I think this is an easier way so I'm going to say data I'm going to set this to rename this to type of workspace like this and I'm going to set this to equal to this data right and I have to typ cast it to use as workspace props okay so workspace props why is it not giving me that oh I thought Prisma had those types all right so I'm going to go down here and I'm going to create a folder outside the root folder so Source create another folder we're going to call this types okay and inside that I'm going to create index. type. typescript and in here first thing I'm going to do is export type workspace props equal to an object and the data is going to be set to the following so this is going to have subscription we're going to set this to an object and first prop is um the first value is going to be plan and this is either going to be of type free or we're going to have Pro in here or of course this can be set to null then we're going to have workspace and this is going to have ID set to string name set to string as well and the type is going to be of type public or personal and this is going to be an array of these workspaces and members is again going to be an array so an array of these so first thing is it's for this workspace right so workspace and we're going to have an object here for more types let me just save this so it kind of restructures everything we're going to set the ID as string the name is string as well and the type is going to be public here or personal okay nice all right so now we can export this workspace props and I can just typ cast here all right worksa workspace props and now this data is going to have all of these types okay now I can reuse this down here and we can render out elements nice so workspaceworkspace map so just invoke that and for each of it we're going to get access to a workspace itself but we're going to return a select item for each of these okay so return a select item but first provide the key very important so workspace doid I feel like this should just be automated I don't know why we have to still do that okay and value um where is this value equal to workspace doid all right nice and inside this we're going to say workspace do name all right and let's see what happens hey there we go great job okay so we can see all the workspaces right now next right after this we're going to say workspace do members sorry guys we have to first put this bracket here because we're going to be using some JavaScript code so we're going to say members .length if it's greater than zero and workspace do members. map then we're going to return another element so here we're going to get the workspace itself so let's just grab that and in here I'm going to say workspace do workspace if that exists then I'm going to return the following it's going to be a select item again down here so let's import this and after this uh what seems to be the error here let me just take a quick look okay the error is right here so remove this bracket okay we don't need that and for select item we need to pass in the value and the value here is going to be workspaceworkspace doid and after this we need to also pass in the key and the key is going to be equal to the same thing so workspaceworkspace doid and inside this we're going to pass in the work workspaceworkspace do name okay so something's going on that doesn't quite look right this should be the active workspace right now because I'm under this ID right so this ID is it starts with 994 so something is wrong with the way we set up the default value and I'm not entirely sure why this is going on so let's quickly debug and I want to show you the process okay so first thing I'm going to do of course is console.log and I want to make make sure that the active workspace ID exist if I'm even passing it in okay so this is a client component so you got to open the terminal here and you want to take a look at this so let's refresh everything and I'm also going to remove errors and just have the logs okay all right there we go so it's undefined so let's go back into our layout component and our act okay you see we made an error here so active workspace ID has to be set to the correct active workspace ID okay so now if we refresh there we go great job so far so another thing that I want to show you explain to you is why do we have this section here so this is if the user is a member of another workspace as well so you could have a different uh maybe a group here if you'd like and maybe that would make more sense so for example this is public workspace right and then you can also have sorry this is private workspace and you can have a separator and public workspaces as well so that's why we're rendering this out in here okay so after the select element right here based on the user's subscription plan we're going to show a button okay so we're going to say workspace dos subscription or for now I'm just going to return so you can see what it looks like and then we will turn it off so for this we're going to need a custom component called Model all right just like this so copy this name we're going to open up our folder structure we're going to go into Global and we're going to call this modal like this and inside this an index. TSX oops what's going on accidentally type something so index. TSX and in here return a component called modal now the props for these are first we're going to have something called trigger and these are all react components so we're going to say trigger react. react node children which is react. react node we have title title description and class name okay and I'm also going to go ahead and put that right here nice and let's go ahead and destructure these values okay so let's grab these values from here nice and remove whatever we have here and return a dialogue components and first thing is the dialogue trigger so we're going to return a dialog trigger like this and inside this we're going to give it a class name and pass in any class name that the user wanted Okay so pass that in right there and this is going to be as child and in the dialogue trigger we can pass in the trigger element that the user passed next we need the dialog components or the content so dialog content and in here we're going to first have the header part so dialog header and inside the header we'll have the title or actually first we'll have uh this different sections inside this as well so we might as well use that so this is going to be dialogue title okay and inside the title you want to pass in title like this and dialogue description okay and inside this again go ahead and pass in the description as well and after the header we're going to pass in all the other children elements inside this kind of like content okay nice now we can go back and import our new model component model component I keep messing mixing up both of them guys all right let's import this one more time all right awesome now we need to go ahead and pass in all the values right so the first thing we're going to do in here is we're going to say title equal to invite work uh workspace invite to workspace I think this sounds nicer okay nice and then we also need Des oh what's going on here okay I think it's just typescript okay but it should technically render out the data let's see what's going on okay we need a a trigger right that's the problem so for the trigger first let's go down here and for trigger we're going to set this to a react component so we're going to say span class name text small cursor pointer we need Flex items Center justify Center and BG neutral of 800 and this is going to be opacity 90 and after that if you hover over this so we're going to say cover and set this to BG - neutral -800 but we're going to set it to 60 opacity and the width now is going to be full rounded is going to be small padding of 5 pixels gap of two okay nice and inside this we're going to have the plus Circle icon which comes from Lucid react so I'm going to import that and we don't need I'm just going to make it a closing component closed component and for size I'm going to set it to 15 and class name is going to be set to text- neutral okay text- neutral D800 and this will also have 90% opacity and we also need Phill on this one Phill Das neutral of 500 okay I think this should be good enough and of course we can't completely see it because we have to put some text in here I mean we can see the plus icon but we need more here so what I'm going to do is create a span and inside the span give it text- neutral of instead of uh 50 we'll give it 400 and then we want font Das semibold text DXs okay and inside this invite to workspace all right looks all right yeah that's fine and I actually like the hover color guys I don't know what about you let me know what you guys think maybe I feel like the hover color looks nicer so what I'll do is where's my hover okay it's right here so I'll copy this background color and instead of 90 I'll set it to something like 70 let's see what this looks like oh I made a I think I made a did I make an error here let me look okay for some reason it became border oh I hate spelling errors let me fix that all right there we go that makes so much more sense now it looks a little more realistic right invite to work space now if you click on it it's going to show something but nothing's in there because we need to pass in some more elements in here such as description and the children elements right so let's go ahead and pass in a description so if you click on it invite others other users to your workspace right so invite other users to your workspace and the next thing is of course we're going to make sure that this workspace is a public workspace right because they cannot invite anyone into a personal workspace so we'll do all of that stuff later I just want to show you what this looks like first next we're going to call this workspace search Okay s e a r c d and this is going to be a new component that we need to create so go ahead and open up your folder structure just like this and you're going to go into Global components create search- workspace and in here you're going to say uh create a new file called index. TSX and I'm going to return a component and rename that okay now this component is going to be a server component so we're good to go but we're going to change this to workpace ID so we can get it through the props and we're also going to destructure this from here okay nice now down here first thing is we're going to use a new hook and this Hook is called use search Okay use search is going to give us the ability to search through a database or to essentially sorry search through our database but at the same time you can use and leverage keys and get data from this okay so let's go ahead and create that hook so go into Hooks and you want to create a file in here called use search okay. TSX and U actually this just. TS not TSX and in here export const use search equal to an arrow function and in here first thing we need is the key which is going to be a string and next thing is we need the type which is going to be the work uh workpace okay nice and inside here we're going to say the following so we're going to say const first we need query and also guys this is super super optimized so we are debouncing all of the queries that we're making to the database as well directly in here so this is another benefits of using this hook okay or else you would have to type it every single time you want to make a search request inside a specific key or a database okay inside your table so first thing is query and this is set query and this is going to be equal to use State okay let's import that one and let's also invoke it and this is going to have a default type of string so you can just pass this in right here and then we also need another state and this one is called um let me see use State like this and this one's called debounce okay so const debounce in in here and in here we're going to say set debounce like this and that is equal to UST State and let's invoke that and pass it a string as well next we want to say const on users and set on users like this equal to use State and let's invoke this and now this state is going to be unique so please follow through with me so the type here is we're going to say this or it's an object right with ID set to string like this and the next thing is subscription okay and this is set to an object and subscription is going to have plan which is Pro or free right and this can also be null so what seems to be the error here do I need subscription I'm just going to use AI to fix it oh okay I didn't put the sorry I don't didn't really need AI but okay and then right here I'm going to say null and then after this first name is going to be a string or null last name is going to be a string or null as well and then after this down here we're going to need the image which is going to be a string or null and we're going to also need email which is string or null okay awesome now this can also be undefined so after this down here first for these users this can be this has to be an array right so what I'm going to do here is set this to an array like this and after this I'm going to say or undefined all right and this can also be undefined right here so I'm going to just say undefined all right awesome the best type would actually be an empty array but I think this can help me when I'm doing stuff like looking through it and stuff so I don't have to look at the length of the array right next we need to say const on search query okay and this is equal to an arrow function and this is going to give us an event which is react. changeevent okay and it comes from the HTML input so let's go ahead and grab that so HTML input element this should do this should do it and in here all we're going to do is set the query so whatever the user is searching for we're going to set e. target. Val to that stuff okay to this Setter do value nice so this is a callback function and basically when the user makes a change in the input field we're going to set that value inside this query okay then what we're going to do is we're going to look at the debounce and based on whether we're debouncing or not through a set timer depending on that we will send the request or we'll wait accordingly okay so first we need a use effect so go ahead and grab use effect like this invoke it pass it an arrow function and a dependency array and in here first we're going to say const delay input timer ID okay or time out this is fine too timeout ID equal to set timeouts and I'm going to invoke this this takes in an arrow function and the first thing is the error function second is the millisecond delay right so we're going to say 1 second delay and every second we're going to set debounce to the query okay and you can also use refs for this guys I've done so many examples with this and even our last project and it's pretty much the same thing right just different versions and you can use that if you'd like so now once this is done we also have to have a cleanup so we're going to return an arrow function here with clear timeout clear timeout and we're going to pass in our new U the timeout ID that we just got right here okay all right awesome now we also need to pass in our dependency so we need query in here okay nice and now we're going to use the use Query data hook right that we just created and we're going to pass in our keys and all the stuff that it needs and accordingly we're going to get data from that okay so const refetch data and is fetching because we will be literally getting data while the user is making a request every second right so we need to refresh this data so that's why we need these two props so first let me go get used query data invoke this and now I can get prefetch or refetch sorry and we need is fetching nice and in here we have to pass in the first parameter which is going to be an array with key and debounced okay key and debounced nice and after this we need our Arrow function so what does it have to call and this Arrow function right here is of course going to be async and it's going to get the query key okay query key just like this now inside this if the type is equal to workspace then we're going to do the following so all you have to do is every time you want to use this um this us search hook for anything else you're trying to search you have to come here and create a new type and pass in what you want it to do okay that's it so in here I'm going to say const workspace equal A8 search workspace search workspaces or workspace should be good as well and this is a new server action that we'll need to create so copy this name we're going to go all the way up top into actions and in users I'm going to say export const search workspace and this is equal to an arrow function and in here first we need this to be an async function and this will take in a query which is going to be a string and let's get the TR catch block as well so const user equal await current user and let's invoke this and next if there's no user we're going to return TN return status of 400 of 404 and after this const workspace equal A8 client . user. find many and in here we're going to say where please follow through with this okay so where one of these are true okay which is first the first name contains the query okay that's the first one then after this I'm going to put another comma right here the email contains the query or last name contains the query that was sent okay so pass this in all right awesome and not is another one so it's not equal to their own their own name right so we want to say clerk ID is not equal to the user. ID next is after this we're going to select some specific data from this so we need the ID we're going to set it to true we need subscriptions and for this we're going to select specifically the plan uh related info right so we're going to say plan equal true as well on want to put this on another line okay and after subscriptions we need first name true and then we need last name true as well and then here image set to true and email set to True okay now at the bottom here we're going to say if the workspace exists and workspace do length is greater than Oops why is it not giving me intelligence okay is greater than zero then we're going to return status of 200 data of workspace okay and then after that we're going to return status status of 404 and we want all to pass in the data in here okay so we're going to send the workspace itself and then if the error happens we'll send 500 and the data will be set to actually if nothing exists here then we're going to send null right or undefined so undefined or null whatever null should be fine and in here we can also send in null okay all right so let's go back to our file and now I'm going to import the search action and now a first thing is I need to pass in the query key okay so the first one that the user provided as a string okay nice and if the workpace do status equal to 200 then we're going going to set our user data so set on users to workspace data or workspace do data like this okay and let's see what's the error here okay so I made a quick typescript error let me just quickly fix this guys give me a second okay so the data has to be null uh undefined because we said it can either be undefined right here right so I'm going to go back in here and I think this should solve the problem okay undefined let's go back and see what okay so maybe putting null would probably be better right here just makes more sense right but for now I'm just going to keep it as undefined and the other one here is the there's one more parameter which is enabled so I'm going to just pass an enabled and set it to false all right nice okay cool now we need to have another use effect to handle the debounce and refetch of data right so we're going to create a use effect in here we're going to say if if debounce if this is true then refetch the data Okay then if there's no debounce so this is not true debounce like this then we're going to set on users to undefined and then finally we're going to return a cleanup function okay so we're going to return the debouncer right here all right and uh do we need a dependency yes I think we're going to need a dependency so I'm going to pass and debounce in here so it's going to invoke every time time and now we need to return on search on search query the query itself is fetching and on users okay awesome guys all right guys so looks like I made an error here uh really sorry about this so This Is Well the reason why I called it workspace search is because it was inside the like right below the workspaces right so I got a little confused with the naming convention and I passed in something really weird please forgive me this is actually to search for the user okay because if you remember when we click on the invite to workspace we want to show sort of like a search field where we can render out different users right so different users inside this workspace so that's the problem so I mean I made that mistake I'm really really sorry I'm just going to go ahead and fix this and I'll tell you exactly what you need to do okay please follow through so first thing is close this right here you want to go back into your sidebar and we're going to look for the workspace okay we have workspace search right here okay use Query data and let's see what else we have or actually let's go back into our component which is our our workspace search component right here so search workspace and we can change this to search user or just search component right this should be better I think let's see what we have in here so search workspace search I'm just going to change this to search component of course change this one to search as well I'm going to remove this thing right here so um doesn't confuse me anymore and use search okay this is good now we have get workspace in here and we have the workspace type so I'm going to go back into this and you see the type here right we're going to change this type to users like this all right and once the users is changed we're also going to have an error in here so we're going to change this to users as well and okay and then we let's just take a quick look at what we have in here okay search query this is fine this is fine debouncing this is debounce as well search workspaces let's go into the server action which is inside the actions user. typescript and in here we're actually looking for the user right we're also are we returning any okay we're not even returning any workspace stuff so what we'll do is let's change this here so we're going to change this to search users okay users like this I'm going to copy this go back replace this name as well okay and now let's go up top let's repport this so we don't have any errors okay nice and this you can change it if you want as well so let me change it together users like this and we're going to have some more typescript errors here I think let's see okay return the data so this is going to be instead of workspaces let's see if we have okay so users change this to users do status 200 set on users do users. dat and this is what the data is going to look like right and then let's go back one step and now we're going to see this error so we're going to change this to users and let's change the query key to get users okay I'm not sure if we also need to change this section because I think if I'm not wrong we did have some uh we might need to all right let me think guys give me one second or maybe we're okay so we're passing this inside this one and we're using the query key right here and this query key okay all right so that's the query key so that's fine okay we're passing that into user query data right so this is technically used query and under the hood we're doing something in here right so what we do is we can just keep it as get users and this should work the same as well all right so next what we're going to do in here is we're going to invoke use mutation data so use mutation data like this and let's remove this and this of course is another hook we need to create which is going to help us invite members okay so let's go ahead and grab that so Inside Your Hooks folder you're going to create use mutation data. typescript and I'm also going to quickly copy this so in here I can return export con oops sorry so this is going to be export const use mutation data which is an arrow function and inside this Arrow function we first need to get some parameters so let's get the mutation key and this is going to be of type mutation key like this okay the next one is mutation function okay let's change that to case sensitive so mutation function sorry camel case and then we're going to say mutation function let me see if I can find it okay and we're going to pass in two types in here any any it just requires it or it's going to probably scream at you and then we need the query key which is another type which is optional and this is going to be a string okay nice don't forget to put this comma here okay so and we're also going to need another um helper function called on success okay and this is also optional it's just an arrow function that they will send and it's going to be it's going to return nothing so it's going to return void from here okay now inside this first thing is we're going to uh create a client so const client equal use uh query client and we're going to invoke that and down here we're going to invoke use mutation pass in our key our mutation function and the on success function okay and if you don't know what this is of course uh let's go ahead and take a look at what that does all right so I was also trying to look it up but before that I realized we have an AI right and the AI honestly does a way a way better job than the documentation as well so I'm going to be using this right here so just read what it does right essentially use mutation is designed to handle side effects in your application so any API calls that you're making if they modify any data like creating them or creating data or updating data helps you manage that sort of like in a state management approach okay so if you have an API endpoint and it creates something then by using use mutation you can you can get to know if you know your change is still firing if something is still updating pending stuff like this right so you see loading error and it's successful so in our last project we leveraged the used mutation to also refetch the data right but we also updated the response of that API so the cache response imagine our cache response is kind of stored like an array right so we're okay it's an object right let's just say it's an object we have name something in here and we have height okay something in here so basically when we used use mutation we were trying to simulate uh optimistic UI which means the second we make a change on the front end we want the data to also be revalidated but we want the data to instantly have the change in it okay we want to optimistically assume that the data changes or is going to change and that's 100% going to return a 200 response and we're going to mutate the data so that way we have the updated State and because we're using react it's going to instantly update on the front end right so that was the power of use mutation now we are not using the optimistic approach here but just to give you an idea that you can use the used mutation hook to create this kind of behavior okay so you can use it as a state management approach to your inside your projects or in your application okay and essentially you have a mutation function right it takes a function that performs the data modification okay and a call back which provides the hooks for different stages in the mutation all right so you're going to see what we're I mean you're going to see that right here there's more to this it doesn't completely explain it but the better the best way okay it's right here actually so mutation key a unique identifier for this mutation right the reason is because we can cache it internally in react query and that's the exact same thing we did in the layout file right the other one is a mutation function the function that will be called to perform the mutation okay so kind of like um think about it as a server action then the query key it's optional and essentially it's the key to uh which let's see what they're saying here which query should be invalidated after the mutation is successful so remember each each request if we were using used query um we are basically sending in some sort of a key right the reason is because we are storing that data from that API resp response inside that key or think about it as the key is equal to that response from that API so if you want to revalidate that data and invalidate what we had previously then all you would have to do is pass the key and pretty much invalidate it right after the mutation is successful so that's why we have this query key in here okay next on success it's just a call back function that essentially allows us to show a toast message or something like that so you see how everything is handled in one single operation right and you get caching functionality which you will not get once you upgrade to next 15 or you know so I'm pretty much setting you up for Success okay so whatever project you use whenever you watch this video it's still going to be up to date as much as possible okay so let's go ahead and continue so I'm going to shrink this down and let's also shrink this a little bit more there's too much space there and in here we're going to pretty much say we're going to remove this and say const we're going to invoke use mutation and we're going to destructure a couple values from this so we need first the mutate and we need is pending okay so mutate is going to return some sort of data for us okay and down here actually I don't think it returns any data yeah I don't think it returns anything but it's a function you can invoke to essentially start the mutation process okay so in here now we're going to pass in an object for first one is a mutation key so let's go ahead and pass the mutation key Next Mutation function let's do that as well then our on suuccess function is going to be an arrow function which is going to give us access to uh these three variables but we only need data so I'm just going to remove everything else and if on success so we're just going to or give me one second oh so if the user passed in an on success then we also want to fire that one right so let's do that one first okay so if they provided any sort of success Handler then let's fire that so on success and then we're going to return a toast which comes from sonar and let's invoke that and pass in data. success so let me see sorry status oops something looks wrong here guys okay so this is going to be of type any H all right that's fine so we're just going to say status equal to 200 okay if this is true we're going to return something or we'll return something else okay just like this so what are we going to return here well we're going to say success or we'll say error okay and the second thing is the data or the options inside the toast so create an object in there and we're going to say description and we're going to pass in the data. data just like this okay now after on success on settled is another function so let's invoke this one as well and and we only need I think I don't think we need anything in here really so we can remove this and this is actually going to be an async function so let's name it this way so async function and in here we're going to get access to this Arrow right this Arrow function and here we're going to return await client. invalidate queries we're going to invoke that and we're going to say for the specific query key okay so let's pass that in as well all right awesome so that's how we're uh invalidating it once everything is successful so you can do it here also if you want but on settled makees sense based on what the AI was telling us right okay cool and now at the bottom once everything is done we're just going to return our mutate function here and is pending okay nice so now we can reuse this so let's import our used mutation data and the first thing is that query key so the query key key is going to be called invite Das member please do not make any errors in this because I cannot save you after that okay and here we're going to call we're going to destructure mutate and is pending and we also have to pass in some more data so it's the Callback function right so let's go ahead and pass that one in and we're going to get data here let's destructure that to get receiver ID and this is going to be a string and we are also going to get the email from this and and this is also going to be a string and in here we have to fire our a new server action called invite members so we're going to do that in here and pass this into this and that mutation function will fire inside this um this use mutation data okay so let's go back and I'm going to copy the name use I'm sorry invite members so copy that so it's easier to change it and let's go up to our server actions file or let's do this guys because we we don't really need this right now which is sending the invitation let's hide that for now and just like usual I'm going to put a work in progress flag and I'm going to say wire up sending invitations okay we can come back to this when we need it so let's go back here and I'm going to create a div with the class name Flex Flex D column Gap D y-5 and inside this we're going to create an input component from components UI and first an on change and this onchange is going to be the on search query okay we're going to pass that function in here and that's going to handle itself behind the scenes but the next one we need is the value here and this is going to be the query itself and then we need a class name so I'm going to say class name like this and set it to BG D- transparent border -2 outline dnone okay okay so when we click this we can't really see anything so let's go back and try to import that component so it's called search right like this okay nice and it also needs some props it needs a workspace ID so let's go ahead and pass the workspace ID equal to workspace ID where is that workspace at ID no I thought we had it from the params right active workspace ID I think that's what we need to pass it in here okay yeah that's it all right and now we have an input field in here next I'm going to pass in a placeholder and some and the type I'm going to set it to text okay so search for um this is wrong I'm going to say search for user just like that okay now after this if is fetching um it's coming from here so this is good if is fetching is true then we're going to render something in here so just render a div okay or we're going to render something else so for this div here first I'll pass in the class names of flex Flex Das column Gap D y-2 and inside this div I'm going to return the skeleton component and this skeleton I think is okay it's coming from shatan I believe so let me see if it's coming from shatan or can I create one I mean can I just create okay we'll just use this one okay so skeleton component we're going to set class name to width of full height of 8 and rounded DXL okay next after this so if we are still fetching for data then we're going to show this but if not then we're going to check to see if on users exist and if they if it doesn't exist then we'll send a message saying no users are found and if we found users then we're going to map over the users and render each user out okay pretty straightforward right awesome so here first step is we're going to check so remove this brackets and we're going to create um actually we don't need to create this we can just search for if no on users no on users like this there's no on users then we need to return something which is question mark nothing exist do something do something else okay so if this exists then we'll return a paragraph tag with the class last name set to text- Center text- smm and text- with a specific color code which is A4 A4 A4 okay and in here we're going to say no users found so okay there you go you see it all right and then if we got users we need to return a div and inside the div we're going to look Loop over the on users map and for each of these sorry I think I'm making an error here okay this is correct and for each of these we'll return another div okay awesome first we're going to pass in the key so user. idid and this user is going to come from this user right so we're going to say user. ID like this pass it in here and then we need some class names for some styling which is flex Gap D x-3 items - Center border D2 with a full p-3 rounded - XL okay and and awesome and the other thing is inside this we're going to create an avatar so what I'll do right now guys is let me remove this section here and I'll just add some text here for now and above this I'm just going to render it so we can see what that looks like Okay so let's see on users what is it saying so if on users exist then we'll render something out so let's see what that looks like okay it's not able to map over Okay so so I just commented this one out so all you have to do is copy paste it in the bottom okay but I want to see what I'm write uh what I'm typing so I just created an empty array an array with one element and I said id to something okay so as we go I'll keep adding to this but right now I think this is the first thing we need so return a div inside this do map and don't forget to get users here put in the key and the class name okay next is we need the Avatar and this Avatar comes from Shad ceni okay so I copied it from shat CI and paste it in here and I'm just going to go ahead and import this as well so import the fallback component and the user from Lucid react and now we need image in here so I'm going to say image and just set this to something for now so let's go in here put a comma like this and just put something in here I think they already have a fallback all right nice and the I mean we already put the fallback so it's going to show a fallback in here and after this is done down here you're going to say div and inside this div give it a class name of flex I made a spelling error this is flex Flex D column items Dart okay and in here we want to create an H3 or yeah H3 would be better and inside this we're going to say class text- bold text- LG and capitalize okay and inside the H3 we're going to say user Dot and now we need to create first name first name like this or first name this should be fine as well and I'm just going to say parent and let's also create the last name while we're already at it okay nice and down here we're going to say first name and then put a space or yeah okay you can put a space if you want and just say user. last name okay user. last name awesome let's see what that looks like hey look at that nice and after this we we need a paragraph tag with the class name lowercase text- Xs and then we need BG D white padding X of two rounded dlg then we need text Dash and we're going to need a specific color which is 1 E 1e 1e okay or H okay yeah this is good and after that inside this we're going to say user dot now we have subscription do plan okay so in here we're going to also add that subscription so scroll up top we're going to say subscription okay and this is going to have plan and I'm just going to say free plan for now okay just see what that looks like look at that looks nice right so if you have Pro Plan it'll look like this okay nice all right so what I'm going to do now is I still have some more to show in here which is the invite button so after this div we're going to create another div with the following class name so Flex -1 Flex justify justify end items Center okay and inside this we're going to create a button and this button is going to have an on click Handler it's is going to be an arrow function and we'll get to that in just a second but or we can actually do it right now so or we'll we'll wait for that okay because we don't need we're not going to be submitting the user yet right we still have a work in progress flag for them so we'll come back to inviting users in a second let's just finish the layout stuff because that's the most important right so after this we're going to say variant and set the variant to default and then we also need a class name of width of five divided by 12 and then we're going to have font Das bolt okay and inside this we're going to create a loader component loader from our loader file and you want to import and inside this you want to essentially put the invite like this okay invite like this but you also have to show the state the is pending state so I'll set the state right now to true and color I will set it to 0 Z okay so it looks like this and right now you see it's going to kind of show this loading animation when you click on it right or else it's just going to stay as is and something else is wrong here let me see what's going on okay nothing is wrong it's just because the state here is um when you set this to true the color of the loader is white so maybe you can change the color if you'd like or um you know change the button color but for now I'm just going to say State equal false okay just like this nice and that's it you see invite here so when you click this our onclick Handler will get fired and our onclick handler comes from this one right here which we're yet to create so we have wire up send invitations and we also have to wire up the button so I'm going to have two work in progress Flags wire up invite button in UI okay awesome great job guys next I'm going to copy this remove all of this so till this div please follow with me okay this div till here remove it and you're going to find this map right we just created this so remove this one as well and then in here you want to uncomment whatever we have in here here remove the string cuz I had that before and I'm going to remove this div on the inside and return the new div that we just created okay that's pretty much it so now it's not no longer going to show cuz we have wired it up with this I see some errors here I think this might just be typescript okay it's just typescript nice and that's it so now after this model we want to also wrap this model only if the user has a Pro Plan right so how can we do this well one way we can do this is we can use this button to kind of show that the user has to upgrade to Pro or we can keep this model as is and remove it for people who are on the public of the public account sorry it's not pro account what what that means is each workspace can be of type Pro or public right so sorry it can be personal or public so we want the user to be on a Pro Plan and they it has to be a public workspace so that's the most important part right so first thing we're going to do is wrap all of this in a bracket like this and we're going to say current workspace and if this exist and this is equal to equal to public okay public but from this we need to actually get the type and of course we don't have this right now so we're going to go grab that first but I just want to say if this is public workspace then render out the model so let's go ahead and grab the current workspace details so we're going to say const current workspace equal workspace do workspace doind all right invoke that and in the Callback function we're going to get the workspace here so I'm just going to say s something like this should be good and remove this so s. ID equal to equal to active workspace ID okay so that specific one is the only thing we're going to render out here so boom there you go it disappears because this is no longer a public workspace this is a private workspace okay and the other thing is only users who are on a paid plan can do this so I'm going to go ahead and create one more right here so I'm going to say workspace dos subscription. plan so if this exists oops I'm making some errors here okay plan if this is equal to Pro Plan then we're going to render the following okay so it has to be public and a pro workspace awesome now scroll down here after modal we're going to create a paragraph tag and pl pass in the following class name which is with full text dash9 D9 d9d okay and inside this we're going to Al actually there's one more we need to pass in here which is font Das bold and margin top of four okay and in here we're going to say menu like this all right looks nice and after this we're going to create a nav element okay and we're going to create a class name say with- full and inside this create a unordered list now I did something a little creative creative here and I want to show you how to do this instead of just copy pasting this okay so please follow with me so it makes sense and you understand what's going on so if we create a constant that holds all the different type of menu items along with their icons or the title itself and we render out those titles right here that will work right we'll have all of the different menu items and the icons so users can see the menu bar right here but I hope you realize that this is a dynamic route and what that means is for this specific workspace we have to also have access to things like library or other you know other um pths as well like notifications and settings and so on right so this ID has to be D damic so we can't just create an object and wire it up in here right we can do it in here of course we can get the active workspace ID and we can just passen the ID into that and create all of the you know the constant variables in here but that also means that it's not really reusable right and more than reusable it's just going to look so ugly all right you probably want to put it in a constants file this is only supposed to do nothing else but have you know only The Styling and code for these things anything that is a constant reusable variable you can remove it and put it in a different file so the way I approached this was first I created a constants folder in the root folder right so inside source and then index. TSX and now instead of creating an a function sorry a variable like export const menu items equal to and an array with all the different objects we're going to return an arrow function instead okay and this Arrow function will taken the workspace ID which is going to be a string and now we can use this workspace idid dynamically and pass it into the returned array and that's pretty much it that's all we need to do okay and we can also get type intellisense here so I'm going to create an object here we're going to say title which is going to be string hre please follow with me okay please type each and every single thing you're going to learn I'm doing it myself because you guys wanted it okay so I expect you to at least practice and do this with me so you truly learn um how to develop SAS applications okay so this is react. react node so I'm going to import that one as well and this is going to be an array now I see something wrong here let me see what's going on so the reason why this is screaming is I'm not returning an array of this stuff so I'm going to change this to an array and the next thing is I'm going to create an object with all of the following so title we're going to set it to home the href is going to be we're going to use the back ticks and we're going to say slash dashboard slash dollar sign and the curly bracket workspace ID and then we're going to say homepage okay and the homepage is kind of like an onboarding page it's not really this page where we have um you know all of the the users videos that's the library page the homepage is like an onboarding where we can share our own videos right I hope you saw the demo and finally we need the icons now here's what I want you to do go into our GitHub repository and please follow each step that I tell you okay so inside the source folder inside our GitHub you're going to find an icons folder please download this entire icons folder and drag and drop it into your components folder right here okay so go ahead pause this video and please do that that and then we'll continue from there all right hopefully you did it as well but you should have something that looks exactly like this okay a bunch of really nice components that you can use in your application okay so just keep one thing in mind that um eventually like we would want you guys to type more code and learn and as a result we won't be having the code base open right cuz right now it's completely free so please download this right now and keep it with you okay um but yeah that's pretty much it so let's move on now the first thing we need is the icon here so let's grab the icon and this icon is going to be the home icon from our folder so components SL ion and just import that okay and this is Duo te icons that um that we have from our figma that we directly exported as svgs and we stor it in here okay that's pretty much it next we're going to need this for multiple different um path I'm just going to duplicate this real quick all right that looks good this one is going to be called my library okay oops I made a spelling error here all right nice notifications and then the next one is billing and finally we have settings okay I'm going to remove the final one here and now we got to change these icons and stuff as well so I'm going to go ahead and do that so for the library I'm going to use the file Duo tone um maybe the white one okay use the black one okay I think it's the dark mode icon so use that one and we're going to change this here to just the default route because that's what the library folder is okay the library routes is for notifications you want to change this to Notifications okay and we're going to remove this and import the Bell icon all right awesome and down here this is the billing page so we're going to change this to billing and I'm going to change all of this to the billing or I think it's a card credit card icon yep so import the credit card icon as well and this one is a settings page so change this to settings and the icon is going to change to settings okay nice so now we have all the elements all the menu items so we can simply Loop over this passing a dynamic ID and we can also get the href for that ID as well so let's go back and down here we can now render these elements so inside this unordered list I'm going to say menu item items so menu or actually let me go up here and directly do it here so it makes more sense so const menu items equal to menu items invoke it and you want to pass in the active workspace ID okay nice and now you can also get type intellisense from this awesome so let's scroll all the way down and we're going to say menu items. map and for each of this we're going to return something in here okay so I'm just going to create a placeholder or I can remove this and I can pass in the sidebar item as a placeholder instead sidebar item okay or I think we had a select item or let's do this guys let me create a custom component called sidebar item and then we will we will fix this okay so open up your folder structure you're going to go into your sidebar create another file in here called sidebar D item. TSX and inside this return a new component and rename it now this is going to have the following props please pause and type okay they have icon title HF selected and notifications which is a number okay and it's optional next down here I'm going to also destructure all these values and that should do it and here I'm going to create a list item element okay so create an Li element with the following class name so cursor Das pointer okay and then we need margin y of 5 pixels like this and inside this we need to create the link item from next link okay and this is going to have a class name we're going to invoke this and pass in the CN function invoke that as well and then we're going to say Flex items Das Center justify between group rounded dlg hover BG Das and we're going to change this color so please type this hex code with me okay it's 1D 1D 1D and in here after this part we can put a comma and we can say selected if this is true then we're going to return something else if not we'll return something else here so what we going to return if this is true the background is going to be set to a different color Okay so let's change this one more time okay like this nice and if not we'll just return an empty string okay cool and now it's screaming for the hre so let's pass in the hre and let's get it from our props and pass it down in here and then finally we're going to need to pass some data in here right so create a div I created properly all right there we go class name of flex item Center gap of two transition all and then we need padding of five pixels and then we need cursor cursor pointer why is it not giving me cursor pointer okay nice and in here I'm going to pass in the icon okay and after the icon we need a span with the following class names so we're going to invoke this oh sorry we're going to open this and we're going to pass in CN function and in CN we're going to say font D medium we're going to say group- hover group- hover so basically when we hover over this one right so if you don't know how group works it's really cool Tailwind has a way for you to change child elements based on a parent element action okay so group is a pseudo element so you can use this group um and based on sorry hover is so you can use group and based on it being hovered you can set a certain type of style okay so here first thing is font medium for hover we're going to set the text to a different color okay this is the color we want and then I'm going to say transition transition all truncate and then width of 32 okay and then here put a comma and say selected if this is selected then we're going to change uh we're going to do something here and then if not return another string so for this we're going to change the text to a different color so 9090 and here if this did not work so if it's not selected then we're going to return a different color so this is 54 54 54 okay nice and inside the span now you can render the title like this awesome looks great and after this div you can now render any notifications for that okay so I'm going to go back and also open this and let's import this element so we can see what we did so sidebar item and let's pass in the href first so we have the href here which comes from item right here so item. tile pass in if this is sorry if this is my library then we're going to pass in the following href or technically let's just remove all of this and we don't really need this right we can say item. hre okay if I need to change this later just to show the um the users their Library itself instead of the other workspace and I'll come back to that but for now I'm just going to keep it like this okay then we need the icon so let's go ahead and pass in the icon and then selected is going to be a Boolean value so let's scroll all the way up top and we're going to say const path name equal to use path name okay use path name invoke that and now we can move this all the way up top cuz it's a hook all right and we can get this path name down here here and we can say if path name is equal to the title sorry path name is equal to item. hre then we will render uh we will render it as selected right and then next one is the title is going to be equal to the item. tile and then we have key which is going to be equal to item. key item. tile as well and for notifications item. title if it's equal to Notifications then we're going to pass in account for the notification okay so let's go ahead and grab that as well so scroll all the way up top and right below this we're going to say const data count so we're destructuring count from a notifications and these notifications come from a different query data so let's go ahead and say const data notifications equal to use Query data and let's invoke that and let's pass in the query key right so we need the user- notifications like this and after this we need to pass in the server action to perform so we don't have this right now or do oh we do Okay cool so let's import the get notifications itself and we also need to create a prop for this right but essentially all we're doing is we're destructuring from data we are destructuring the counts okay so let's go ahead and create the notification props so I'll scroll down in my folder structure go to types and inside this at the bottom I'm going to say export type notification props equal to an object like this and inside this first status is going to be of type number right and then data oops I'm making some errors data is going to be an object here as well but we're going to have count which is going to have notification set to a number okay like this nice and now we can export this from here so we can import it directly from here why is it not showing let me see if I made some errors here okay so just import notification props and that should solve our problem okay nice now let's scroll down okay so I made a spelling error here as well guys so go back into notification props and remove this count that's why I hate typing man copy pasting is easier for me guys CU you guys get to see the same thing just let me know okay if that's easier it makes my life easy I don't make stupid spelling errors um but anyway so now we have this so we're essentially saying return the counts right so if it's notifications and counts exist right we'll return that if not we'll check notifications as well okay or so if this is true it will use this value if not it will render number zero that's basically what we're doing in here okay so hopefully that was slightly easier to understand and I'm also going to remove this and just change it to a closed component okay nice and there you go beautiful navbar looks super minimalistic and if you click on one of these of course right now it's going to take me directly to the to that page but I'm also going to get a 44 right but let's click and see what happens boom so we go to the right page dashboard SL this slome that's exactly what we want to see all right great job guys now after this nav we're going to have a separator component so please do this and put the following class name then we need a paragraph with withd full text 90 909d font both and margin top of four because now we're going to render out the workspaces all right so just need to refresh for some reason but there you go now we can see the workspaces in here now this again is another nav so we're going to create another nav here with a class name set to full and let's create a unordered list with a class name set to height of 100 oops 150 pixels um hello okay there we go overflow set to Auto okay and then we need overflow X set to Hidden we're going to need fade layer so remember we created this this cool class name right that creates a fade effects you're going to see that really quick so fade layer and then for now what I'm going to do is instead of having the uh what do you call that instead of pretty much rendering out the element inside the if condition I'm just going to render the element so we can see what it looks like okay I think we're going to be able to see it anyway because because we're going to have two sections right first one of the workspace will be private workspaces or sorry the their own workspaces right and then after that we'll show workspaces that they are a part of so other workspaces that they have been invited to right so let's go ahead and do that so workspaceworkspace do length if this is greater than one and the workspaceworkspace do map oops what what is this okay so this is and like that and then here we're going to map over this and we're going to render something out okay so we're going to return um first let's grab the item from here but we're going to return the sidebar item component all right the same thing let's go ahead and return that one but this is going to need the following uh details so first we're going to pass in the dashboard but the item and the item id okay then the next thing we need is the icon itself but before I get to Icon let me also pass in these selected so for selected if the path name is equal to dashboard and this specific ID then it's true so it'll be selected inside okay I mean under the hood we're essentially selecting it I showed you right that's right here okay and then after this we're going to pass in the title we're going to pass in notifications as zero and we also need the key so let's go ahead and pass the key in as well and it's still yelling at me and the reason is because I still need the icon so for the icon we're going to create an another custom component and this component is called workspace PL uh workspace placeholder okay so icon is equal to workspace placeholder and I'm going to select this and let's go ahead and create this component inside this file you want to create the workspace Place holder. TSX return a new component and rename this component as well so first we're going to get children elements from the props so I'm going to import that and let's also structure the children elements down here next remove this and we're going to return a span okay a span element with a class name so first the BG so background is set to the following color Flex items Center we have font bold justify Center as well we have W of 8 so width 8 padding X of two height of seven rounded of small text of the following color so it's T 1 D 1D 1D all right and inside this we're going to pass in those children elements okay so let's go back and quickly import this element and now inside this we can pass in the item and the name of the element itself right the workspace so we're going to say item. workspace sorry item. name. character at because I only want the first element at zero okay so let's see what that looks like all right awesome we don't see anything that's because let's see what's the condition here workspace do workspace do length Okay this is fine no problem don't worry about it I think we're just not rendering it rending rendering it out correctly so let me see what's going on all right guys so the mistake I made in here was I set this to one so this needs to become zero okay and I just console logged the stuff just to see what's going on so I'll just remove that real quick but that's pretty much it so now you can see the fade layer right so if you have multiple of these components going to look really really cool so let me see if I can show you more in here all right and there you go now we have all the workspaces showing in here and all I did was just duplicate a workspace under this and put everything inside a react fragment okay so one thing I want to clear up let me first remove all of this we no longer need it all right and also remove our react fragments nice so the thing I want to clear up here is what are we rendering here so if there was any confusion hopefully this can clear that confusion okay the first half is going to be all the workspaces that the user owns but that are not a personal workspace okay so I'll say that one more time the first render here are all the workspaces that the user owns but they are not personal workspaces okay so if they create another workspace then we'll show it in here that's pretty much it all right then the other one is the second render which we're going to do right below this which is pretty much the same thing but we're going to show another set of workspaces and these workspaces are all the workspaces that they are members of okay I hope that makes sense because remember we can invite team members right so that's why we want to um render two different halves it doesn't really matter but the reason why I'm doing it this way is it's just easier to understand first half is all workspaces they own second half is all shared workspaces okay you can also be a little creative and create a separator put a title all that kind of stuff but for now this is what I think I mean this is all we need pretty much all right we understand what we're doing right so how do we do this item. type is not equal to personal and only then are we going to render this out okay then down here I want you to create another bracket like this curly brace and inside this we're going to say workspace do members okay so length if this is greater than zero I made a spelling error here let me just fix this so if it is greater than zero then we're going to Loop over the uh the memberships that they have so do map why is it doing this okay map and we're going to return an element down here as well so the element we're going to return is pretty much the exact same thing so for now what I'm going to do is I'm just going to copy this element right and down here I'll just return this looks like I made an error here as well okay this should solve that problem nice now we do have to change some stuff so please just follow with me so I'm going to say item in here now down here instead of item. we're going to change this to workspace doid okay and same thing here as well so this is the selected and we want to make sure this is workspace doid like this nice and down here for title it's going to be workspace do name this is good to go okay and same thing here as well workspace do name and let's see okay so for this one pretty much the same thing as well workspace why is it not showing okay there we go name. character at all right awesome and yeah that's pretty much it so now we're rendering all the membership workspaces as well now down here guys right here you're going to say you're going to open another curly brackets and inside this we're essentially going to say workspace do workspace do length Okay if this is equal to one then we're going to say workspace do members. length if this is equal to zero then we're going to return a divin here that gives the user the u a message that says upgrade to create a workspace okay and that's only if they are on a free tier so that's what we're going to do down here so basically kind of restricting all of their access right so let's go down here and for this div I'm going to give the following class name width of full like this height of full as well Flex justify center items Center and inside the paragraph So create another paragraph tool we're going to create another class name and this text is I mean we're going to add some Styles here too and this one is going to be as follows please type this out with me and after that we're going to say font medium not mono medium okay and then text- smm okay and in here whatever we render will pretty much just show up like this okay so we're going to say if the workspace dos subscription. plan I made an error here again do subscription. plan like this is equal to free tier then we're going to render something if not we'll render or something else and in this part we're going to say upgrade to create workspaces okay and down here we can say no workspaces at all all right guys so I made a quick change as well so remember whatever was down here right what we just entered just grab all of that and you want to scroll up top and after the workspaces you want to paste it down here okay that way it shows in here and it doesn't look weird cuz showing it right in the center now that I look at it it looks really weird so uh put it right below this and you can put like a little bubble or an icon maybe let me go ahead and try to do that as well okay that actually looks even worse so I'm just going to leave it at what it is now first thing is for the div just change the class name you want to say with full margin top of Nega 10 pixels okay and padding I mean sorry paragraph This can stay as is no problem um and yeah that's pretty much it so now it's going to be right here and you can also change the color of the text if you want I like the low Contrast Design it doesn't hurt my my eye so I'm going to use these colors all right now scroll all the way down here after this nav you want to create a separator component with a class name and this class name is going to have width four / 5 so 4 F and down here we're going to say workspace dos subscription. plan if this is equal to free then we're going to render out a message uh basically we're going to show them a button and through this button they can essentially connect uh sorry upgrade to the Pro Plan okay so I'm going to say and and down here we're going to render a fragment just for now and let's go ahead and create that card so open up your folder structure go into components under Global and you want to call this Global Das card because we're going to use this a lot okay now give this an index. TSX return a new component and change it to Global Card just like this and the first thing is we're going to need a bunch of props right so we're going to need title which is a string description which is going to be a string as well all right we're going to need children which is react. react node and footer element which is optional which is also a react node then go ahead and destructure everything right here and now we can return that card component so first thing is I've already pasted all the Imports here so I don't have to struggle but first thing is we need a card component with background transparent margin top of four and now inside this we'll paste whatever we want but let's go back and quickly render this component out so we can see what's going on so I'm going to say global card and we're going to import it like this and inside this we can essentially I guess we don't really need to show anything for now let's just go back to the component itself and let's complete this component next inside this you want to provide the card header and you want to give it padding of four next the header is going to have the title and the description simple right so render the title with text medium and with this color for the fonts and render render the title inside this and the description right after with the following text color and I'm going to render the description inside that and then we're going to also need to render the children so I'm going to say div and actually I'll put this after the header right so class name padding top of four and we're going to render all the children elements now let's go back and let's provide whatever we need to provide in here so the first thing we need is the title so title is going to be upgrade to Pro very simple right and the description is going to be unlock AI features like transcription AI summary and more and now inside This Global Card component I'm just going to render out a button with the following class name so please type this with me text small with full and margin top of two and inside this button I'm going to show a loader component okay and it comes from our loader file so let me render that as well and I'm just going to say update in here and let me go ahead and also change some stuff or actually this should be called upgrade sorry about that so upgrade nice all right now I'm going to make some more changes to this because I did not like what we did before so go back into your Global Card change children to um basically be optional and after that down here we're going to condition render them so if children are available render the children components if footer is available render a card footer and we're going to provide the following and the next thing is for this div for the children elements give it padding of four and let's go back and now we can provide the button as a footer now in the future we are going to of course change this to a payment component so I'm going to scroll up top right up top here and I'm going to say work in progress add the upgrade button okay and that upgrade buttons functionality I would like for you to also reuse for other sections as well but I will show you how to do it here so you can reuse the same logic okay all right now here's a kind of like a strategy all right or like a trick of how you can render the same Navar for two different devices so now we're on a desktop so if I shrink the device you see it's going to be the same width and this nav bar is kind of like in the way right I don't actually like that I don't know if if you like it or not but I hate it so it would be very redundant for us to create a whole different file with a different navbar and pretty much copy paste the entire thing here right instead what we can do is render all the elements that are inside the sidebar inside the mobile sidebar as well so here's the the trick you want to go up top and instead of returning this component we're actually going to set const sidebar section okay and we're going to set it to this variable of course everything's going to disappear don't worry about it we want to scroll down to all the way to the bottom right so this the last thing you should see here is Overflow hidden all right if you don't see this that means you're that means you deleted something so please make sure it's the exact same component okay so scroll all the way down and after this right at the bottom where you see this bracket down here you want to return another element so we're going to return a div and this div is going to have a class name of full and inside this we can add more stuff in here but for now I'm going to first add the um let me actually tell you what's in here so the first one is going to be the info bar okay but we don't have this right now but we'll create that later and the next one is going to be a sheet component that's going to help us open up this sidebar on mobile and the desktop component okay so let's go ahead and grab that so first let's do this section so create a div here not a directory sorry a div element and we're going to create a class say from medium devices we want this to be hidden right so then you'll have to add this class right here and we're going to change this to fixed and my of four okay now inside this we're going to create that sheet component so grab sheet from components UI and inside this first thing we need is the sheet trigger so let's import that one as well and this has to be set as as child and let's give it some styling as well so I'm going to say margin left of two and inside the trigger we're going to create a button component and I think I already imported it for the other side right for the other uh component up here so it should be good and we need the variant and the variant is going to be ghost all right and let's give it a class name of margin top of two pixels okay made a spelling error here so let's just move this all right so margin top of two pixels and inside this button we're going to use our menu component that we created that we used previously right this is actually sorry guys this is not we didn't create this it's an icon so go ahead and import this menu component from Lucid react all right nice and now after the trigger we have to render the sheet content so let's go ahead and say side we want this to be left side right and then class class name padding of zero with Oops why is it not okay class name and we're going to do padding of zero with a fit uh width fit and height full okay I think I made another spelling error here so let's remove that all right nice and now inside this we're going to render out the sidebar section that we just created so let's just give that a second okay so now when you shrink the page you're going to see the mobile version of our sidebar so if you click on it awesome there you go super simple right we didn't have to build a whole different sidebar but you're going to notice that after medium devices it's going to disappear so let's go ahead in build the element to render that one out as well so create a div and the class name is going to be from medium devices set it to block but by default we want it to be hidden and then we're going to set the height to full and now we can render out the sidebar section that we created in here as well so now if you open this you see from medium devices it shows but on small devices it disappears so this is much more efficient because that way you don't have to create another file called mobile sidebar and then need to render that out it's just a big headache okay so let's go ahead and create our info bar so scroll up top right here and let's remove this and we're going to say infobar component like this now copy this go into your Global components create another folder call it info dasar and inside that U you can create an index. TSX file and return return a component in here and rename it to infobar first thing is let's return a header element okay just like this and this is going to have the following class name now to solve this error I'm also going to go back real quick and import this infobar component so let's refresh and see if that solved our problem all right awesome and now inside this we need to create a div so create it like this and give it the following class name as well and inside this one we're we going to use a an icon okay and the first one is the search icon so right here we're essentially creating that search field right so I'm going to say search like this and I'm going to import it from Lucid react please pause and type with me okay and we're going to give the size and the following class name for it as well and next we have to create that input component so I'm going to say input and let's import this component as well the first thing it needs is class name so BG D- transparent order- none we need important placeholder Das neutral 50 or actually let's make this 500 and as you can see it's also forming right up top here right you can see this awesome and after the uh actually one more we need the placeholder as well and the placeholder is going to be set to search for people projects tags and folders all right something like this so does it pop all right awesome there we go so just keep this in mind this is just for UI sake okay just for things to look nicer I have already created a way to search uh using a hook right the use uh use search hook so I'd like for you to take that up as a challenge and try to implement the search functionality to look for you know people members projects or anything else within that okay even including folders tags we're not I don't think we're going to be using these um I think it was just it was is pretty much pointless cuz that's just crud right but you get the point so I've already showed you how to do it so once this project is done when we need to get to that or when at the end of the project please finish that challenge okay so next I'm going to create a div here with the following class names Flex items Center and gap of four and inside this I want a button okay and this button is also going to have the following class names so please add this specific Style here so it's going to be 90 90 90 okay and then after that Flex items Center okay and we need gap of two so this is essentially just buttons on the right side uh if you have the figma file with you you can actually take a look at it and just kind of build with us right but now I need to have an upload icon um where is this coming from Lucid react okay and we're going to give it a size and this size is going to be 30 okay and I'm going to create a space in here uh for our span and now I can say Flex items Center gap of four gap of two okay so now we have that upload icon right here let me increase this okay so let me shorten this actually all right that's so much better and in here we're going to say upload okay again this is not a requirement uh we're not actually going to be doing the upload functionality but it's just to make it look so much better okay this is too huge guys I'm going to reduce this to 20 all right that's so much better nice now after the span after this button here we want to create another button so instead of sitting and typing I'm just going to duplicate this okay and for this one we're going to remove this icon and we're going to use a video recorder icon it's a Duo tone icon I guess okay this one right here okay not the duone icon it's the video recorder icon okay so make sure you import that and after this for this span here we're going to change this and say record okay again this will be a challenge because we are using the electronjs application instead to record the screen right because if you are using the browser version to record the screen you're going to have a lot of restrictions you cannot access the um you know the the Lo the system the hardware system and kind of look at what their what screen they want to share and stuff like that so that's why you would want to uh use the electronjs version okay so this part would just be a challenge I'm just creating it right here so it looks nicer for our application and if you are also looking to become a full stack developer having these things at least some things on your page that don't do everything uh that don't do its intended functionalities totally fine right we just want to show the UI skills at the end of the day UI developers get paid way more then back and and you know full stack so sometimes if you need to create features like this that just you know have a UI but don't actually do anything that's totally fine okay I've done that as well right so yeah now after this we need the user button okay and this is why clerk is amazing because we can just say user button like this and import the circle which is the the user Avatar okay so let me refresh real quick just give me a second hey look at that awesome and now I can also sign out pretty much do whatever I want to do okay great good job guys so now now that this is done I'm going to go back into my dashboard route so let's shrink all of this dashboard right here and I'm going to go into my uh into this layout. TSX and this is where we created the sidebar right now let's quickly take a look at our figma design now again if you want to know how our amazing figma design was built using reusable components flex boox and all this kind of cool stuff including this entire library that is wired up with shat C and UI components right if you want to take take a look at it there's a link in the description you can grab it from there okay but just to show you what we're building before we start you see this section right here this is going to be the same thing for every single page right we have so many pages here and we are using the same type of section there all right so we can make this a reusable component so let's go back in here and inside this div we're going to create another div for that we're going to give it the class name of width of full padding top of 28 padding of six around overflow I think I made a spelling error so overflow instead of clip I'm going to set it to Y scroll okay and next overflow hidden okay but this is Overflow x hidden sorry about that all right and inside this now I can add the global header so I'm going to say Global header component which we're going to create of course but just say Global header like this and after that we're going to have another div where you can render out all the children elements right so we're going to pass in the class name like this set this to margin top of four and inside this you can render out all the children elements in here okay now this Global header of course is a new component so you want to go into your components folder in global and we're going to say Global dashe header and inside this create an index. TSX okay and I'm going to return a component here and I'm going to rename this component to Global header and this is a relatively simple component first thing we need is the workspace okay this is going to be of type workspace so let's imported from Prisma client okay and now let's go back to our component also I see an error here inside the sidebar okay I think I know why I think we need to provide some sort of okay we'll provide the props in just a second but let me go back to our workpace layout. TSX and let's import our Global header okay so I'm going to go into the sidebar index. TSX and we have two props that we need to provide the first one is the color just provide whatever you want and it's actually optional but this for the state I'm just going to say false for now okay and I already have a work in progress flag so I can come back to this when I need to so let's go back to our other component layout. TSX and inside our Global header we need to also provide the workspace ID okay now before we do that actually we already have it right here right so let's just go ahead and provide the workspace ID okay let's get workspace equal workpace that's coming from here so we have something in here called has access right so we can get it from this actually so it say has access do Works what does it have okay data and workspace okay awesome so let's go back into Global header so let me just quickly explain what we're doing in here right so the first thing is we're going to need access to the path name that the user is on and the reason is because we want to dynamically create this Global header component if we had to have this component and have it passed in with props and then render it out in every page it's going to be very redundant so with the power of the use path name hook we can essentially get access to the path name itself which would be this dashboard SL this ID and then we can figure out which path they're trying to access whe e it's the dynamic path or if they're trying to access a specific path like the notifications page settings page or even a folder inside this route and based on that we can decide whether we want to return a specific type of header like the my library because we don't have any path name in here or we can render out the title itself that means the path name itself okay that's pretty much it so let's go ahead and build that out so first thing you guys know path name equal use path name invoke it and change this to a use client component okay next we need to split this and we're going to split it with a uh at a specific string so the string is going to be dashboard slash and we're going to put the workspace do ID in here okay so we're splitting it at this exact ID so what I mean this exact URL so what's going to happen is if we are on the my library page we're not going to get anything in here right cuz it's the root root path so first let's extract the first value we get from here and down here we can do that logic based on the root path we'll render out my library okay so first thing is we're going to create an article tag and inside the article tag we're going to give it the following class names Flex Flex D column okay I made errors here Flex Flex D column and we need gap D2 and inside this we're going to create a span tag spaan and we're going to give it text- a specific color which is 707070 and after that text- excess now inside the span we can render out the workspace do type and we can render whether it's a public or their own workspace right so we'll say type and we will set this to two upper to local uppercase all right and let's invoke that so now you can see it says personal all right awesome next we're going to hit enter here create an H1 tag and inside this H1 tag we're going to change the text to for XL and we're going to render out that stuff that we just created up here so if we're going to say if path name exists so if path name exists and the path name is not equal to so if this is basically we're first checking if it includes if it includes a folder right and we're getting the reverse of that okay that's the way to look at this so path name do includes folder but the opposite of that which means it does not include the folder if that's true we'll do something in here if not we'll do something else so what are we going to do if this is true well we're going to say path name dot why is this hiding everything okay character at we're going to invoke this and get the first character Zero and then do two uppercase and let's invoke this as well and we're going to essentially return it with a capital letter right because the path name is a is a small letter so we're going to say path name. slice invoke it get the first one so from the first one and we're going to essentially change this to lowercase all right so let's see what that looks like of course we're not going to be able to see it right now and the reason is because uh we are on the root path right there's nothing in there correct so since there's nothing inside the path name and it's empty if you render something out here it's going to show instead so now we can say my library because clearly the user is on the my library page and another thing I want to do is I'm going to add font bold to this so it looks better also just looks a little funny right okay so add font bold up here all right great job okay so our Global layouts is pretty much done now we can move on to creating the folders the videos and all this kind of fun stuff okay so go back to your page. TSX which is under this and let's see what we need to render in here all right guys so I'm not talking about this page by the way don't get confused the workspace ID page. TSX okay because in here we're going to do something slightly different so since we already have the check inside the layout we're good to go we don't have to do that in here but inside this page we're going to have the triggers or the the TBL list along with the triggers so these are tabl lists right here okay so you can create these tabl lists and essentially you can render whatever component you want in here right so for now we don't really need this I just want it to look nice and pretty so here's what I'm going to do first thing is remove this or actually let's get the pams so I'm going to say pams like this and this is going to give us access to workspace ID which is a string I'm also going to destructure it from here okay and now that I have this I can return a div okay we're already returning a div in here so let's remove this and now we want to return the tabs component from components UI all right please do not import this from radic UI and then come to the Discord and say I'm confused okay see what you're importing and accordingly ask questions okay we're always here to help you but I want you to also think right don't just use support because it exists but use support because you're absolutely lost and you have no idea what's going on okay do some research first so first thing is a default value so going to say default value this is equal to videos and the class name in here is going to be margin top of six okay now inside this we need the we first need the tabs list right oh actually let's create a container for this so we're going to say class name of flex width of full always make this eror with flex width of full justify Center or Justify between and items Center okay and inside this we can create our tabs list so tabs list component see I also made this eror here so tabs list like this and this is going to have the following class name so we're going to call this uh we're going to add BG transparent gap of two padding left of zero okay and now we need the tabs trigger so create the tabs trigger component and the first one is going to be videos like this the second tabs trigger is going to be archive okay now let's go ahead and give class names for this as well so for the first trigger for the videos trigger I'm going to set the following class names all right so please type this out and after this one more prop on this which is called value which is super important okay so value is equal to videos all right because the default value is videos so this is going to be checked by default and next down here we're going to have another value prop for this and this value is archive okay so now you can pretty much swap between them but we need to give it the same styling right so let's go ahead and pretty much copy this and paste it down here as well so class name just like this all right awesome all right now I don't have a way to create a workspace from here so I can create a button here because I already have create folder right so after this tabs list I'm going to create a div and I'm going to say Flex Gap X of three okay and inside inside this I'm going to create first component which is called create workspace okay just like this and I'm going to copy this name and open up my folder structure go into components globals and I'm going to create a folder in here called create Das workspace just like this okay you can also make this a local component I think that would make more sense but for now I think this is fine all right doesn't doesn't really make a big difference so create an index. TSX I'm going to return a component here and rename it all right you guys know the the drill all right now the first thing is we're going to need to use our hook that we created called use Query data right so let's go ahead and grab that and also the reason why we need this in here is we need to grab the users subscription their workspace and their members right and if you see up here we have one of the actions that can do that inside the workspace uh folder right here right get workspace so we can use this and essentially uh get that data from here okay so first thing we're going to do is we're going to say const data equal to use Query data okay let's invoke that and the first one okay what is this okay the first parameter is going to be an array the second one is going to be the server action so get workspaces I'm going to pass it in here and now the key for this is going to be user- workspaces okay and if I'm not wrong I think we already made this call somewhere in the file yep we did so it will probably be cached okay if not then I think that should be fine but let's see how it goes and then if we need to do some sort of uh wiring up for that we'll we'll figure it out okay but first thing now is now that we have the data we need to extract the plan right we need to get the plan stuff so what we're going to do is we're going to type cast it's not typ cast actually actually let's typ cast so we'll say data um we're going to rename it to plan we're going to set it to data as status and this is going to be a number and then we also need what's going on here data is unknown did I make some sort of error here all right so first thing is I made a huge mistake see this is I hate typing man I make so many errors change this to use Query data and let me show you a cool way to do this you can do command shift F if you are on Mac and you can hit this little drop down here and you can replace this name with with use Query data across the entire project okay and if you click on this it's going to replace all occurrences of that specific thing okay and now uh let's see what error we see here I can remove this and use Query data can now be imported with the right spelling all right so now U the other thing I was doing is just hyp casting and also extracting some data from here so let me go ahead and do that so I'm going to say const data plan equal to data as we're going to create an object here all right and in here we're going to set the status to be number and then we need the data itself and the data is going to have subscription okay subscription and this subscription is going to have our plan which is either going to be Pro Plan or it's going to be the free plan right and finally down here we can set if they don't have anything it's just going to be null right okay cool now that we have this data we can say if the plan subscription is free then we're not going to return anything because they cannot create a workspace right but if they are on a Pro Plan then we're going to return something down here okay well what are we going to return we're going to remove this and we're going to return a modal component very similar to what we did previously and we're going to have a title and a description so I'm going to say title description which is create a workspace this action oh well I think this comes from from chattian so let me remove this um I'll say okay so I just put some description in here as well and inside this we have to pass in one more prop which is the trigger right and the trigger of course is going to be a button element now I see some errors here so Global sidebar. TSX is panicking use Query data import this what's going on let's uh let's find out all right so let's go down here we're going to go in here and see something here what's the matter use Query data let's go into the file itself use search use Query data query key use Query data something's going on here did I mess up something okay it's because of the file I believe right so change the file also to use Query data and let's see what's going on now so usequery data. TSX export this here usequery data I have no clue what was the difference between this and this it's just typescript guys all right oh man typescript is so annoying okay so at hooks use Query data so I'm going to say at hooks okay slash what's in here okay cuz it's a TSX file maybe that's the reason let's change this to TSX and see if it's going to give us any data here so I'm going to scroll down import this hook again all right now I think it's working okay now now it's working okay it was a file name sorry about that and now we also have some more errors here what is this error okay create workspace let's of course go ahead and import this before we start building everything and I have to build my password cool okay now I see more errors here what's the error no such file or directory let's refresh okay up here right so replace this and import it again use Query data let's refresh okay now I see some more errors man that change kind of messed me up all right guys give me a second let me fix this okay was the most annoying bug ever took me about an hour to solve this or even more I'm not even sure but it it was very simple and I'll tell you what I did and what the solution was but first thing is I saw that error that said that the used query Hook was not a function right and clearly inside a hook inside our used query data hook this this is a function you can hover over it and it'll show you right it is a function so the error message that nextjs was giving me was not you know clear enough for me to identify the issue so I thought maybe it's something to do with the file right so I changed it to do typescript even then it kept showing TSX so everything was cached so I went up deleted next folder restarted everything and then I also deleted the node modules just to make sure I didn't mess the node modules folder and then I reinstalled node modules and then I did bun and Bun Run Dev everything spun up again and I still saw that issue okay now yes I do know that if you're using a hook inside a component you need to change the the file to use client right not this one but any other component and yeah well if I don't do it it should show another error message which is if you're using client components well you need to change this to use client right using a hook or a client component in here you need to change this to use clients but it wasn't giving me that error message it was giving something else super weird Okay so after hours all I did was put use client on the create workspace and that of course fixed the bug okay so if you saw that error I'm sorry and if you were trying to debug I'm sorry about that as well the answer is just put use client up top now let's scroll down here where we have our modal component and we need to still complete this right so inside the trigger first thing is I'm going to going to add some class names some styling to this I'm going to say class name and I'm going to add the following Styles and let me just put something in here so I can see something render okay well nothing is going to render because it doesn't um you know this doesn't satisfy right it's not a free I mean it's a free account and as a result we're not returning this model so you could just return an upgrade button here if you'd like and of course we have already done you know the I mean I'm I'm going to show you how to do it but right now I just put the loader component in here but eventually when we're wiring up everything I'll show you how you can do it and you can reuse the same logic in every area in your application okay so for now down here we're going to import the folder plus icon okay and you want to get the duo te icon made a spelling error here anyways and I'm also going to just remove this if condition for now so remove if here and Save okay nice you can see that right there so we're going to show this and say create a workspace and down in here we want to have a form element where the user can give the workspace folder uh sorry the workspace name okay to create that workspace so I'm going to create a component in here called workspace form just like this I'm going to copy it and I'm going to go into my folder structure under Global and I'm going to create a new component in here called workspace Das form actually maybe we can create a forms folder let me take a look all right that makes more sense so let me shrink the global folder and I'm going to create a forms folder in here and I'm going to move my uh this is a create okay this is fine let me grab the workspace form and move this somewhere up top here inside this forms component okay nice and now inside this I can essentially return that oh something's what's going on on here okay forms workspace form inside that an index. TSX and I'm going to return a new component like this and also go back and import the workspace form component okay now inside this component like I said it's going to be inside that modal right so when they click this a model is going to show up we want that form to be in here so for that form all we're going to do in here is first we're going to get a hook called use create workspace okay so I'm going to copy this and now I'm going to scroll down into my hooks folder and I'm going to create the use create workspace hook. typescript and let's just quickly say export const use create workspace is equal to an arrow function and inside this we're going to need use mutation data so first thing is we're going to say const we're going to destructure some values we need mutate and is pending right so we're going to get use mutation data we're going to invoke this and first one is the key right so the key right here is going to be create Das workspace and after that we're going to need another arrow function and this Arrow function is going to give us data which we're going to destructure and we're going to get name which is going to be a string and this is going to return another uh server action called create workspace okay work create workspace like this and this will of course need data dotame inside it so whatever the user wanted right and and there's one more thing we need to pass in here so let me go ahead and pass that in as well so the first value is the mutation key second one is mutation function and then some other stuff as well right like another key query key that we can pass in so the query key we're going to pass in here I'm going to put a comma and I'm going to say user- workspaces now let's go ahead and create This Server action so scroll up top inside your actions folder you're going to scroll to the bottom and you're going to say export const create workspace which is going to be an arrow function okay and this is going to need the name which is a string and inside this first get a TR catch block and we're going to say const user equal a wait current user if there's no user you can return status status of 404 okay and now if there is then we're going to say authorized authorized equal await client. user. find many okay or sorry guys find unique okay and this needs to change to an async function where the clerk ID is the user. ID okay and then we're going to select the following info we need the subscription data and we're going to select specifically the plan information okay and now let's scroll down here if the authorized the user. subscription plan. plan itself is equal to Pro Plan then we're going to do something in here we're going to say const workspace equal await client. user. update okay where clerk ID is equal to user. ID and the data that we're going to create here is that new workspace right so we're going to say workspace create okay the name and the type here is going to be public all right so essentially if they're authorized and they have the Pro Plan then we're going to create their workspace okay straightforward and then if everything was successful we're going to get the workspace object right then we're going to return a status of 2011 okay and then we're going to return the data and you can return the workspace itself if you'd like okay or um what's the arrow here workspace so this has to be in inside this so if workspace exists then you can return this and for data just for now I'm just going to say workspace created you can return the same thing as well and I think that's probably better here but for now I I don't think I need this data right and then next if everything was successful if nothing worked then we're going to say 401 for the status right and the data is going to be set to something else in here and the data is going to be you are not authorized to create a workspace okay and then down here we're going to return status 400 okay this is if some error act took place apart from all of these errors and let's go back in here and I'm going to import create workpace in here and now I can proceed okay so this Hook is going to essentially use the used mutation data it's going to get the query Keys uh this is the query key and also the mutation key and next down here so essentially what this is doing guys is we are creating the data and we're also invalidating revalidating the data as well and we're appending the new workspace information to this okay to this um user workspaces query key that's pretty much what's happening here okay so next const equal to use Zod forms this is another hook that we need so I'm going to go ahead and create this and the reason why we need this is if you remember in one of the previous projects we had to do a bunch of stuff for the used Zod form uh the used form hook right so this time we're reusing all that logic um and creating a hook out of it so we don't have to do it a 100 times we just have to do it once okay so before this let's just go ahead and immediately create this form hook so it's called use Zod form okay and typescript of course and here I'm going to say export const or we'll say const use use Zod form this is fine as well and this is going to be an arrow function and down here I'm going to export default the use Zod form okay nice so inside this first thing I'm going to do is I need a bunch of values uh bunch of props so first thing I need is schema and the schema is going to be Zod schema all right why is it not importing something is going on here just give me one second okay so just scroll up top and I have to manually install Z and Zod schema okay so the schema here is going to be of type Zod schema mutation is going to be of type use mutation function okay go ahead and import that one as well and then the default values which are optional are going to be of type any okay for now uh you can also use generics if you want right here but I'm just going to say any for this okay next inside this we're going to say const and this is equal to use form okay this is a hook that is needed to essentially register the element the input field to watch it to listen to Value changes to get handle submits error States all this kind of fun stuff okay so first thing we're going to need here is we're going to use this generic uh angular brackets and we're going to say z. infer and for that we're going to pass in the type of the schema that was passed in okay then next thing is in here we need to pass in our resolver and the default values right so this is going to be Zod resolver which for some reason is just not importing so going to need to do it on my own so hook forms SL resolvers slod okay so now I can import this and I can invoke it and pass in my schema and the next thing I need is the default values and for default values I'm going to pass everything that's inside the default values all right nice great job guys now I need to also return this right don't forget about this so const on form oops sorry first let me destructure everything so we need register we're going to need watch uh maybe reset and then handle submit right okay and then I think we also need to get errors and I think errors is inside form State form State and inside that error okay errors nice so now we have all the values that we might potentially need you can get more out of this but this is enough for now so const on form submit equal to handle submits this is going to take in an async arrow function okay so let me provide this nice and this has to return mutation we're going to invoke with all the values passed into it okay now where do we get these values from these values come from the handle submit function okay so let me just complete this one more time so values and in here you're going to say values just like this okay nice all right so now that we have this done we can return all of this stuff so return and we need to return our register watch reset what else do we need we need the on form submit function we're going to need not watch and reset we already did that let's get errors as well all right nice now we are returning everything right here okay and this is also being exported nice so now I can go ahead and import the use Zod form hook the first parameter here is the schema right right we have the Zod schema then the mutation itself and any default values if needed so let's go ahead and create a schema for our workspace so scroll down to types and in here you're going to find uh let me see okay we have an index file and I'm just going to put it in here for now or actually H I think a better folder structure would be to do it inside the form itself right so we're going to create a schema. typescript file inside our workspace form or inside any expected component right which it has to be inside the form of course and here we're going to say export const workspace schema is equal to Z doob and Z is not imported so let me see if it's going to give it to me okay Z doob invoke that and in the object you're going to pass in Z do uh name which is a string so this is the syntax okay so string and the minimum characters is going to be one and if that's uh if that's not satisfied the error message we want to show is workspace name cannot be empty okay awesome I wish they actually had a required field they just made I don't know why they made this update super weird okay let's go back and inside this now I can import um sorry I've already imported that but now I can pass in my schema okay so workspace schema like this and next is the mutate function which we're going to get from this use mutation data so first go up here and you're going to grab mutate and is pending okay and if you don't know we already created this right I hope you remember it essentially does the whole mutation part under the hood uses an on success and um uses any of the a call back function that we provided and it'll invoke that for us if you provide okay but of course I don't think we're going to provide it here but I'm just showing you what this does so you remember so let's go back and provide the mutate in here nice and now finally we have to return something right so this Hook is going to return the error state of course the on form submit and the register state okay everything else will will happen on the form itself so let's go ahead and we're sorry we're not returning here we're destructuring it from this because we have to also return the is pending State from here okay so I'm going to capture all of this return it here and we're also going to return the is pending okay nice now let's go back to our form component which is up here index. TSX and now we can import and use this hook so const and this is equal to the use create workspace hook and now we can destructure all the values that we need in here directly and now we can return a form component so return a form component we don't need action in here anymore we're just going to set the onsubmit function in here to be the on form submit which we just destructured and for class name Flex Flex D column and gap of Y of three and let's also see what we're doing okay so in here of course we can't see anything if you put something in here you probably will be able to see it right nice the first thing we need is this magical form generator component that we created that makes it super super easy to wire up form elements okay or else it's a huge process because you need to create labels the input Fields error messages and kind of wire up everything individually for every single page so that's why we created this Global component here called form-g generator okay index. TSX of course and I'm going to return a component change this to form generator as well okay now there are different type of form elements right all you would have to do is come in and update all of these types when you want to expand on this form component okay so for now we only have text email password and number now you can have file upload and we' have done so much in the past we don't need it right now okay so that's why I only need these types and next is the input type itself so we have select input and text area okay now this type gets passed in directly into the input field so this is technically should be like this so it makes more sense or actually this is fine as well but yeah you get the point right the input types is all you would have to expand on guys sorry not this one this goes into the input field telling it whether it's a text email or password field okay but input type is all you would have to come in here and pretty much put your own custom input type if you have anything okay next are the options for this form element which is the value the label and any ID field so I'm going to bring that in and this is optional and the reason why we need options here is not options for the input field but it's options for a select item okay keep that in mind so for each option we have all of these props okay but now for the input field um you know itself we also need label then of course we need the placeholder then uh next we need to register the element right so the register is coming from use form hook so it's of type use form register all right so capture this as well and then we need name which is going to be string errors as well which comes from use form hook so I'm going to bring that in we're going to say field errors and which one is this this one or okay there's error okay errors okay not error and this one is going to take in the field values okay field not value but values okay and next is we're going to have something here called lines and this is if we're using a text area then we're going to need to pass in how many lines it can have like I mean basically the rows correct so that's what lines means right here okay so this is of course going to be a number nice now we want to go down here and we're going to destructure all of these values cool now remove this because we are going to use a switch case Okay a switch statement that looks at the input type and for the case we're going to check if it is of type input and if it is then we're going to do the following right here so the first thing we're going to return is a label with the input and all of the elements it needs for the input version input type okay this one the uh where is that input type so I'm going to return return a label what seems to be the problem here okay I know what the problem is so let me just undo this so we have to return something okay so return first we're going to have label input error message that's it very simple okay so I'm going to import the label component we're going to have the following class name so please pause and type this okay we're going to have the HTML 4 which is going to have input Dash and the label itself that way we we can combine these two right and if label exists we're going to return the label then we need of course the input component so bring that in as well this is the ID and for type we're going to have the type the user wanted okay it's optional of course but we're going to pass that in placeholder class and finally the react hook forms related stuff so register all right and of course you have to pass in the name as well that's how it's going to keep track okay now next one is the error message very simple stuff so I'm going to import this error message component just give me one second and this comes from react hook forms I believe hook forms error message so something seems to be off let me fix this real quick guys give me just a second looks like you have to install the hook forms error me message separately okay I thought it would install it when we when we installed all components in chaten but that's fine so all you have to do is open up your terminal and you want to say bun add and paste this at hook form slair message or if you are on Windows please use npm you're going to say npmi and you're going to add this all right and once that is done it should install that library now you have to manually put this here and that will install the component itself okay so now as you can see I can see that component in here so you're going to say error message pass in the errors pass in the name and for the render prop you're going to show what it should render when an uh when a error message occurs okay so this will give us access to the message itself which comes from our schema file and it just happens under the hood okay don't don't worry about it it's just syntax to use react hook forms and if there is a message we'll show the message if not we'll show required okay nice now I'm not going to go crazy s and type this for each and every single uh you know input type but I'm going to explain over it please open up the GitHub or pause the screen and type that's the best way for you to learn okay so I'm going to paste this here this is for type of Select and all we're going to do in here is we're going to return a label component same exact thing okay copy this label paste the label down below here if the label exists we'll return a label next we need the select component so create a select component and for that pass in the ID as well same thing as the HTML 4 and the class name is going to be like this so with full BG transparent border one pixel padding three and rounded of large okay pass in the register as well so now this registers our select element next if there are options then we're going to map over them and return option for it and pass in the value key and a class name and of course the label for that option itself okay and same thing error message down here nothing else crazy now for the text area which is the last one we have to do the following so this we're going to say text area if the label exists render the label out now we need the text area component from our components Library so uh components folder so I'm going to import that and then pass in the following class name which is transparent board theme gray text theme gray as well okay and it's the same thing as this HTML 4 placeholder register and the rows okay I would suggest putting this above but right now it's here so actually let's just keep it like this okay so rows lines and the register itself and the same error message okay now knock yourself out do as many as you want this is all we need for now if we need more we'll come back to this okay so now this should work so let's go back to our component and let's continue to render out the form generator component okay so in here uh which is our workspace form component I'm going to bring in the form generator okay and this can be a closed component and now we need to pass in first the name so I'm going to pass in name here then we need placeholder label and the errors the errors here and our label is going to be workspace name and the placeholder is also going to be workspace name next we need to pass in the input type okay which is input and the type here is if I click on this it's not going to show something one prop which is the register prop okay so that's a very important prop that you need to pass in so if you refresh let me dismiss this now there you go you can see the workpace name okay looks nice and you can also give it a better name here so you can just say maybe name here right like this name and then workspace uh workspace name that's fine and next we're going to need to have a button to to submit this form all right so we're going to create a button component like this and for class text- smm with a full margin top of two and we're going to say type equal submit okay and next we need to also say disabled is equal to is pending so when the API request is firing then we want to disable the button right that's why and next we need to have our magical loader component that we created as well and this component is going to show a loading SP spner spinner based on the uh is pending State okay and here we're just going to show create workspace and if you click on this just like that it's going to show right in here and that's it that's pretty much it for the create workspace component cu the user you know is still under the free plan right I don't want to mess up all of my data but it's going to work okay it will work you can just read the code and see we have a server action here the server action will fire and that's that's pretty much it right it's going to do all of the down here if it's a free tier me if it's a pro tier member only then will it create the workspace for them right so let's go back and now yep that's pretty much it so next thing we need to wire this up with that um with that Pro member or free member tier right so let's go back to our component which is our create workspace component and I'm going to just kind of undo all the stuff here free and pay tier right and now in here I can render out that uh workspace form so so remove this and import workspace form so now you're not going to see it because the user is on a free tier okay nice everything's working great job create um the create folder button right so and if you see right here we this is the sidebar actually want to go into the page so I'm going to go into this page the workspace ID page. TSX and inside this one we can now create the create folder uh action right here okay so we're going to pass in a prop right away away this is the workspace ID okay because we have to create the folder under this workspace ID right so we're going to say props or actually we don't have to say that we have to say pams not props pam. workspace ID and now we're going to have to create this component so open up your folder structure go down to globals we're going to say create Das folders what am I typing folders and index. TSX and inside this component I'm going to render out the create folder component okay Now quickly go back and import so we can also see what we're building all right and it's pretty much the exact same thing the only difference the only difference is the server action that's being performed right okay now inside the create folders I'm going to add a work in progress flag called add create folders the reason is because I first want to see some folders before I create them right so let's go back here and let's create our folder section and then we we can get back to this because we already know what this is going to look like right I already showed you right here with the workspace it's pretty much the same thing we're just going to have to first render out folders to see the UI and make sure our layout looks great and then we can move on to creating this little button here okay and the button literally doesn't do anything and I I would like to use optimistic UI for this as well I'll see if it works um I'll see if I can figure out a way to do it in the in this short span of time and if it does great I'll show you how to do that okay so a really really cool feature anyway so right down here first thing is create a section tag and for this section tag give it padding y of nine okay and inside this we're going to say tabs content and import this from our UI folder for the values we're going to say if this is videos then we're going to render something in here we're going to essentially um render the videos itself right because archive we're not really building that I'm going to leave that up to you as a bonus okay but I want to show you how to do this section alone right so we're going to create the video section in here and inside this we want to show the folders okay so these folders are going to be another component which are it's a new component so don't import the folders from the Icon okay so folders like this and I'm going to instantly pass in the workspace ID because inside this we're going to need to pull all the folders itself right so I'm going to say pams workpace ID like this so then I can pull in all the folders for this component okay so now open up your folder structure scroll down to Global going to shrink all of this as well and now I'm going to create another uh folder in here called folders and inside that I'm going to create the index. TSX okay and in here of course you guys know the drill just return a component and change it to folders first we already have this workspace ID being passed in so I'm going to capture that okay okay and then I'm going to go back and import our folders component from the components folder not from Lucid react and now that should no longer scream at me nice okay and now the first thing I want to do in here is I'm going to use a hook here called use Query data to get all the workspace folders right so that's essentially our first step so first thing that I need to do in here is get folders okay then I want to also maybe you know give a way to add this to some sort of a optimistic UI data right so if we have an optimistic variable let me change this optimistic variable I want to add the new data that was created to that right so I want to pick it up from here as well so not just the response for that's coming from the API but also this optimistic UI variable right so that might be another step to perform here and then I'll see what else we need right but for now let's go ahead and try to render out all of these folders so first thing is we're going to create a class name for the container Flex Flex Das column and gap of four and inside this another div with flex items Center what is this okay Flex item Center and justify Center uh justify between and the next thing we need here is a div inside this and this div is going to have the following class name so Flex items Center and gap of four okay so just to show you what we're building as well inside our figma file we're building this beautiful design right here okay so first thing is we're building this and then we'll build this section so inside this div right here we're going to have the folder Duo tone icon and we're going to have an H2 tag with the following class name not children class name is going to be text um with a special class so I mean special color code so we're going to put b d BD all right this is the text color and then the text is going to be Excel okay next here I'm going to set this to folders and all right there you go so now we can see the folder title and now after this we want to create another div with the class name Flex items Center and gap of two okay and after this in here I'm going to have a paragraph tag with a class name set to text and I'm going to provide this same color that I had in here so put the hashtag so please pause and type this and after that I'm going to say more okay now here the user can essentially pretty much see everything so you can also change to see all but um or see scroll whatever you want right more sounds better to me and arrow right this one should be good to go here and we have to also give it a color cuz I don't like this color it's too bright so I'm going to say color like this and maybe we can also change hm let's change this to c all I like what we have in here right C all this might be better okay see all scroll for more whatever okay next after this div right down here all right the second div not the first div we're going to create our section so we're going to say section like this and this section is going to have a class name but this class name is going to need our CN function because we're going to pass in some Dynamic variables and if data exist then we'll return that data okay and for that we're going to need to maybe pass in a class name to hide these elements right and the other thing is if it's not a 200 response then we want to show no folders exist right stuff like that so that's why we're going to need this uh CN function right here but for now just for the sake of this section to show you what it looks like I'm going to skip over this and just render out a folder inside this section okay okay so let's go ahead and first create the class name in here so I'm going to skip over the first part again like I'm saying skipping over that and just putting the default class names okay so it's going to be Flex item Center gap of four overflow X Auto and with of full all right now if we have no 200 response then we're going to show something else in here we're going to essentially um what is this get all I think I pasted something by mistake see all okay if we have a 200 response from this API call then uh if we don't have a 200 response then we'll essentially render out justify Center okay I know it's not going to make sense right now but just hang on okay for now just build out this one single folder so I'm going to say folder in here like this and now we can go ahead and create that folder so inside this you want to create another file called folder. TSX and I'm going to return a folder just like this now this is going to need a couple props right the first one is name the string and we're going to need optimistic which is a Boolean and count okay because there might be some uh videos inside each folder right so that's why we need this so let's go ahead and grab string ID uh name which is string ID string optimistic which is Boolean count which is a number okay and finally we need to also destructured from here so I'm going to destructure everything nice and now we're going to need the path name so let's go ahead and say const path name equal to use path name and let's invoke that and also change this to a use client component now go back and also import our folder okay so now oh I imported it from the wrong folder the wrong section so this one all right guys in this in this directory and this is going to need all these props it's going to scream at me but for now it's fine okay so why do I need the used path name well it doesn't really matter okay first of all just want to give you a heads up because you can change this to a link element and when the user clicks on that link it can take them to that folder that's fine as well but I want to show you how to programmatically send a user to a different page this is very important in development especially in nextjs because you're going to need to leverage the router API you want to use router. push okay so I just want to show you a different way of doing the exact same thing so don't worry if you if you wondered why didn't I use the link element that's the literally the only reason okay so first thing is I need path name here and then I'm also going to get router okay and then next we can go on to building the Styles and stuff but for now I'm going to say use router and I'm going to import this so first thing is this div is going to have the following class name so you want to remove this and you want to use the CN function invoke it and inside this for now I'm going to pass in the default Style okay and the default styles are going to look as follows all right so we're going to say Flex hover BG neutral 800 so when I hover over this it shows this really nice color and the transition is going to help me create this fade effect okay the subtle transition effect and then cursor pointer duration 150 so it happens over 150 milliseconds item Center Gap two justify between minimum width of 250 padding y of six padding X of four rounded large and Border one pixel okay so you can already see the folder structure form right that's pretty much it so now we have this in here the next thing is when the user is trying to uh maybe update the state or create new elements we also want to have the loader state right so before that since I'm only trying to render out the element in here I'm going to say work in progress add loading States okay just like this nice now in here I'm going to create um the loading component loader a d r why is it not showing the right loader component okay it wanted to import it for me from from Lucid react so I'm going to try to do it one more time okay nice this this really hates me man okay loader and for the state I'm going to show false okay just to hardcode it for now and inside this we need a div first and the class name is flex Flex D column gap of one pixel okay and now inside this div we can essentially show a paragraph tag and this paragraph tag is going to have text- neutral D300 or let me see 300 like this all right nice and in here we can render out the name so name just like this okay nice now we're not going to see anything in here because we haven't provided a name so I'm going to go back and I'm going to say name equal folder title just as an example okay okay and I see some unexpected end of Json what is this error okay never mind it was just magic and that's it now you can see the folder title is rendering right and the next thing we need down here after the paragraph inside the div itself right right here is a span tag and the class name is going to be text small text- neutral NE Neal and this one can be 500 and this is going to be the count okay so the number of videos so count actually we did not create that yet right oh we're passing it in right here sorry guys so count or zero so if nothing is there just show zero folders and I'm going to say videos like this okay zero videos guys sorry not folders okay nice and that's it now we also need to render out the folder Duo tone so I'm going to import that just like this and now we should have the folder icon right here okay nice you can also reduce the height height of this let me see if I have any padding what if I change this to four huh maybe that looks slightly better I guess right all right that looks so much better and that's it so now if I go back and if I duplicate folders in here let's see what that looks like okay it's going to sort of aen side to side and you can also scroll past it okay that's the whole point of this and of course if you click on one we want to have the functionality to send the user to that page and also have it as the active state right so there's so much stuff we need to do in here and also what if the user wants to update this title right that's another feature we want to add and I think I want to do that optimistically I'll see if I can um let me remove this and let's go into the folder itself so we can make those new changes okay so now we have the router here all right guys so just give me 2 minutes I want to help you understand a small web development concept okay I'm sure I don't need to explain this because you guys are SAS developers right you're business owners who are only here to make money I know but I want to also help the few other students who are learning web development as well I know there's a bunch of you guys who are here trying to learn web development too so I'll just show you okay so in web development when you have a Dom structure that looks like this you're going to have elements that are of course nested within them right a click event fires from the nested most event um elements that event will fire up the tree okay it'll literally go up the tree from here and then go to the outermost layer this is called event bubbling okay I don't want to get into too much detail but I'm just saying this will happen if you have two click handlers that are nested okay so to show you an example right now I have a click Handler right here called on double click that is on the paragraph tag and I have one that is on the entire element itself the div okay now if I double click the div of course it's going to show running right but if I double click the paragraph tag it's going to show fired and running as well so that shows that the event is bubbling up the tree okay now what is the purpose of me explaining this I want to create a feature when I click on the element this is basically right here if I single click on this tab I want the user to get navigated to that page and when the user double clicks on the text not on this because if you double click and have a click Handler then the first click Handler is going to get registered and it's going to immediately redirect the user so we can't do that right so single click on the tab and doubleclick on the folder title and when the user double clicks I want to give the user the ability to directly change this right here itself okay and I'm going to see if we can wire up optimistic UI to show the change in real time all right that's why I wanted to explain this concept so we're going to essentially stop propagation and that way we can uh pretty much prevent the event from getting you know from the event bubbling to take place okay so first thing we're going to do in here is we're going to have an onclick Handler so the onclick Handler here is for the single click to redirect the user and then we're going to have an on double click Handler right in here and you can also have a regular click element in here as well because if the user tries to click the title and it doesn't take them to it doesn't route them to the page they're going to be quite confused right so you can have the single click element in here as well if you want to okay so let's first go ahead and finish this part which is handle folder click okay so I'm going to remove this and I'm going to say handle folder click okay like this and this is going to be a function so we can invoke it in here actually sorry we can't invoke it we have to go up top let's remove this and that's why we don't need to I mean if you're passing an error function then you need to invoke okay right now I just want to keep it like this we can say const handle folder on click and we can pass in the Callback function and this is going to do the following first thing is we're going to say if there is um if there is data right or actually we'll just do this right now this is going to make sense for you so router. push and we're going to use back tick and we're going to push the user to the following path name slash folder slash and this can actually we can remove this now right so path name why is the bracket not closing okay slash folder slash and then we can put the ID okay the ID that we get in from this folder as a prop so let me also shrink this so you guys can see more all right so that's the handle folder click so when you click on the folder itself it's going to redirect them so as you can see it redirected me through a page of course it doesn't exist but that's the whole point of that okay then we're going to have another click Handler here and this click Handler is going to be called handle name handle name double click okay and this is going to be an arrow function in here as well and we're going to get our event in here okay now we're going to need this event to stop propagation so we're going to say e. stop propagation and we also need some react types in here it's going to scream at me so I'm going to call this react. mouseevent and in here I'm going to pass an HTML paragraph element okay so I'm going to stop propagation and after this now I can fire the rename functionality so first thing is let's go ahead and create a state for it so I'm going to say const on rename and set on rename that's equal to use State we're going to invoke this and this is of course going to be a Boolean so I'm just going to set it to false for now and the next thing I need is some refs to keep track of uh to basically change the value that's inside an input field that we're going to get soon okay that way when the user is changing the name this turns into an input field okay just keep that in mind so let's go ahead and create those refs so first one is Con const input ref and this is equal to use ref okay just like this input use ref this is an HTML input element type and or it's going to be null okay the next ref we need is the card ref essentially this ref okay so I'm going to grab that ref as well it's called folder card ref and it's an HTML div element or set to null okay then I'm going to create two helpers here it doesn't really matter you don't need to do this and uh it's called rename and renamed okay and all they do is they set this value to true and false all right the next thing I want to make sure is my on double click has the handle name double click function uh The Click Handler and the on click here has the handle folder click Handler on it okay nice next thing is we're going to need some optimistic stuff in here right and for this first we're going to need the use mutation data so I'm going to say const equal to use um use mutation data and I'm going to invoke that and from this of course we're always going to get our mutate and is pending so I'm going to get those right away and now the first thing is the keys that we need to pass in here mutation keys and the mutation keys for this one is going to be called rename folders okay and the second one is the Callback function that is going to help us make this change here so I'm going to pass in a callback function and next we need the uh let's see what we have in here okay we have the query key and the query key here is going to be called workspace folders okay so let me put this in a string and finally we have one more which is a callback function I I believe on success right so when this API request is successful what do you want to do well we want to essentially change this rename function this rename value to false that's what we want right because when the user is editing it we want to show the input field and we'll do that when renamed is when this on rename is equal to true and when it's false we're going to remove it so that's why we need to pass in that callback function so on success it will be fired in here okay so renamed not rename all right and this needs a comma here okay awesome now what is this callback function it looks like there's some error here um okay it has to be a mutation function right so first thing we need to do is we're going to get the data from here right and this folder is going to need the name which is the string so let's go ahead and destructure these values and the next thing here is we need to return a server action okay so that server action is called rename folders and of course for now we can just invoke it and I'm just going to copy this name of the folder and now I can go into my workspace file right here under actions and I'm going to say export PST rename folders is equal to async function okay because it's a server action and this is going to need first the folder ID which is a string and we also need the name that the user was trying to change it to right so first again you guys know the drill get a TR catch block the folder is equal to await client. folder. update okay and for this what are we going to update well we want to update for this specific folder ID so where the ID is like the folder ID that the user passed in here and the data that we want to update is the name okay hope this makes sense and next if the response was successful then we're going to return an object here with status set to 200 and we also need data and we're going to set data to folder renamed okay but if everything else failed something happened wrong we're going to return a 400 response and say folder does not exist okay and now down here we're going to return a 400 saying or 500 saying something went wrong okay so oops some oh this should have an E I think right not really sure but oops probably so something went wrong all right let's go back and quickly grab the server action all right and now we need to pass in those values so the folder ID is essenti going to be what the user is working on right so let me search for this right here this ID so go ahead and pass in the ID and the next thing we need is the name right so let me remove this and for name we're going to say name like this and okay looks like our query key is also passed in the success Handler all right nice now we need a Handler to invoke this mutate right what is that Handler well that Handler it's it's just the update folder name and that's going to happen when the user clicks on the on blur for an input field okay if you don't know what on blur is then that that's fine I'll I'll pretty much explain it to you while we're developing but we're going to say update const update folder name equal to an arrow function and this Arrow function is going to give us access to the event so I'm just going to call this event like this and in here first we're going to make sure that we have values that are stored inside the input ref and this folder ref all right because if nothing is in here that means those values aren't appended correct and the next thing is we want to make sure that the input ref's current value does not contain the event Target okay because when we're trying to make the change we want to make sure that we don't have those elements itself right because if the input field is still existing on the page then that doesn't really make any sense right that's why so in here we're going to say if the input ref. current if there's something that we stored initially in here right if that exists and folder card ref. current if these two exist then in here we're going to check for the opposite right remember I just mentioned so we're going to say input ref. current do contains and we don't want it to contain the event.target as the event sorry event.target okay not as node we're just typ casting it as a node right and this event is e down here and if or sorry or null okay so essentially we need to also typ cast this so I'm going to say as node and essentially we're checking if the current contains this Target and if it or if it is null and we're trying to get the opposite of this okay and then the next one is and pretty much the same thing but for the folder current ref okay and in here I'm going to change this to folder card ref like this let me put this on two different lines if it'll allow me to okay nice and what are we going to do in here well we're going to invoke mutate and pass pass in the optimistic UI update for the name okay so down here first we're going to make sure the input ref. current. value exist okay because it's input field right and if there is a value then we're going to invoke mutate like this and in here we're going to pass in the object with the name property set to the input ref. value so input ref. current. value okay value like this or if nothing exists then we'll invoke renamed okay just like this nice all right looks great and of course as you know when we're mutating it right here this will also invoke the renamed once it is done by default so we don't have to invoke it here you can if you want but we only want that to happen once everything's successful right so you can provide that directly in here itself that's the that's why we needed this on success Handler okay all right now going back down here first we're going to provide the ref which is a folder card ref and we also need the input card ref right the input ref so let's go ahead and build that out so Above This paragraph I'm going to say on renamed or on renamed it actually create that variable up here on rename okay so this means if we are actively trying to change the name if this is true then we want to do something in here or we want to do something else in here okay so what do we do if this is true well if this is true we're going to be returning an input component okay just like this and again guys you can do error checking if you want you can make this modal anything you want but I like it this way cuz I want to instantly give the user the ability to edit right so we're going to add the following in here so first placeholder and the placeholder is going to be the name itself so whatever they have right here right this is going to show up in there and then after that we want to pass in a class name and the class name is going to be border dnone underline and we want text-base with a full outline none text of neutral of 300 BG - transparent and padding of zero okay so p 0 nice and then we have to provide the ref itself so ref equal to input ref all right nice now this paragraph we're just going to remove it and paste it as the else block okay so let's try and see what happens okay so it looked like I clicked on it and it went to a different page so let let me try double clicking all right so I think the reason is because on the paragraph we also need to have an onclick Handler that's going to do the following right we need to get the event here and we need to stop propagation here as well or else the single click is going to go right back up right so let me try to see okay it looks like it is still sending the user back let me test it out okay now it looks good all right so you see we're editing but something seems to be off let me take a look as to what's going on so let's go into console Let's uh get the errors and I'm also going to clear everything in here okay all right so okay there we go so we need to set the rename to True right so handle name double click well after stop propagation what do you want to do we want to set rename right here and invoke this okay so now when we click this there you go now it's pretty much editable oops I went to a different page so if you click let me go back one more step okay so if I double click this I can essentially change it but it requires me to click once more which is really weird let me see if there are some autofocus options that I can add on this element so Auto or focus autof focus let's see what this does let's refresh okay nice so now I can change it to testing click out but it's not going to save right the reason is because I don't have my on blur Handler set up so we're going to go in here and we're going to invoke on blur we're going to add this prop and this prop is going to hold the update folder name okay and let's see what seems to be the issue here okay so on blur H let me do it this way and get e in here and pass an E I mean it's going to get e anyway but okay so okay this just the event that we're getting from here right that's pretty much it so let me go ahead and add this event so let me see if I can ask the AI to do it to resolve this error you need to specify the correct type of the event okay let's apply that and let's accept all right so this is focus event HTML input I'll go up top and I might be able to do the same thing here as well or maybe not uh cuz this is not a focus event what is this is not generic it's not generic then how was I able to do it in here oh react dot sorry guys react dot Focus event okay I think that solved the problem let me try so I have this if I click out not sure what happened but I may not be able to see it right now cuz the folder technically does not even exist right so did I get an error here no I didn't get an error either all right guys so one more change I'm going to make here real quick is if we're currently renaming the folder I think it makes more sense not to trigger um a second click right cuz you're currently editing this folder right so that's something you might want to add and I also hate the fact that I added underline in here so I'm going to remove underline and I would like the padding to actually stay the same Let me refresh this real quick so click here okay so it's not the on blur is not firing if we need to click outside I believe let me take a look so all right guys so the first thing is uh the first change I made here is this one which is on the on blur I removed the rename okay because technically speaking the rename should happen from the call back right right here so I remove this and the next thing is I notice that this is being firing fired right so everything's working I think the issue now is that we need to First create a folder this is not a real folder right if you remember it's a fake folder right so we need to set that up and we also need to get this from the API responses because the optimistic UI is not going to work if that doesn't exist right so let's go one step back and which is the folders index. TSX and let's first complete this step so first thing is we need to get all the workspace folders so I'm going to say const equal to use Query data we're going to invoke this and for the key we're going to pass in workspace Das folders okay and then after for this we're going to need a callback function and this callback function is going to take the get workspace folder callback um server action Sor and we're going to pass in the workspace ID which comes in from here okay so let's grab the workspace ID and let's pass that in here nice awesome and now because this is a client component you want to scroll up top and you want to change it to use client just like this all right now the first thing is when we're creating a folder again we're going to have a query key right just like how we have workspace folders we're going to have one uh similar to this called create folder right now with the help of that create folder query key we're going to be able to get the latest variable that comes from our mutation State and if you don't know what this is that's totally fine because it's just the syntax of react query okay react query gives you access to something called variables okay and these variables have uh the latest state that was changed so essentially it's like imagine it keeps track of the state the new things that you just created during the mutation state right and when you are mutating something it essentially stores the new data in there okay and once that's completed so once the data uh once the API call is successful these variables get reset and then it essentially invalidates the previous responses and it gives you the upto-date information so that's kind of what happens happens under the hood I hope I got it right because there's a lot of stuff inside react query but that's pretty much it okay so let's go back in here um into our I'm also going to close this and I'm just going to refresh the browser okay nice so that's the optimistic variable that we need to create down here okay so first thing I'm going to say cons equal to use mutation but this is called not data it's data State okay it's a new hook that we need to create that's essentially going to give us access to that uh to the mutation data that I just spoke about right the optimistic variable so open up your hooks folder and you want to click on the use mutation data and at the bottom here we're going to export const used mutation data State and this is going to need our mutation key that I just spoke about right and this is going to be of type mutation key just like this sorry and in here we're going to say const data equal to use mutation State and this comes from react query okay and essentially this will return that data that we need okay and we're going to get the latest variables that means the newest data from this updated workspaces data and then we're going to return it to the front end okay that's basically it so once we get this we need to invoke it and we need to pass in some options the first one is Filters so what are we filtering for well we're only filtering for the mutation key next what do we want to select so select like this and we're we're selecting and this actually takes an arrow function and in here we're selecting the variables and the status right but we're going to get the mutation from here so that way we can get access to the variables and status from this mutation and down here we're going to return a new object with variables and this variable is going to be set to this the mutated uh State variable so we're going to say mutation. state do variables like this and we're going to rename this as any for now and next thing we need is the status this is going to be mutation. state. status okay awesome and now at the bottom here which is right after this data object we're going to say const latest variable equal to data at data. length minus1 okay just like this and finally let's return an object here with the latest variable and I'm going to go back and quickly import the New State uh the new used mutation date State data state that we just created okay now first thing this is going to give us the latest variable so I'm going to grab that and I need to provide the uh the query keys right this one is called create folder because when we create the folder like I said that is also going to be um optimistic right we're using the mutate function so through this latest variables we can get the latest folders okay next we also need to get uh we also need to destruct structure the status and the data from this latest variable right so actually sorry guys from this latest data right here this data up top so first we're going to say status or actually first let me say data as folder folders actually let me create a uh a prop prop type here so I'm just going to scroll up top and I'm going to say type or export type folders props equal to an object and the first thing I'm going to need is the status itself and then we're going to need the data right so I'm going to say data like this and let me also complete this so data we're going to get counts and that count is going to be an object with videos and videos is going to be a number right the number of videos itself and we're going to expand on top of this so right after this uh purple bracket we're going to say and the following which is ID name created at and the workspace it belongs to okay and there types as well well and this of course is going to be an array and now we have these types that we can use for this data so we're going to say data as folder types and now we can folder props and now we can get the data and the status okay and this data of course um is this data here is actually the folders sorry guys and this is going to be the status so essentially just renaming this okay all right nice cool and now the next thing is um we we need to check if the data is fetched so everything is successful right so if is fetched and the folders exist then we're going to dispatch something to a Redux store so we can essentially store that data and we can render it on the client okay all right guys now please just pause what you're doing and just focus for a few minutes because I want to help you understand how react query Works in our application so I'm going to essentially uh explain the use mutation use M mutation data State the uh prefetch queries how the you know how the query Keys work how the mutation Keys work what is the mutation function all of that stuff cuz I realized that you guys are going to need this eventually I don't want to give you all the research work um because I feel like this is an important topic right so I'll I'll kind of break it down for you so you understand every single thing in the simplest manner okay in the simplest possible way so everybody can understand and there's also a Redux store that we're adding in here right like I mentioned and I want to help you understand why we need the Redux store in the first place and if it's you know if there was a bypass for it and all that kind of stuff okay so please just stop what you're doing I'm going to also put a Tim stamp for the section in the video so when you watch other videos that we create in the future I feel react query is insanely powerful and I might probably use it in there as well so after this hopefully you don't hate react query and you start to love it and you see the power of react query in your nextjs application okay so the first thing is why are we even using react query the main part is to fetch data and to cach this data all right basically it boils down to this thing now sure we can use something like axios axos is great to fetch information as well now the most important part to keep in mind is in nextjs 14 caching still happens right you can still cach data but once next ps14 goes to 15 once the update comes out you are no longer going to have this by default so there's no more caching available to you so what does this mean this means if you have data that is the same thing that over and over again in your application your app is going to refetch data every single time so you're going to need to wire it up in the first place you have to wire it up do some you know uh I think maybe provide some variables at the top of the file to essentially let nextjs know that that file has to cash the responses I'm not entirely sure how we are going to be doing it in X1 15 but um that I know that in x14 there's something that we can force Dynamic and all that kind of stuff on the top of the file right so it might be something like that so these are one these are two of the main reasons why we need this now there's one more amazing reason why we need react query it is State Management in a server component does this even make sense probably not right so let me help you understand even more so let's say you made an API request so you made an API request right here let me just zoom in so an API request was made inside your server component okay so you made a request to get workspaces okay this is the server action it's not really an API request just think about it as a server action so you did this in the server page now what's going to happen is This Server action is going to return some data right you're going to get a bunch of data in here so let's say for example uh it's an array of workspaces right so ID and we'll have an ID in here and then we'll also have something like name okay and we'll have name for now I'm just going to say parents workspace all right so we'll get some data from this API now we know for a fact that this data is going to be exactly the same in multiple Pages at least until the user changes it correct so if I wanted to get the same data in an another component let's say I had another server component in here so this is server component number one okay and then we're going to have server compon oh why did this shrink server component number two all right let's say we want to get the same workspace data inside server component number two and maybe this is like a page that renders out all the information of the workspace itself right like let's say in this page we're going to show the ID and the name of the workspace now what I'm going to need to do in here is is make an API request again so I've already made this API request request twice right now first benefit is if the data was cached right if this data was cached then this API request is not going to go through essentially it's going to just return cash data which is great and we can set that up to do it accordingly but what if I don't want to even make the API request all I want to do is keep note of the ID that was used to make this API request so there's a specific ID okay and this ID is what we call the query key okay so let's say the query key for this was equal to workspaces okay I think it's different in here but you get the idea so let's say the query key was workspaces instead of just making the API request and then having the server to do everything we can use our own brains right and we can decide when we want to get the um the cached data or not and now that we're saying in here instead of making the API uh request why don't you just give me the data for this specific key query key so instantly it's going to go in and it's going to grab this data and give it to me okay so this the first benefit of using this so I can control when I want to get the cach values or not right and then there's another benefit to this what if now I know okay I no longer want the old data I want to get the new data well all we would have to do is passing an invalidate argument right and based on the invalidate argument it will just invalidate this query key and it will refetch the data and store the new data okay and we don't the cool thing is we don't have to do too much work to make this possible it's very simple right all we have to do is have a argument that's being passed into that function and we just have to invalidate the response there and I'll also show you code now so it you understand what which piece of code does this okay so this is a premium opal code base that we give out for Prodigy University students so it's going to look different but I just want to show you what's going on right so take a look at this right here we have something called use Query data and this is essentially taking in a key which is the query key and you can take a look at this as well you see query key and all it's doing is it's going to return the data that we need all right and in here you can also pass in the API uh API you know um function or we call it the server action right so you can pass in the server action and it will invoke the server action it will get you the data for this thing okay so that's what the used query does under the hood the used query helps us make that API request right here so this to get data we use use Query okay so use Query equal get data um with a query key okay so hope this is clear in here let me also redo this I made a spelling spelling error okay so use Query helps us get data with with a query key okay so that's how right here we're going to instantly get the data that is stored in here and then we can do whatever we want from from here on okay so now the data that was fetched from this specific used query with this specific key is in a way cached so I can get this in any file I want even if this state was changed okay so technically under the hood how this works is it stores it as a form of State okay it's still data because you cannot use state in a server component it still stores it like a like a state all right like a like response data right now let's say the user made a change here so this change change from parents workspace to Joseph's workspace okay so if it changed like this essentially we also want to get that up-to-date data right and we want to get it in real time so this will also fire like a state which is super super powerful so any part in our application will also update in real time all right and I'll show you how we can get access to that uh that data as well so now that we understood how to use used query which is to get any data with the query key and the data gets cash so we can use it in any file to fetch the same data at any time let's understand what the Ed mutation data does instead okay the used mutation data right here is a uh is basically Ed mutation we just called it Ed mutation data and essentially what use mutation does is it gives you access to a mutate function okay this mutate function when you invoke it and you pass in some data which is the um let me see if I can show you an example right here you see we're we're invoking mutate and we're adding the new data that we need to add to our to this specific um workspace folder query key right so right now if we had a query key called workspace folders if we want to add new data to it we would just say workspace folders please you know um basically revalidate this key right revalidate this API endpoint with this key and what I want you to do is pass in this new data into this mutate function right here and that way in another component in a whole different file I can access this in real time time I can access this mutate date uh sorry data okay so as you can see here now in my folders component I'm saying use mutation data state which is essentially the used mutation State okay where all we're doing is we're passing in that key that we used to create this new data and when we try to use the use mutation date uh data state it essentially returns this exact value so take a look at that so inside this under the hood we have used mutation state right we pass in the mutation key which right in here is this one create folder so for create folder only we are filtering only for create folder I want you to select these the data that I need and return it to me well what is that in here it's going to give you access to the mutation and this mutation is this right here whatever you passed in okay so this part is stored as the variables it's a new data right remember I told you in one of the other um I guess slides which is this is the variables that variables is a realtime data right or temporary data so essentially it takes this and it stores it as a temporary variable okay and you can get access to it through mutation. state. variables this is under the hood so you don't have to care about it but essentially you get access to whatever you passed in here inside this all right next we have something called status and the status is again under the hood as well the essentially react query keeps track of the status of this API response and request okay so it knows if it is still pending if it was just made if it was successful and based on that it will return this data we're just returning a a piece of data right here so we can take a look at the status and accordingly render out the variables because this is temporary real-time optimistic UI okay so that's the the whole point of using the used mutation state so let me write it in here so use mutation state is basically going to help us get the latest optimistic data okay data that was sent into the mutate function when it was called using use mutation okay I hope that makes sense so this one right here now another question you might have is how does it invalidate the request when we are creating a new folder so right in here for us mutation we passed in the key right for this specific mutation then we passed in a callback function and this is a server action okay and the server action will essentially go in you know behind the scenes and it will add the data and it's also going to revalidate this endpoint and the reason why we pass this endpoint in here is because all folders come through the workspace folders so if we revalidate the endpoint then we're going to get the new data which is the one we just created plus the old data okay so let's go into use mutation and take a look at that as well so in here we have use mutation which gives us mutate and is pending this is that state the status sorry not status guys sorry it tells us if it's pending or not all right that's pretty much it don't get confused with status all right but that this is basically what it does then in here we're just passing the um the mutation key and the mutation function that we wanted right so in here this is the mutation key this is the mutation function which is a server action and then we have on success and on settled on success all we're doing is returning a toast and we're showing like success everything is completed and we're passing a description in there as well and if the user has a specific type of on success they want to perform we will invoke that one as well but in here we did not pass in any on success so it's good to go but if you wanted to show an alert message again you can do that in here as well all right but that's pretty much it for on success now on settled what we're doing here is we're saying await client. invalidate queries okay and this is essentially invalidating based on the query key that was passed in so this workspace folders so that's how we invalidate all right so now you know use mutation State then you know use mutation in itself right uh let me do this real quick all right nice and then we finally have one more which is a prefetch queries okay that is actually very straightforward just think about it this way you cannot use usequery in a server component can you no because it's you know only allow to be used in a client component it's a hook so react query has a different way where you can prefetch data on the server and render it on the server side and that data is also cached okay so you can instantly get access to it through the used query hook if you're using it in a different file so now you know what is the pref fetch queries as well all right nice that's pretty much it so let's go back to our code right here and let's once more have a final summ of all of this so you truly understand what's going on and yes this is a new library for us as well um I try to use something completely different and just because it's so much more powerful than just using axios and it's time we move to something more advanced and not just be beginner SAS developers right so the first thing here is we need use Query data okay we have a use Query data hook which is essentially used query under the hood it helps us helps us fetch or get data with a query key that's it okay that's the purpose of the used query data so we pass in the query key and we can also pass in the server action and it'll essentially just return that data to us okay next we have something called use mutation the Ed mutation is used when you need optimistic updates to the data and you also want to get data from uh get um sorry not get data you want to fire functions on settling and on completion right just think about it like this right so and you also want to revalidate the data okay this is why you would want this so use mutation as a way to create an optimistic entry into the data that we've already fetched that way you can render it out like a like a state on the component then we have the use mutation State and this helps us get whatever we added optimistically to this um data response right so in here if you added an object with new data you can access that data from the use mutation State okay and you can do that with the help of a query key again all right nice then prefetch queries help us make an API request and kind of store it and kind of render it on the server side that's pretty much it all right so I hope this makes sense rewatch this and come back to it when you need to so it makes a lot more sense as you go on as time moves on but I just wanted to point this out right uh because how this works is we would be the the reason why this could be confusing for a lot of people and it it is confusing for me as well is because in here we have something called mutation State data create folder but no one's going to know where this is coming from right there's no way there's no single source of Truth as to where to look for this so the way this work works and I know this Library could really be improved but the way this works is it gets entangled in code right but it helps you save like hundreds of lines of code and it's much more efficient and again it gives you a lot more power over just an axios response and request okay so that's the problem because it interven it it kind of interleaves all of the code files because here you have create folder and in a different file you have the create folder that's the reason why you're getting this in here right because if you're getting used mutation data state that means you need to have created the state using used mutation somewhere else right so that's the confusion where is that file coming from that's the problem so all you need to understand right now is when we're making when we're storing some optimistic data in one location we can access that optimistic data in another location in real time of course using the use mutation data State all right and use Query can help us fetch data with the query key and the prefetch queries help us pretty much pre-render data on the service side that's pretty much it okay now let's skip over this and let's go to the next part down here which is the Redux store so um the Redux store technically is not needed we don't even need Redux in here because the power of this the I mean react query is super powerful it pretty much like replaces Redux and if you watched my videos in the past you will know that I have pretty much created a Redux like Library completely from scratch and showed you how to use react context API under the hood right you can watch plura that's one of my biggest videos and that video went absolutely viral because of the capabilities of an of a software like that right and in that application we used Redux um sorry we did not use Redux we used react context API under the hood okay so I showed you in detail how we can build something exactly like Redux but but in this project I also wanted to introduce you to Redux Concepts that way you remember you know how Redux works and not just react context API and the reason is because in a production environment you will never want to use react context API if you want to keep track and you want to get the benefits of bug tracking the uh you know the Redux Dev tools and all this kind of fun stuff right so if you're using react context API you're not going to get all these features So eventually you're going to need to move to Redux so it's better to in ruce everything to you okay so let me first show you what we're going to I mean we're not really using Redux that much in here but I'll just show you what we're doing right so every time we add a folder let's say if this is um our folders array right every time we add an a folder in here we're going to put a folder like right here right so folder is going to be added in here and then we're going to add one more uh inside our Redux store and as we keep adding we're going to constantly keep updating this right now the question here is what if I want to move a video inside one of the folders right the way I would do this if I was using mutation I could just use use mutation and update the data right but we don't want to do that I want to show you how to do this through Redux so you understand Redux as well and that's why we're just using Redux okay there's nothing there's no clever reason why we're using Redux it's just that I want to help you guys understand Redux as well and that's pretty much it so the for now the main purpose as to why I would need Redux in here is we're going to need it to move videos from one folder to another folder okay that's pretty much it okay so now that we know what the latest variables is right here this is essentially those variables that we passed into the mutate function hopefully now you have more context as to why we need to render this out at the bottom because when we are adding a new folder we want to render this data right here okay because it's a new folder that was pretty much added um as optimistic UI okay so first thing now now hopefully you understand why we need these keys to be without any spelling errors right so something doesn't work the way you expect to First Look at the spellings you've written for the keys and then you can debug from there so now that we have this we have to go ahead and set up Redux right because um or actually not very important right now I'm just going to hide it for now we'll come back to this later okay so first thing is scroll down here and where it says CN function remember I told you we have to add some values in here based on the status right that's what we're going to do so we're going to say if status is not equal to 200 okay it's not equal to 200 so something went wrong then we will render out a special style in here called justify Center okay and if not we'll render all of this okay cool the next thing is let's scroll down here and I'm going to remove this folder for now I'm going to open a curly bracket and I'm going to say if stat status is equal to oh sorry is not equal to 200 then we'll do something right here if not we'll do something right here now if this was successful uh if this was not successful right status is not equal to 200 we're going to return a paragraph with a class name text- neutral and I'll change this to 300 okay and we're all we're going to say is no folders okay so no folders in workspace like this all right so no folders in workspace nice and then down here um we want to return a react fragment and inside this react fragment I'm going to say if latest variables if this exist and latest variables. status equal to pending okay you see we're getting some states right this is coming from the react query under the hood okay if it's equal to pending why did it not give me pending pending then we're going to return the folder but this folder isch technically just going to be a um pretty much like a placeholder okay and we'll create the styles for that in just a second but let me first finish this section and now after this we're going to say folders. map because we have all the folder data that's coming from here right this one right here so this data pretty much because we used usequery to fetch the data right from workspace folders we're going to rename that to folders here and we're going to return that so we can render it down here so we're going to say map and for this we're going to get the folder itself and we're going to return another folder in here but we're going to put all of the values all of the props that it needs so we need name count ID and key okay and you can get it from this right here so uh you can type this out pause the video and just type it real quick okay now for this one we need to provide the name and the ID of the newly added folder right and of course you didn't see it I mean I did technically show you another slide of what it looks like but when we are calling the mutate function right the mutate function from another file which is the create folder file we're going to be passing in an object right that object is going to have the name and the ID so that's what we need in here to show the um optimistic UI so I'm going to say the name is going to be the latest variable so this one latest variables okay variables. name and the ID's latest variables. variables. ID okay cool that's pretty much it and down here we also have to pass pass optimistic because we're going to need to set up some stuff in here so let's go into this component so first let's render out the optimistic UI so down here in the first div based on the CN U sorry based on the optimistic prop that was passed in we're going to say if optimistic exist then we're going to show opacity of 60 okay so I'm going to put 50 for now and I'll change this to 60 and put a comma right after this okay so that way it just shows like a blurred element so they can't really well technically they can click on it but just to show that it was just adding in there right you don't even have to do that because you can just uh pretty much roll back to the previous data it will do it automatically and uh react query does that for us so that's another amazing reason why to use react query okay all right then we also need this in one more location I think let me see okay I think we are good to go all right we're good to go in that so I'm going to go back to this uh folder right here and let me make sure I have everything in here as well okay for now I think we're good I'm going to add another work in progress flag saying add Redux stuff for folders okay so I can come back to this now I want to go into the page. TSX and I see uh something in here called create folders right so I want to complete this component so I can render out folders in the in this section so first thing is I'm going to render a button in here so I'm going to say button component and give it a class name and the class name is going to be as follows so it's going to look like this all right so please add the bg1 d1d 1D text 707070 Flex item Center Gap to padding y of 6 padding X of four and rounded to L and inside the button we're going to say we're going to add the folder plus do aone I made a spelling error there but that's fine create a folder like this and let's see what's wrong with this button why did it not import okay that should fix that error and it also needs an onclick Handler so as you can see here we have the create folder right so when you click this we want to create a folder but we're going to add the optimistic UI data which is we're going just going to call it Untitled folder okay so up here we're going to say const on create um actually sorry this is called const we're going to destructure something that gets returned from this it's called use create folders and this is another hook that's going to help us create folders using the mutation and stuff like that okay so go down here inside hooks I'm going to create another file looks like I just jump to a different file okay we're going to say use create folders. typescript and in here I'm going to return um okay I can't do that I have to sorry I thought this was a component so we're going to say use create folders equal to an arrow function right and this Arrow function is going to take in um the workspace ID which is going to be a string and in here first we're going to say equal to use mutation data right because we're making a change to our um our data that was previously returned back from the workspace folder key right that's the API request we made to fetch all the data for the workspace folders so since we're making a change on that we need to use the use mutation data and this is optimistic stuff that's pretty much it so now this is going to give us access to mutate so let's grab that and the first one is going to be our key so this is going to be be called create folder this is the mutation key okay not the query key and next we have to pass in a call back function this is actually the server action so the Ser action for this is going to be create folder and of course we don't have this right now so I'm just going to say create folder and I'm going to invoke why is it importing that create folder all right and we'll invoke this for now and then we'll get to that in a second and then next we need to pass in the query key itself right so the query key is going to be the third parameter so right here the query key is going to be workspace please don't make any errors here okay workspace Das folders just like this all right nice now let's go ahead and create the server action So This Server action can be inside the worksspace do typescript inside actions so I'm going to say export const so create workspace folder sorry create folder and inside this first changes to an async function and this is going to give us the workspace ID which is going to be a string and in here I'm going to use a TR catch block okay try catch const is new folder equal to await client import that client. workspace do update okay and for this we're essentially going to add a new worksspace to it right so where for the ID is workspace ID the data that we want to add is going to be like this so we're going to say data um folders and we're going to create uh we can pass a name and videos and I think that would probably make more sense but for now let me just do it like this you probably want to pass an Untitled in here right but um yeah you probably want to pass an Untitled in here let me see so name I'm just going to say Untitled okay that should be good and for ID I think that should be fine okay CU it's going to autogenerate and next we're going to say if new folders if this is successful and this is actually not folders this is folder so if this is successful right we're going to return an object and in here we're going to say status of 200 and then we want to pass in the message and this message is going to be new folder created okay nice and I'm going to copy this and down here I'm going to catch an error and here also you can catch an error saying 400 uh could not create folder right and down here you can also pass actually this is already going to get caught by the bottom if there was any error so this can be 5 100 server error and say oops something went wrong okay nice I'm going to go back and quickly import the create folder server action and I'm going to pass in the workspace ID okay now the reason why I'm using this Hook is I want to return a call back function that that they can use to invoke this mutate okay so all I'm going to do is I'm going to say on create new folder which is a call back and in here I'm going to in invoke mutate so let me remove this we don't need this really I'm going to invoke mutate and I'm going to pass in the name I'm going to call this Untitled right like this and for the ID I'm just going to pass an optimistic ID okay just something like this for now all right I think I made a spelling error there we go that should solve that problem nice and after this we also have to return the oncreate new folder right so on create new folder nice now let's go back and import the used create folder and let's also grab this one from here and this needs the workspace ID so I oh I have to actually first get it from here so workspace ID is going to be a string so I'm going to get it from here and in here as well so let me grab this all right nice and now I can use workspace ID cool oh sorry guys this has to be destructured here um workspace ID all right awesome so this okay so since this is a client component scroll up top and you want to change this to use client first thing nice and now this Handler click Handler can be passed in directly into this button so we're going to say onclick and we can pass in the oncreate new folder so when we click this button it's going to invoke this function the mutate and it's going to pass in this right and now inside our folders component this is a client component of course right we're using the used query hook uh sorry used mutation data state in here which is going to give us the latest variable so this will update in real time based on this query key right and uh this is mutation key sorry not query key so based on this mutation key the latest variable will update and accordingly we should show a folder right here okay and it should be gray out that's what should happen Okay so I'll go ahead give it a shot and hopefully it works if not we'll find the solution all right so let's go ahead click on create folder there we go looks awesome great job guys and now if you refresh you're going to you're going to notice this folder will still be in here okay let me try to rename this okay and if I click outside okay um I think the reason is because we don't have a hook to essentially or do we even have that let me just take a quick look okay so something is wrong with the rename functionality and of course I'm going to go ahead and try to fix that so just give me a second all right so I just went to Prisma studio and I just deleted all the folders I had so I can just start from scratch and first I want to see if my create is working as well so if you click on create instantly it shows a folder awesome and then the other thing is when I click on this right right here when we click outside it's supposed to save it but there's some issue happening inside our update so let's go ahead and fix that so you want to go inside the folder. TSX right and down here remember when we are saying data is the data. name right we're essentially passing this call back in here which is the server action and the server action is going to you know pretty much rename all the data but in here we need to pass in not name because name is coming from the prop right we need to passing data. name all right so that's the issue here so make sure you do that so make sure you pass data. name now when I change this you're going to notice let's change it to testing if I click out side there you go awesome it changed right so why is it making this quick flicker there's a tiny little flicker there right the flicker is because we are not rendering the latest values in this component okay because right now what we're doing is we're plugging in the name the name is coming directly from the prop right and we're plugging in that prop name instead so instead of this you want to do something that looks exact L like this which is down here you want to use the use mutation data State and you want to use the update or rename folder whatever the key is for that mutation let me actually see what that mutation is um let's go down to folder folder like this okay so that mutation key is called rename folders and then you're going to get the newly mutated data right with the help of this mutate remember whatever is being passed into this mutate value is essentially what we're sending then using the use mutation data State this hook right here where is this okay right here you can get the latest variables and then based on the latest variables you can render out a probably like a placeholder and you can change it to the original text that's pretty much it okay so there's nothing wrong here because if I refresh you see it shows testing everything looks good okay and another thing I would like to talk about is if you are not in a sort of a hydration error that's totally fine I think that's just a caching bug there is something known as a stale State and when the pretty much the data becomes stale that means it's already been fetched and based on a certain timeline I think maybe 1 second or I don't know if it's 0er seconds or 1 second but based on the stale number that you provide the stale timer it will consider the data as stale and only then will it refresh refetch okay so it's fine you're good to go because users is not going to create folders and then immediately refresh CU we are using this uh feature right here to show the power of optimistic UI right so they're not going to refresh the data so you should be good to go all right now go ahead and pause this video and I would like for you to take this up as a challenge your goal is to solve this flicker bug I just gave you the solution I told you exactly what you need to do so go ahead pause it and try to give it a shot if you get the answer great if you don't I'll show you exactly what you need to do all right hopefully you got the right answer if not no problem so first thing is you want to scroll down here and you want to say const latest variables equal to use mutation data State and you're going to get rename folders in here okay then you don't have to do console but now that we have the latest variables this is the mutated data right the optimistic mutated data so we have to do is down here under our paragraph tag we want to look inside this and we want to say if latest variables exist and the status is pending and the ID of the variable is equal to ID then we want to render out that variable name or we're just going to render what's provided in the props okay now where are we getting this this ID from I added an extra property in here called ID okay that way we can help distinguish which folder is being rendered so now if I click on this and if I change it to something else and if I click outside there is no flicker okay awesome so our next step is when the user clicks on this card it's going to take them into that specific folder right so we want to accommodate a route that can essentially help this um no longer throw A4 for error so you want to go into your workspace ID right in here and you're going to create another folder called folder okay and inside this you're going to put the folder ID so inside it first create a uh Dynamic route call it call it folder ID and inside this you want to create an index all right guys looks like I made a small error here so I'm just going to quickly delete this and do this one more time so let's go back up top and inside my folder I'm going to create another folder which is a dynamic ID called folder ID okay and inside that I need a page. TSX now you can also create another route in the root folder in that folder you can essentially make an API call to the back end and you can get the first folder and you can just route the user to that folder okay just as a way to you know not show a 404 response that's what you want to do right so you can do that if you want but I'm going to save some time here and first thing I'm going to do is return a component and next I'm going to get the pams so I'm going to say pams just like this and this is going to give me the folder ID which is going to be a string and I'm also going to get the worksspace ID which will also be a string as well all right going to put it on their own line and now I'm also going to destructure the pams and from this destructure workspace and the folder ID now first thing is we need to create our client right because in this file first we need to prefetch our folder videos and the folder information okay such as you know the number of videos that are inside that and all that kind kind of stuff so we need to get this information prefetch it in this file and then we're going to use the hydration boundary to provide the state to all the components that are within that hydration boundary okay so first thing to to prefetch you need you need a query client right so we going to say const query equal new query client okay so this comes from tan stack react query so don't forget to import that as well next we're going to say query. await query do prefetch queries and we're going to invoke this but this has to change to an async component so I'm going to change that first and now the first thing I need to pass in is the query key so I'm going to paste this so I don't make any spelling errors please make sure you take a look at this and make cross check the spelling so you don't make any spelling errors as well okay next we're going to need a query function and this is an arrow function and it's going to need a server action that's going to help us fetch this data and This Server action is called get all um user videos okay so I'm going to invoke this so now we can get the videos that are respective for this folder and I need to pass in the folder ID as well okay and we've already created this right I hope you remember so all we're going to do is just um call this and pass in the folder ID so now we have this prefetched on the server side okay the next one is we're going to need the folder info so go ahead pause this video and just take it up as a a challenge see if you can create the get folder info server action and the prefetch query to get the folder uh information as well okay awesome hopefully you got it if not this is the answer first thing is we're going to say await query. prefetch query we're going to pass in the key but please recheck this key if you type something else but it's just folder info and then we're going to need the query function which is going to be get folder information and in that we're going to need to pass the folder ID so if you had a different name you can change it right now okay so I'm going to click on this and copy this name I'm going to go into my workspace typescript and under the actions folder and I'm going to scroll to the bottom and I'm going to export H the get folder info and this is going to take the folder ID first so folder ID which is going to be a string and inside this I'm going to have my TR catch block okay and first thing is I want to say con folder equal to await client. folder doind unique and all we're going to do is say where the ID is like the folder ID that the user provided okay this this has to be an async function okay so don't forget to change that as well and we're going to select the following data we're going to select the name so set this to true we also need the count and not count count and in count we're going to select um man sorry that just cracked me out we're going to have videos and we're going to set that to true as well okay so we have name count s and get the videos okay and now after this if the folder was returned then we're going to return an object with status set to 200 and data set to the folder awesome now if this failed down here we're going to return status of 400 and the data will be set to null okay and I'm going to copy this and do the same in here okay catch error and down here you can essentially uh return 44 500 I'll just return 500 okay makes more sense all right now let's go back and quickly import our server action okay nice now we can have our hydration boundary so remove all of uh all of this stuff in here I'm going to create the hydration boundary component I'm going to invoke it and import sorry import it and then next thing is for State we need to dehydrate the data and we're going to pass in our query client and now inside this we can essentially create the components so the first thing we need is a component called the folder info all right so I'm going to copy this name I'm going to open up the folder structure scroll down to components go right into folders and in here I'm going to create info. TSX or folder dasinfozentrum first prop we need in here is a folder ID which is a string so I'm going to go ahead and grab this right away and I can also go back and quickly import this component so I can pass in the prop okay so now we already have the folder ID so I'm going to say folder ID equal to the folder ID just like this and if I go into this component now in here I can basically proceed okay so the first thing is I want to use our use Query data right remember use Query is to pull data is to get data so I'm going to say const equal to use Query data I'm going to invoke it and I need to pass in the query key and the query key I need in here is folder info and I think we already have the folder info in here right so that's basically what we're doing so we're going to say folder dasinfozentrum ID in here so this way if the user try to access this page we're also fetching the data if needed or we're also going to get cache data right so now this is going to give us access to the data that's returned from here so I'm going to destructure and grab the data then I'm going to say rename this as folder and we're going to set this equal to data as folder props okay just like this and we already have this so we can import it right and now this data is going to have a um this specific type okay now in here first thing remove this also let's bring this back and if I click on this okay it takes me in here but there seems to be an error I'd like for you to think what do you think is the is a problem why am I seeing this error right here okay hopefully you got the right answer the answer is to change this to a use client component okay this error cost me hours all right so I hope you never make that issue that that error ever again but yeah so first thing is I'm going to set some Style on this so I'm going to set it to flex item Center and here for H2 I'm going to set the color of the text to the following okay so please copy this and next I'm going to set this to toxel and I'd like to also apologize on my side um my end because I had to hardcode the colors because it was a last minute thing and um it was it was a very difficult process because I did actually think about it in the beginning and I just wanted to get over with the project and get it done for you guys as fast as possible Right but usually you would have to take all of this and put it into your Tailwind config file all right right here you can create some Styles or you can also go into your CSS file and you can change the classes directly in there okay but sorry about this guys but it's it's pretty much the same thing um doesn't really matter I just wanted to let you know so I'm going to say folder name ins inside this something something looks wrong what's going on folder folder dot hm okay so I made a small error so this is folders props right we actually need one folder so what you can do is is I think can you do this is this possible no you can't I mean there is a way but I I just want to go create it right away so I'm going to go into the type folder down here okay and I'm going to create this type just like this so folder prop not folders but folder prop and in this I'm going to say status of why is this okay status number data name count and videos okay now I can go back and quickly import the folder props and let me delete the other one and now I can say. name okay so let's see what it renders out okay null is not an object what an amazing feeling let's see what's going on all right guys so I found the issue when I clicked on this and I took a look at the URL I noticed a percentage 70 attached to the end which was really weird and then I checked my file to see where I'm doing that and I'm not doing it anyway right uh anywhere but I noticed I have a bracket here and that was getting converted into that weird ID so now if I go back and if I click on this Al have an alert message don't know why it's still showing that I thought I already removed it then I yeah I already did Let me refresh this one more time and let's click on this and now that should solve our problem oops sorry what am I doing all right so click and there you go now it takes me there okay so let's go back click once more awesome all right so that was the error hopefully you found it if not no problem that's all you have to do now the next component we need to show is the videos component all right that's pretty much it I mean our application isn't that complex but I mean that's all it takes right you don't always have to solve a complex problem just find a problem that the market is facing and solve it through a Simple Solution that's pretty much it so um first thing is we're going to show this video element here and then we're going to show cards down in here okay so I just wanted to show you this design so you know what we're building next so let's go in here first and write for the folders info we're going to create a videos component okay so copy this videos component and you're going to open up your folder structure you're going to scroll down to components right here and inside the global components you're going to create another folder in here and you're going to call it preview or sorry you're going to call it video videos and inside that you're going to create an index. TSX and I'm going to render out this videos component right in here so first thing is is this needs a couple props we need the location ID we need the videos key and the workspace ID as well and this location ID is just the folder ID okay don't get confused I'll actually change it right away okay it's folder ID next let's quickly go ahead and destructure all these values as well all right nice and now we're going to use again the usequery data to fetch all these videos okay so we're going to say const actually am I passing in this data all right so let's go in here first and pass in all the props that we need to right so the first one is the workspace ID and that is going to be not pam. workspace ID but it's just going to be workspace ID then we need the folder ID um what is this folder ID let me see if I'm even accepting oh I didn't even import the component so first go ahead and import this component okay and now you should get folder ID and this folder ID is equal to just folder ID from the props right and the next one is a videos key this is important it's called folder dvideos okay all right I already made a spelling error so yeah please make sure it's the same spelling okay now let's go back in here and first thing like I said we need to make that call right that API call to essentially get all our query data right so get the information first right and we're getting it from our cache data so first thing is we're going to say um use Query data invoke this and this is going to take in first the videos key right next we need a callback function and this callback function is get all users videos you want to invoke that and you want to pass in the folder ID as well okay now this is going to give us the data so I'm going to get it and I'm going to instantly rename it to video data okay just like this nice and now that I have this I can essentially use this name instead of the data itself now I also want to typ cast this and and so to do that I'm just going to first also uh destructure some more values so I'm going to say status is going to be videos status and data is going to be the videos itself and this is equal to video data and we're going to typ cast this as videos props okay so let's go ahead and create this so open up your folder structure you want to scroll all the way to the bottom under types and you're going to say video props equal to status number data which is an object that's going to have user which is going to have first name last name image which is string null string null or string null and or this user itself can also be null then ID string processing Boolean folder is going to be this essential data right so ID and name or it can be null created at date title string and null source is string as well and if you now remember the processing that's essentially what this is okay so let's go back and I'm going to import our video props okay nice awesome and and now at the bottom right here I'm going to remove whatever we're rendering right here and I'm going to render out a div and in here first thing is I'm going to provide a class name I'm going to say Flex Flex Das column gap of four and margin top of four and inside this I'm going to create another div Flex items D Center justify between and inside this we're going to create another div which is flex items Center and gap of four okay nice and now inside this we can create uh we can essentially show the videos header right this section right here so the first thing is we're going to say videos recorder duone okay and then we need an H2 element with a class name text and I'm going to put this color okay and then I'm going to set text to Excel and inside the H2 I'm going to say videos so if I click inside this it should take me into uh if I click on this actually Let me refresh as well it should take me inside that all right so I'm seeing some errors because this needs to be a client component as well so I'm going to change that and now if I refresh awesome it shows the videos right cool next down here I want to essentially um actually not here I'm going to hit enter after this div I'm going to create a section tag and the class name is going to need CN function and for this I'm going to say if video status is equal to to sorry is not equal to 200 then I'm going to do something in here or I'm going to do something else so essentially we're just rendering uh some sort of a placeholder right that's pretty much it and the placeholder is just going to have padding of five okay and if not if everything is successful then we're going to pretty much render out a grid for all of our cards and it's going to be like this so grid grid column 1 Gap 10 from medium devices grid column 2 two if I'm large grid column 3 on Excel devices grid columns 4 to Xcel is grid column 5 okay I'm also going to remove this double quote here all right nice and that's it now inside the section if the video status is equal to 200 then we'll do something in here or we'll do something else all right first if it's successful then we're going to Loop over the videos so videos. map and for this we're going to get access to the video itself so let's grab that and in here we're going to return a video card okay so card element just like this now of course we don't have this so we're going to create that but before this I also want to return a paragraph tag um a paragraph tag like this and for the class name I'm going to give it this class this color and in here I'm going to say no videos in workspace okay so it's just going to show like this just to show something all right that's pretty much it now for the video card ele elent just for now what I'm going to do is I'm going to hide this I'm going to also make sure I put my work in progress flag um add videos logic okay and down here I'm going to render out the video card element which of course I'm going to create as well but now we can see what we're doing okay so open up your folder structure and you want to go into your videos folder under components I'm also going to create a video Dash oops video- card. TSX and I'm going to return a component and rename it and now this is going to need some props this is basically the video's um props but for now I'm just going to copy this guys please pause and type all right I don't want to waste too much time here so pause and just type it's just typescript stuff okay now after this um in here you can just keep it as props no problem um and first thing I want to do is I want to create this days ago or how many days ago was this uploaded and we can do that with the help of a date right that created at date so for now again I'm going to have another work in progress flag and say keep date later all right or wire update okay this is enough because we just want to work on the layouts so in here first I'm going to render out a loader component okay a loader component just like this and for for the state I'm just going to say false okay and now let's go back and quickly import our video card and now I can pretty much mess with this if I need to so let's refresh this real quick all right awesome and inside this loading um I'm going to show a div with the following class names so please pause and type it's overflow hidden cursor pointer uh background this color relative border one pixel border with this color Flex Flex column and round it Excel and the next one is another div in here but this div is going to have the following class names so I'm going to say absolute top of three um I'm going to say Z50 Flex Flex column Gap y of three okay now inside this first thing is we need to have the card menu right so card menu um let me see if I can recollect what is card menu okay so we're going to have a card menu option and I think it might I might make it this one but it's essentially just a modal that's going to to show us all of the available options right so there's going to be multiple options for that specific card and we can perform those actions inside that model that's pretty much what it is okay so in here first thing I'm going to do is say card menu okay and of course I got to create this now so I'm going to open up my folder structure I'm going to say menu. TSX or card menu video- card- menu and I'm going to import this new component and I'm just going to use this real quick next this one is going to need some props right so I'm going to get the video ID I'm going to need the workspace ID as well I'm going to need the current folder right and the folder name okay now these two are optional so we may not be uh it's not really needed but I'm just going to provide this as well and down here I'm going to destructure all these values nice and now the first thing is I'm going to remove this and render out a modal component so our modal right so our modal component from our folder and this is going to need the first class name so for the class name please pause and type and I'm going to need a description title so I'm just going to provide something for now um it doesn't matter what it is guys just provide something for now okay and the trigger is going to be an icon that looks like um looks like a move icon okay so I think I can show you as well so for trigger I'm going to bring in this move icon just like this and then give it size 20 fill with this color and the text name I'm going to set this color okay and now inside this we got to provide the component that this model should render so before this I'm also going to go back and import my card menu okay nice let's refresh the browser okay cool and now one more thing guys um I don't think we're going to be able to preview this yet because we have a bunch of styling stuff to set so if you don't know what's going on don't worry about it it's just a modal okay so nothing nothing too confusing so just follow through it's a very simple component nothing too confusing okay so first let's go back to our video component which is under our videos index. TSX and we have to provide the workspace ID and this is going to be the workspace ID next we need to use the spread operator and pass in everything we got from video which is let me see where that is okay so for now of course we don't have this so let me see if I can get some mock data okay so let me see if I can copy this and I'm going to chat and I'm going to say please give me mock data for one video here is the schema okay going to paste the schema and just give it a second and it's going to give me some amazing data all right now I can copy this and I can shrink this and up top here I'm just going to past this so now I can call this video um I don't want videos I just want one video I'm going to copy this video in here scroll to the bottom and I'm going just going to use the spread operator okay now going back into our video card in our card menu we also need to provide these props right so this one needs video ID the current workspace ID the folder and the folder name so I'm going to go back here and inside this all I'm going to do is provide those props okay so current folder name is props folder. name video ID is props ID same same thing okay and yeah that's it so current current folder is going to be the folder. ID probably should have changed this this name here this prop name but it's fine and then current workspace is props.for ID okay all right now let's go into this card component and let's just completely like finish this completely so here we're going to need a change video location component so I'm going to bring this in and this is going to need all of these props as well so I'm going to drill these in here I know it's really bad but essentially we're passing in the current folder the workspace the video ID and the current folder name so copy this name open up your folder structure and you're going to go into forms right here you're going to create one inside let me see give me one second so in here I'm going to create one called change video location it's going to have an index. TSX and of course we're going to need a schema. typescript right now inside the index. TSX file first thing is we're going to render out um a template in here and we're going to need those props right so the props here are video ID current folder the workspace and the folder name and now let's go ahead and also destructure all these values okay nice and now in here first thing is we're going to use another hook this is called the use move videos okay with the help of this we can get access to all of the folders um and pretty much it's going to help us with moving it um optimistically okay but for now I want to First solve this error here so I'm going to go back and not in my schema file inside my video card menu and I'm going to import this component so let's just give that a second let's go back in here and what is it saying properties null use context hello okay never mind okay so create the work in progress flag and I'm going to say wire up the use move folder okay cuz that's next but for now I'm going to first create our form element so we can see what we're building at least to some extent right so for form the class name is going to be Flex Flex D column it's going to be Gap Dy D5 and inside this we're going to actually we also need an onsubmit but okay we'll do that later so we're going to say div a class name is going to have border -1 pixel rounded DXL and padding of five okay and now inside this we're going to create our H2 elements and this H2 is going to have a class name of text- XS margin bottom of five text of a specific color and I'm just going to set okay one of these and then inside this I'm going to say current all right now after this if we have a workspace we'll render out that workspace name okay so in here we're going to say workspace if this exists then we're going to create a paragraph tag um hello please give me a paragraph thank you and in here we're going to set text to the same color so let me remove this sucks man I should have fixed this guys really really sorry okay I'm really sorry don't be mad at me but this workspace is going to come from our API call by the way sorry not API call it's going to come from the current workspace um which is right here oh okay I thought we're going to get this from one of the hooks so what I'll do is down here I'm going to say const workspace equal to workspaces um where is this okay yeah I don't think we can get it from here exactly um yeah all right guys it's fine for now it's fine I'm just going to remove this remove this if condition okay we're just going to return a paragraph tag and in here we're just going to return something called workspace in here okay and next down here I'm going to just say this video has no folder for now because we're going to need to look and see if we found the right folder ID based on the current folder and and that's going to come in from a hook okay but this is all we need to just get started and then we're going to bring in the separator component in here and the separator component is going to have orientation set to orizontal and after this we're going to need a div with the following class name so this class name is going to be Flex Flex D column okay Gap D y-5 and padding of five okay um Also let's add border on this so border of one pixel and then we're going to have rounded Das XEL okay all right nice cool now inside this div we're going to need to create an H2 element in here as well and essentially what we're doing in here is we're showing where we can move this folder two all right and the two is going to have like right after the two we're going to have a select element where the user can select the right folder that's pretty much it so create the h tag in here say two and after this we need to create a label element okay so I'm going to import label from components UI label and I'm going to add the following class names on this label as well and inside this label I'm going to essentially say p workspace oops sorry I don't want to click on this workspace and after this we need to bring in our select elements so I'm going to say select element right like this and now we're going to need the register and all this kind of stuff right so for now I'm just going to remove this and we'll get to that in just a second but in here first thing is I want to Loop over a bunch of stuff and I want to show options but right now of course we don't have that so I'm just going to render an option and this option is essentially just going to have a value set to something like this okay and we're also going to need the uh the workspace name itself so I'll put that in here as well all right so quick one here's what I'm going to do so I'm going to go back into my video card file right here okay and what I'm going to do is first thing is I'm going to remove this overflow hidden or we don't even need to do that I'm just going to comment out everything in here right so comment this stuff and after that I'm going to place my change video location so at least we can see what's going on all right nice now I can go into this component and uh now I can pretty much continue and you can also see what's going on okay okay so now that we understand what the layout is going to look like we can go ahead and create that hook and we can pretty much get all the values that we need okay so we're going to say const and this is equal to use move videos okay and this Hook is going to be created inside our hooks folder so it's called use move videos so use move videos. typescript and we're going to export or actually we don't even need to do this we can we can probably create all right let me create a a better naming structure for this so in here I'm going to say use folders okay and inside this we can have whatever we want all right if you want that or if you think it's better to have uh individual um hooks that's fine as well and in here I'm going to say export const use move videos this is going to be an arrow function and this is going to need first the video ID which is going to be a string we need the current workspace which is going to be a string as well that's pretty much the ID okay so probably should rename that but because my premium um code Bas is already having this I don't want to create any errors here but inside this I want to first get some state from the Redux store right so essentially what we're doing here is remember I told you the reason why we want to use this is I want to show you how to use Redux as well and how it can also be used interchangeably with um you know the react query but the power react query is far more than what Redux can do but I'm just showing you how you can use Redux in your application that's pretty much it all right so nothing too complex here so first thing is we need the app selector that's how we can extract the workspace and the folder data then after that we're going to need to create some states like fetching the folder um you know fetching pretty much something to hold some sort of API States right uh API response States and then I also change this to say API response States or fetching States it sounds better the next thing is we're going to have a state for folders that we can store in here because in here is where we're going to determine which folder to move it under right and then next we're going to use our use mutation data and this Hook is going to pretty much help us uh create that optimistic change right and then after that we're also going to use hook forms so we're going to be using Zod forms not hook forms but pretty much same thing so the hook is actually called use Zod forms right so we're going to use this to essentially wire up our element so wire up our select element so use Zod form and after this we're going to need to fetch folders so this is where we'll use the fetching States so once we fetch folders we'll set the state do all that kind of stuff and we can use a use effect to essentially do this right so we'll say fetch folders with a use effect okay okay and then once this is done we're going to um grab we're going to essentially sorry we're going to listen to the workspace changes and then we're going to return like a cleanup function and then we're just going to return all of the data that is used for in our component right cuz we need the folders We need the workspaces we need um any sort of fetching State um form stuff all that kind of thing so that's pretty much what this is going to help us do so first thing is let's go ahead and wire up our Redux store so open up your folder structure you're going to scroll down here so just shrink everything actually go to source and down here you're going to create another folder called Redux and inside this we're going to create first the slices folder and then we're going to need our store so store. typescript and I want to make sure this is under Redux folder all right nice and after this we want to also create a provider. TSX okay so first thing is we're going to need Redux and Redux toolkit so open up your terminal we're going to quit the terminal and we're going to say bunad at Redux JS toolkit okay and let that install awesome and then we're going to need bunad react-redux okay now the first thing we need is our provider so inside our provider file we're going to say use client okay going to shrink this sidebar and first thing is export const Redux provider provide okay equal to an arrow function and this is going to give us access to children and these children are essentially going to be react. react node okay so let's grab that as well and inside here we're going to return the provider that comes from um react where is this okay it comes from react Redux so let me just manually install it first and then I can invoke it okay and our provider is going to first have a store and now we're going to pass in a store which we need to create and uh but in here first let me just render out the children components so how do you create a store let's go in here I'm not going to I'm not going this is not a like you know a Redux course or something but I'm just going to show you right a store is essentially think about it as one object to store all the data that's pretty much it and that data gets passed through the provider State into all your components okay if you want to use react context API or something else um Zeus sand whatever you want no problem I like Redux because we use this in production grade applications as well okay so first thing is this is going to be a use client component let me make sure my provider is used client as well all right awesome and first thing is I need to create a root reducer all our reducers are going to go inside this one object so const root reducer is equal to combine reducers oh it's not letting me import that okay well I'll just get it might as well do it right so we're going to get combined r reducers and configure store these are the two things that we're going to need so I'm just going to import that and I'm going to say combine reducers I'm going to invoke this and I'm going to pass in the reducers that we need okay but of course we don't have the reducers right now so we'll create them in just a second but the next thing we want to do in here is I'm going to create the store itself so export const store equal store equal configure store we're going to invoke this and our reducer is going to be our root reducer so reducer is going to be root reducer and we're going to need to pass in a middleware file okay and the the middleware that we're going to do in here is let me go ahead and also rename this okay middleware nice and this is going to actually give us access to something called get default middleware okay so we're going to get this and we're going to invoke it here and inside this we're going to pass in an object called serializable check and pass it to false all right now after this we want to export our root app State the dispatch function and our app selector so we can get access to all of this okay so first thing is export type so these are also types as well right um we will create the uh use app selector after these types so first one is root State equal to return type of type of store.get state right and then we need to export type app State uh sorry guys app dispatch and this is equal to type of store. dispatch okay so we can use these types whenever we need and now the app selector the use app selector is essentially going to have type definitions already added to it okay we're going to show you how to do that but this app selector is going to give us access to the Redux store data okay so export const use app selector and in here we're going to say type um used use selector hook and this is going to be root State why is it not giving it to me root State like this and this is equal to use selector okay use select okay thank God it gave it to me nice all right don't invoke it sorry about that do not invoke okay so we're just wiring this up with the new uh root state that we have so it knows the data that we get from this and we can basically get type intellisense for our Redux story now let's go go ahead and create reducers for our store okay so inside slices you're going to create two for now uh first one is folders right because we're working with folders. typescript and then also workspaces do typescript and inside the folders we're essentially going to do the following so the first thing is we need a type for the initial state of our folders so I'm just going to create a type here we're going to have the folders itself which is an array right and it's going to also extend and have count on top of that so folders is going to have count with videos and which is a number and the name of the folder the ID created at workspace ID as well and this is going to be an array right and then we have to create the initial State itself so initial state is going to be initial State props and this is equal to an object and in here we need to give it the values or it's going to scream at us right so we going to say this is going to be a folder then we need the folder slice so we're going to say const export const folders equal create slice we're going to invoke this and we're going to pass in the slice name so it's going to be folders okay and then next we need the initial state which is going to be our initial state that we just grabbed from above so we don't even need to do anything don't need to provide two just have to provide the key right next reducers and for now we only have one reducer which is folders now this naming convention is not the best but I just want to show you how things work right that's pretty much it so you can have different type of um different type of reducer names so for example get folders add folders delete folders all these kind of actions and this is how it's done in production grade code okay so in here first thing is we need State and then action which is payload action let's invoke that and we want to pass in our initial State props okay now and now what is this going to return well it's going to return everything that's inside action. payload okay and now down here so essentially it's like a way to get the folders that are inside okay inside our Redux store and now down here we need to export export sorry guys we need to export const the folders we're going to destructure this from folders. action why is this not showing okay first let's rename this to folders folders. actions okay so let's grab the folder action in here and down here we're going to also export defaults and we're going to export the folders. reducer okay nice now let's go and also create the workspace reducer or slice might as well do it and again we're going to need the initial State props which is workspaces it's an array we're going to have type name and ID personal or public right then we need to create the initial state so this is the initial state right here which is works spaces set to an empty array then we need the workspaces the slice itself so workspaces equal to create slice and the name is workspaces initial state is this one and the reducers is workspaces right here and this is going to give us everything that's inside action. payload okay so we're going to return all of that and down here we need to extract our actions so we can dispatch it from somewhere else and then we also need to get our reducer itself so now let's go back to our provider sorry not provider okay actually we also have to go back to our provider because we need to pass in our store right so let's pass in the store and then inside the store itself we need to bring in these two provide uh these two reducers that we just created so in here I'm going to say folder reducer okay it's not giving the type intellisense folder okay let me just manually install it okay so folder reducer like this from slices folders and then we also need the workspace reducers from slices workspace so let's grab that as well and also put the name in here folder reducer and workspace reducer done I know that was a lot of setup but the reason why this is done is well there is a Reason by why you know Redux has it's very opinionated right so the first thing is you get a lot of benefit when it's used in the production in production grade applications for example you can test you can debug you can use it to mock data you can do the same thing I mean part of it you can do it with react context API but with Redux it's better because you can combine um stuff like middleware you can use stuns you can do a bunch of cool stuff with Redux okay and my favorite part of Redux is Redux Dev tools because you can see each and every action what the state was before the action was performed and after you can also change the state in the you know in inside the dev tools so you can see what it does to the browser you can see what it does to your application and pretty much whatever you want right you can also Mock and fire actions using the dev tools okay now we're not going to do all of that in this video or we'll be here till the end of 2030 and I will grow old so I just want to give you a heads up as to why we have to do so much setup for Redux okay zand is much simple much simpler and if you like that you can go for it but you will probably never find a production grade project using zoan just because it's a little newer and I don't know why people don't like it I honestly love it right but I see most of my projects use Redux all right cool let's move on now all right so now that we have our Redux store set up let's go back to our hook which is the the Ed folders and I'm going to also first just change this name to use folders. typescript and inside this we can ascend entally initiate the process um all the processes that we just spoke about okay so first let's get our app state which is our app selector so const data equal to use app selector we're going to invoke this and now we're going to get a callback function that's going to give us access to the state and we're going to return state.the folder reducer so in here we're going to get the folders all right next we're going to do the same thing for workspaces so I'm going to go in here and I'm going to get the work workspaces reducer from this and next I need to create the fetching state so I'm going to say const is fetching and set is fetching and next I'm going to set this equal to use state I'm going to invoke this and I'm going to set false in here okay and now I need a a state to also hold my folders so I'm going to change this to folders uh actually not folders is folders okay is folders and set is folders as well okay and this is going to be the following data type so right here I'm going to open this in here first type a pipe and then inside this I'm going to say underscore count this is going to be an object with videos set to number okay and after this we're going to need to extend expand on this so I'm going to say and or maybe hm right let me I need to first put this inside a just syntax stuff so I I have to put this inside a bracket and then I'm going to need to also put a pipe before this because we have a state after that right undefined state so after this curly bracket I'm going to expand on this and I'm going to say ID is going to be set to a string name is going to be set to a string created at going to be created at is going to be set to a date and then workspace let me also remove all of this and then workspace id id or work space ID is going to be set to a string or null and then after this down here I'm going to set this to an array and I'm going to say or undefined okay now we're going to have errors here so I'm going to quickly solve these errors let's see what the error here is okay so I'm just going to ask AI to fix it for me all right please just apply this change all right thank you let's accept it all right let me also just quickly read um what do we have in here okay so we have count videos and this should be number and then we have and ID name created at V uh workspace ID string null this is an array of these folders or it can be undefined and we're just going to set undefined okay nice next I'm going to say const some data equal to use mutation data I'm going to invoke this and first I'm going to grab our mutation our mutate function function and the is pending okay and I'm also going to bring this down here under this comment and next I need to pass in my key right my query key so the key in here or the mutation key is going to be called change- video- location and next I'm going to pass in an arrow function which is going to give me access to the data so in here I'm going to get data and I'm going to extract the folder undor ID which is a string from this and I'm also going to need the workspace ID which is going to be a string as well all right and in here I'm going to call my move video location uh server action and inside that I'm going to pass in all this data so let's go into our actions folder and I'm going to look for workspace going to scroll to the bottom and I'm going to say const or export const move video location and this is going to need first the video ID workspace ID and the folder ID which are all strings okay so please pause and type and after this I'm going to have a tri catch Block in here and the first thing is we're going to go into the database and we're going to get that video okay and after we get it we're going to update the information so we can use the client. video. update method okay so you're going to say location equal to await and first don't forget to change this to an async function await client. video. update for this video ID we want to update the data and set its folder ID to the following or set it to null okay and for workspace ID we'll just keep it the same so I'm going to remove this and just keep it like this okay what seems to be the all right never mind so I can change it like this and then remove this okay and then after this we're going to say if everything was successful return to 100 and say folder changed successfully if nothing happened some sort of error took place and also you want to move this or okay this is fine never mind sorry guys and after this if this was not successful just return a 404 and just show the error right and say workspace was not found or the folder was not found and then if a error happened on the server side we'll return 500 say oops something went wrong cool all right so let's go back and then let's import this move video location server action and also we need to return the server action right so in here I'm going to return the server action and I'm going to pass in all the values that it needs so first we need the video ID and next we need the data. workspace ID so right here we have workspace ID so let's pass that in and then data. folder ID okay so just pass these these into the server action next we're going to need use form to essentially set up this form in here so down inside this comment I'm going to say const equal to use Zod form and I'm going to invoke that why does it keep saving this file okay and then I'm going to get the errors on on submit I'm going to get register and reset or actually we don't need this I'm going to get onsubmit errors I need watch I also need register and I think this should be good to go so watch errors register and on form submit okay and now in here first I need to pass in the uh the server action sorry guys I need to pass in the schema so let's go ahead and create a schema inside this file so in here you're going to find um where do I have this change video location under components forms okay right in here under schema I'm going to say the following so I'm going to say z. object folder ID is a string which is optional and workspace ID is a string as well okay so I'm going to go back and I'm going to grab my schema move video schema okay nice and the next next parameter is the mutate function so let's pass it in as well so we want to say mutate nice and I'm going to remove this okay mutate and finally I need to pass in an object in here and you can also hover over this right and you can see what what essentially we need to pass in so schema mutation and any default values so the default values that I'm going to pass in is the folder ID and the workspace ID ID okay so let's pass it in there and that will automatically populate the form elements okay next thing we need right after this is fetching the folders and we need the use effect stuff right so down here I'm going to say const fetch folders equal to async Arrow function and I need the workspace which is going to be a string in here and inside this I'm going to set is fetching first to True okay and then I want to say const folders equal to await get workspace folders we're going to invoke this and pass in our workspace inside it which is essentially the workspace ID right and then we want to set the worksspace set is fetching back to false and then we also want to set is folders to those folders that we got so folder. data okay this one right here folders. data nice now after this we need to do the use effect right the use effect is is going to help us fetch these folders so I'm going to say use effect okay I'm going to pass it an empty dependency and upon Mount I'm going to fetch the folders and pass in the current workspace all right nice then I'm going to have another use effect and this use effect is essentially going to watch for the changes and every time a change occurred we want to also fetch the folders one more time right so here's all I'm going to do I'm going to say use effect let me just copy this use effect down below and in here I'm going to remove this and I need to pass in watch as a dependency cuz I'm using it so I'm going to say workspace equal watch okay I'm going to invoke this and this will take in an arrow function and in here I'm going to pass in async and first thing is if values uh sorry the value comes in from here right so if the value that changed has the workspace ID then we want to fetch the folders one more time and I'm going to pass in the value. workspace ID inside this okay awesome now also we need a cleanup here because this is a subscribe uh subscription so we're going to say return workspace do unsubscribe okay nice and now finally we have to return all of the stuff that we just created so please type with me um or actually I'm not going to type this it's going to take too long so I'm just going to return the on form submit errors register is pending the folders workspaces is fetching and is folders as well okay awesome now let's go back and first thing is I see use move videos screaming at me so I'm going to go into my videos video card and first I'm going to import this okay all right this is that's imported I'm going to import the use move videos as well which is inside the change video location now it says could not find react Redux context value well the reason is because we did not um wrap our entire application inside this Redux provider right so let's go into uh Source go into app and you want to go into layout and inside this component right here we're going to need to wrap this inside our Redux provider so down here I'm going to say Redux provider and I'm going to move our query provider inside that okay now we should have all the states awesome cool so let's go back and make sure we imported this okay nice and now first thing is it need needs the video ID so I'm going to pass in the video ID and it also needs the current workspace okay all right nice what seems to be the arrow here okay let's just put this exclamation at the end I think this should solve the problem all right nice and now in here what we're going to do is we're essentially going to destructure all of the values that we're returning back from this hook okay so we're going to get register we're going to get pending pretty much every single thing so just destructure everything which is on form submit folders workspace is fetching and is folders and down here now we're going to filter for the current folder okay I'm going to say folder equal folders. find where the this folder ID is equal to the current folder ID okay essentially we're just trying to get the information of the folder itself and the information of the workpace itself okay so I'm going to say workspace equal workspaces doind where f. ID equal to current workspace okay just like this nice and now we'll have access to those values so first thing down here is inside this current we have something here called workspace right just remove this okay just cut it out and we're going to say workspace if this exists then we're going to return this P tag okay and inside this P tag we're going to render the workspace do name and next to that we're going to say workspace just like this so let me go ahead and refresh the browser and just see what happens okay so nothing is being provided and the reason is because we're not passing any props into this component so I'm going to go back here and if I uncomment this let's see what happens okay it's because we haven't we haven't got all these values yet right so let's go ahead and pass these props into this component first so in here I'm just going to rename all of this using these props okay because they're already being passed in I believe let me see okay we have our dashboard workspace okay so inside here we have some video information that's being passed in but it's kind of hardcoded right now of course but this should technically do the job right so let's just go ahead and rename this to the following so what seems to be the error here okay I don't know what the error was current workspace is props workspace ID does it exist yes it does and it's saying the current hm let me go in here and take a look at the types all right sorry guys it was just a spelling error turns out this one is case sensitive right so I just had to change that real quick so hopefully you found it and you fixed it as well but that was the only mistake all right guys so it's getting a little challenging to use mock data because the first thing is the ID is not real right the folder ID the name and all these kind of things they just don't make sense because it's not real data right and everything is a dependent um and it has you know foreign keys and stuff like that so it's better for us to just use real data and it's sucks that I never thought about this in the beginning itself but essentially you can use Prisma studio and create entries directly in here as well so for example um first thing you want to do is say bun X Prisma studio and if you hit enter it's going to open up this Command right it's going to open up Local Host 5555 all right and then you can open that in here and it's going to show you your entire table so you can essentially communicate with the database directly through this Pres Studio okay so we're going to click on videos in here and it's going to open up uh for you you're not going to have anything actually for me I have something because I just created a new entry but I'm going to show you what you need to do okay so click on ADD record and then first this is autogenerated so you can skip over that skip over everything just scroll to folder click on folder and then you can click on whatever folder you want I'm just using uh whatever folder you want I'm just using productes University and then for um for folder ID you can skip over it cuz it's it's just going to auto connect for user go ahead and click on user as well and then you should technically only have one user so you can click on this check it right and let me do it for this one as well okay nice and then in here for workspace I'm going to select another workspace right the only workspace I have and the ID will also automates and that's pretty much it and then the next thing is for the description or the title I'm going to change this to something else right so this is Untitled video for this one I'm just going to change it to Second video just to see what happens right and then you save the change that you just made okay looks like there's some error in here let me just refresh okay and okay so it looks like there is some problem let me quickly fix this okay so it looked like something was wrong with the date module not found hm interesting let me close this and disc Scar the change and let me do that once more okay so I'm going to go back into videos and just give me a second let me pause this and do it off off screen and then I'll show you okay okay so I'm not entirely sure why that's going on let me look at my Prisma schema to make sure that I can have multiple videos so okay we have media in here we have a workspace we have folders and we have multiple videos okay this looks fine and for a video the title does not have to be unique default is set to this okay cool and then what's the other problem here okay so I'm not sure why it's not creating it for me but I already created one entry so I'm just going to use this okay so you should be able to create one entry in here and you can now connect it pretty much fetch data directly from here okay so that's going to save us a ton of time um so let me go back real quick to our component and now I'm going to remove this so it causes errors in my application and then I can fix it where I need to so first thing is down here I'm going to remove this right and let's also remove the video itself and I'm going to push the video card into this map function and in here all I'm going to do first is up top just make sure the success status is the video status is not 200 and if so I'm going to return pf5 and return the same class name and down here if video is equal to 200 we're going to map over them and uh return a video card okay so let's go back to Local Host and let's refresh okay so we're going to say bun runev and let's refresh the browser okay and the other thing we need to provide in here is the key so I'm going to say video do ID and that's that should be good to go for key and for paragraph no videos in workspace okay this is good to go so we're already returning a video in here because a video does exist all right so now let's go back into the card and we can pretty much just sort of wire this up so it's not so messy right um so let's go ahead and do this so the first thing is I'm going to get a formula that's going to help me get the upload days ago right I don't know how else to call it but it's essentially math. floor and inside that we're going to pass in a new date. get time and for this we're going to subtract the created at date and time right and then we're going to divide it by 24 into 60 into 60 into 1,000 and that's going to give us how many days ago it was uploaded okay then next down here for the state we're going to change this to state. processing so Props do processing and we're going to need some class names on this loader as well so I'll pass that in right now so it's going to say BG this color Flex justify Center item Center border 1 pixel and Border 25 25 25 and Border Excel so if I refresh this it looks like something is happening here and that's probably because processing is set to True right because the default value of processing is um is false is true so that's why let me see if I can show all right there you go so it's set to true so I'm going to change it to false and save this change now if I go back to opal and if I refresh well I'm going to see this data here because I made a change and our cache data is not changed so let me just give that a second okay awesome and now it will render out the elements inside okay Okay cool so now we have this part so I'm going to remove this change video location cuz we no longer need it and I'm going to uncomment this and inside this component we're going to render out the same thing but we have a overflow hidden and this overflow hidden apparently is hiding this model but this is pretty much what the model looks like right and we're going to show all the values directly in here as well and we'll set that up just to make sure it's rendering correctly but that's pretty much it right we just have an element that shows just like this inside a modal okay so I'm going to bring back this overflow hidden and right after this I'm going to create a copy link component It's relatively simple but this is going to have two props I'm just going to pass it in for now and this is going to look like this so it's going to say BG hover background transparent height of five padding of zero okay and we also need to pass in the video ID so I'm going to say video ID like this and this is equal to props do ID okay and essentially when you click on this icon it's just going to save it to the clipboard okay so open up your folder structure and in here you can create um a link dot or copy link copy link. TSX file and I'm going to return a template and change this title and this is going to need first the video ID so I'm going to get the video ID and the class name as well and for this we can also have variance because essentially this is a button right so I can bring in variant so we have default destructive uh outline secondary ghost and Link and this is coming from shaten so that's why I'm providing them right here and then go ahead and destructure these okay nice and next we're going to have um the button here so first let me import it so I don't see any errors so copy link bring that in and now down here I'm going to return a button component and inside this button component I'm going to show the link element that comes from Lucid react okay and let's just give that a second okay so I returned the wrong button this button comes from our components folder not from react day picker okay and inside this link I'm going to have the following props so we're going to have the size and the class name so the size is going to be 20 and for class name we're going to have the text set to the following color okay then the other props that need to be passed into the button are the variant so I'm going to say variant like this equal to variant and next I need onclick which we're going to create in just a second but I'm going to just say onclick like this and set it to an empty value and then the class name is going to be set to the class name that was passed in now for the onclick all we're going to do in here is first this needs to change to a client component actually hm I think it should be fine but here we're going to say const on copy clipboard equal to an arrow function and this is going to do Navigator docboard do write text you're going to invoke that and you're going to dynamically pass in a string okay now this is going to come in from our environment variables but for now it's going to look like this okay process. environment. next public host URL and slash pre preview and Slash the video ID so we'll eventually create that right that route and that time this will work but let's also go into our environment file and first I'm going to copy this here so you can you probably will also have this but I'm going to copy this and go into my environment and I'm going to paste this value in here okay all right just like that and now I can set this to the to that public host variable so let's go back because of course we don't have it right so let's go back let's go in here and let's see what's the issue okay let's grab this onclick Handler and let's pass it in here finally I'm also going to show a toast message saying copied and we're just going to return toast that comes from uh use toast we're going to pass in copied and down here I'm going to pass in description and I'm going to have a link saying I'm going to have a message saying link successfully copied okay let's use sonar for this that might be better so let's import sonar okay that's actually going to work for our syntax and I'm going to go back and just make sure this works I'm going to remove this overflow hidden and if I click on this let's see what happens absolutely nothing happens which is great okay let me fix this guys okay so it is working but for some reason my toast message is not showing and I think I know the reason why if you scroll down and go into your root file which is under layout. TSX I think we also need to show the toast in here right we have to have some sort of a provider or a component I think that's how shatan wants us to do that so let me go ahead and get that for us so right in here I'm going to say Toaster like this and I'm going to import it from sonar and okay no more errors Let me refresh the page and when I click on it now I can see that show up okay okay so let's go back here and now after this copy link element we're going to have another link component okay and this link component is going to render out a a video and it's also going to have like uh pretty much a um the source which is like a thumbnail right we're going to render a thumbnail in there we're going to have um an H2 just like this right we'll have title we'll have Avatar image and all this kind of info so let's go ahead and build that out so right after the first div I'm going to say link and I'm going to import this link from the next link we're going to have the href which is going to be preview of course and we're going to pass in the props doid and then we're going to have a class name please pause and type this class name and inside this link we're going to have the video elements so let's go ahead and say video like this okay video elements and this is going to have a closing tag as well and in here we have to say controls false so we have nothing inside right preload is going to be set to metadata class name is going to be with full aspect video uh opacity 50 Z of 20 okay and now for Source we're not going to have all this right now we're just going to put it for now all right but if you don't see anything it's fine don't worry about it it's just for um just to have a layout and now when you hover over this you're going to notice the borders change to Sharp borders right the reason is because this entire container does not have overflow hidden that's why so now we can bring back that overflow hidden so it makes more sense okay there we go next after this video I'm going to create a div tag so I'm going to say div and give it the following class names so padding X of five padding y of three Flex Flex column and then we need gap of Y of two Z of 20 and inside this we're going to create an H2 tag and the class name is going to be text small font Boldt so semi Boldt text Dash and I'm going to add the following style and after this inside the H2 I'm going to say props do tile okay so we can render that out in here and I also think there's something wrong with this let me go into the click link the copy link and let me see what problem we have in here okay so for variant maybe we could pass in let me see so for variant what if we pass in ghost okay that looks so much better okay so the first thing is the variant removes the background but I also want to change the icon itself so I'm using the links icon that comes from our components folder okay not the Lucid react one cuz I just feel this looks so much better it just it's a little too light and I might want to get this color instead so let me see if I can grab this one so what do we have in here Foundation Gray let me grab this okay and let me go into this component and see if I can change it okay so so we have it's the same color hm why does it feel so light okay let me grab this one the foundation 600 and I'll change the background and see if that changes so we'll set this to let me go back real quick and in here the BG is going to be a color and I'm going to just put this color in here let's just see what that does okay of course it just completely transformed I don't really know what the hell is going on here uh let me fix guys give me a second okay so for some reason the colors that are in figma and the colors that are in here don't really match up even though they're the exact same thing sometimes this can happen U so I'm just going to go down here and I'm going to change these colors okay so if you hover over the fill or if you add a class name I think we can see G and set this to a custom color okay so we can see it from here itself so I'm just going to increase this color remove this and add it in here okay and let's see what this does okay that's so much better so I'll change this in here as well and if you're noticing your your inspect element sorry your console is blowing up with the fill Rule and the clip rule that's because this needs to be changed to clip rule okay but I'm just going to keep it like this for now cuz I'm not really bothered about it um but that's pretty much it and the other thing is this move icon right might want to have a slightly better icon for that one as well so let me go ahead and fix that all right so I just made a couple changes and I just want to walk you through what I did so the first thing is I added group out here right I'm sorry on this uh element that way inside this one I can say group hover flex but by default be hidden so having this shown by default just looks really weird and odd so that's why I'm hiding it um when we're not essentially hovering over them and that's how how the figma mockups are also made right so that's why I'm going to keep them uh pretty much hidden and then once I hover I'll show them okay then the next thing is inside the copy link I change the color uh for the button uh and that's right here so I change the color to BG and I set it to this one then inside the card menu I Chang the move color to the following fill and the text so that way it has a slightly different lighter color right cuz we're going for that low contrast design right so you can add that one as well if you like this and I think this one looks so much better and for the variant I also changed the variant of the copy link uh I removed it uh you know uh completely because I did not like the other design as well okay okay now after this you're going to create another div and you're going to give it the following class name and I it looks like I'm making too many spelling errors guys when I type and I really hate it cuz it gets me like you know going crazy cuz I don't know where stuff is coming from so I'm going to copy paste the class names from now on okay that way you can just pause and type saves me time and the video is going to be hours shorter okay so Flex Gap X2 items of Center and inside this we're going to use the Avatar icon okay um and if you have seen chaden in the past it's very simple it's just the Avatar Avatar image and a fallback okay so let's go ahead and bring in the Avatar image component we need the Avatar itself make sure you import everything from the the right folder okay which is components UI and for user I'm also going to import the Lucid react icon all right nice look at that looks awesome now on the Avatar you can add a class name and we're going to give it give it margin top of four okay so it has a little more space or even two is fine you don't need too much okay not too bad and maybe we can set some width and height on this so width and height I'm going to set it to eight and that should be good to go now after the Avatar down here we're going to create another div and inside this we're going to create a paragraph tag and this is going to have the following class names so I'm going to say class name capitalize text text small and inside this we're going to put the user's first name and their last name as well so I'm going to say props do user. first name and props do user. last name okay just like this and maybe you can change this to EXs we don't need such a huge name right and you can also change the font color make it a little bit darker um if it will change today okay awesome all right then after that we're going to also need to show the days right uh when this video was created So Below this paragraph create another paragraph with the following text and we're going to say text EXs and if the days is zero we're going to say today if not we're going to show the number of days okay so 24 days ago whatever we're pretty much just going to render that in here also one more quick fix guys we're going to go in here to margin top six on the Avatar and we're going to remove that and we're going to set it on this div itself okay and in here uh sorry it was margin top two for you and I'm just going to change it to margin top of four okay that looks like a decent amount of spacing and yep all right so that's it and let's scroll down here and next I added a DOT icon and I added Flex items Center okay and it shows today in here and if it was created another day we'll essentially show you know how many days from today that's pretty much it now after this div two divs down below we're going to create another one and inside this we're going to create a span tag and let's give it Flex also let me copy uh I don't want to make any spelling errors Flex Gap X of one we need fill and items of Cent item Center okay then we're going to show a little share icon and this is called share to from Lucid react and we're going to give it the following style okay fill class name and size of 12 and for this we can also give it a class name margin top of two or four if you want to make it uh more uniform and I think that one looks slightly better actually okay awesome and after this we need to show who uh essentially I mean which workspace it was shared from you see it shows a name right so we're going to need to create a name in here so we're going to create a paragraph tag right after the share icon with the following in class name and we're going to say props do user. firstname apostrophe s workspace okay not workplace workspace and I'm also going to remove the text that I have on the um on on this name right here and I'm going to add that same class name to the days okay and I'm going to copy this from the title whichever I have right here which is right here copy that I'm want to scroll down below and I'm going to put it in this name so they both look alike all right awesome so now if I go back to my library file and uh Library routes and if I take a look at this it should show one video inside this folder and when I click on this folder it's going to instantly take me into that folder and it's also going to show me the video itself right in here and also went ahead and changed the title to see what it looks like if the title was longer and it looks great okay awesome guys now let's quickly go back to our my library route which is in here so my library where are you hello okay page. TSX and if you scroll down here we have our folders right we also need to render out some videos in this file but I would like for you to take this up as a challenge I just showed you how to create files in here right how to create videos and pretty much how to render them inside a folder right now the challenge here is that you're going to need to render out um videos inside inside the Library itself so you can Loop over you know all the work all the videos that you get or you can just pick the first couple videos that the user created and you can render them out in here okay so I'd like for you to take that up as a challenge and complete that section but I'm going to move on into the next stages which is to get this video stuff up and running did a quick search like this to check for any work in progress flags and we have a bunch of stuff to do so let's just quickly clear that up the first one is moving the folder right so uh moving the video into a different folder so we want to try to see if this works and um right now we don't have anything set up so let's just quickly go ahead and set that up so the first thing is if you try to go into the use um the use move videos hook you'll notice that we are using the state right here which is Redux state but of course we aren't setting anything inside the data right inside the state itself we have only configured the Redux state but we haven't sent or dispatched any actions along with the data into our store so first we need to do that in order to use this data inside our applica inside this uh hook and that way we can get all of the folders along with the workspaces so that was the problem right here okay that's why we weren't seeing anything so of course we have to go ahead and do that so let's go ahead and do that first so first go into sidebar into index. TSX and you're going to scroll down here and the reason why we need to go into this file is we're fetching the workspaces already inside this place right so when we get the data we want to store that inside our Redux store so we're going to say if is fetched okay and if workspace exists then we're going to dispatch so to get dispatch we also have to use a hook here so let's scroll up top and you're going to say const dispatch equal use dispatch right and if you invoke this now you can uh pretty much use this and this of course comes from react Redux so once we get this we can invoke dispatch and now we have to fire an action okay dispatch an action to our store and the action that we need is workspaces right here we're going to invoke this and we're going to pass in the workspaces and we're going to set it to workspace workspace okay just like this and all right let's see what's going on cool so now that we have stored the work spaces the next one is we also have to dispatch all of the folders so let's go ahead and do that as well so open up your folder structure and you want to scroll down into folders click on the index. TSX and if you scroll up top you see we have a work in progress flag right so let's remove this and first thing we want to do is get get our dispatch function so const dispatch equal to use dispatch and now down here we can say if is fetched and we have folders then we're going to dispatch the following action so we're going to say folders we're going to invoke it and the folders that we're going to pass in is going to be our folders data okay awesome so now when you click this m move icon you're going to see we're going to get data that comes from our state right from a Redux store and that Redux store data is essentially just getting populated in here that's pretty much it so now I'm going to go into the change video location form and okay we still have some stuff to do in here as well and I think we also have a component let me go ahead and find fig I mean figure out the component where it is first okay so inside the video card we have card menu okay and then we have something called change video location all right now we can go through this component so this is inside our change video location form and inside this let's just quickly complete this component as well so I just quickly made some changes here first is I changed the H2 to current workspaces then I remove the word workspaces itself so that way it doesn't just Spam and show you know em Manual's workspaces SL workspace is just too much all right and what I did is I removed the margin top top and I just kept it as current workspaces and below that we can see the workspace itself and then in here I'm going to remove this so we can see the um what do you call this all right let me also change this one here okay so I just removed the text size and now we can see the current folder right so I created another H2 same exact stuff here but I added margin top and I said current folder and I said um now I have to render out the folder that we're inside so all we're going to do in here is we're going to say if folder exist then we're going to do something if not we'll do something else so inside here we're going to return a p uh P tag and we don't need any class name just render this out we're going to say folder. name okay and if there's nothing we're going to say this this video has no folder okay awesome and then after that down here we have the separator so this is good to go we have a div H2 uh a label we have the paragraph tag to show the workspaces and then we have something called two here so two and we want to show which specific workspace right so we're going to have the paragraph that says workspace in here and then we have a section here with options inside so let's go ahead and remove this option and first thing is now that we have register I'm going to use the spread operator and I'm going to bind register to this element okay uh what seems to be the issue here okay so register sorry guys I'm using the wrong um the wrong notation so it's register like this okay all right nice so we're using that in here and the next one is we can also provide a class name let me make sure we have everything correct okay background transparent nice let me open this and the next thing we want to do inside this is we want to Loop over all the workspaces and render out an option for them so workspaces do map we're going to get one space in here and for each of these we're going to render out an option element this is going to have a key and the key is equal to the space. ID and for class name I'm just going to pass this in and for the value I'm going to remove this and say space. ID as well okay there you go now it shows something called workspace because that's the text we're going to remove this and we're going to say space. name next I also have this on form submit function so I'm going to go up here and say on form submit or on submit and I'm going to pass in our new callback function okay now let's go down here and after our separator or after the label sorry we're going to create a bracket here and we're going to say if we are still fetching then we're going to do something here conditionally so first we're going to return a skeleton component so just bring in skeleton from chaty and UI and we're just going to provide some class names on top of this so we're going to say class names withd full height 40 and rounded Excel and then if this is false then we're going to render a label component so essentially we can also change the workspace and the folder so in here we're going to create the other options for all the folders that are available as well okay so first thing is we're going to use a P tag so I'm going to say paragraph f ERS in the in this workspace right like this and I'm going to add some class name here okay and for this I'm going to add the following Flex Flex Das column and I want to add Gap y of two and now inside this after the paragraph I'm going to say is folders so if something exists in here and is folders. length right so if this is true if this is greater than zero then we're going to conditionally render something in here as well so if we have elements we're going to again return a select component okay and we're going to give it a class name rounded DXL BG - transparent and text-base okay and now we also have to use register to register this element so so I'm going to use register like this okay with a spread operator and you want to invoke it and inside that you want to pass in the ID so one more thing in here is because these are different elements we have to provide it for the workspace as well so workspace underscore ID okay nice and I just want to make sure there's no spelling errors and here I'm going to use the other one which is folder ID okay now inside the select element now I can render out the options for these for the folders so is folders. map and for each of these we're going to get access to a folder and the key right so I'm going to Loop over the folders and I'm going to render based on if the key is equal to zero so if key is equal to why is this not letting me type okay so if this key is equal to so zero then we're optionally going to return something else so I'm just going to do this for now and first thing we're going to return here is an option so just to save some time guys I'm just going to copy paste just a little bit and I'll also read it if that helps you okay so we have an option it's going to have class name key and value and we're going to have the name of the option as well inside this okay and if this is not true if this is false then we're going to render this for all other elements other than this key zero okay so here we're rendering out the same thing nothing different and let me also go ahead and open this okay now after this so if we don't have folders then we have to return a message right so we're just going to say there are no folders in here inside a paragraph So if you open this you can see now we have all the different type of folders in here right and I'd actually encourage you to use the shat cnii components I just did not have time and just for you know the sake of getting this video done with I I had to just put this in here okay it was just easier for me so um if you want please go ahead use Shad cnii that should definitely make it look so much better now after this I'm going to hit enter here and I'm going to create a button component and inside this button I'm going to use our loader component and inside this I'm going to say State equal to is pending and the color is going to be hash 00 okay not dollar sign definitely don't want to have that much okay and inside this we can say transfer okay so let's go ahead and quickly test this out so if you click on this right here and if you move this from the prodigies University folder into the client Outreach folder and go ahead and click on transfer it changes the folder and if we click inside the client Outreach folder it's going to show this video in here okay awesome and just to show you if you go back to my library it's going to show you the the folder here that also says one video in here and if you click inside prodigies University you're not going to find it in here as well okay great job guys now the next thing is what happens when you click on this video right so if I click on this it's going to take me into a page right I wanted to navigate somewhere else but because we don't have this page it's going to show a 404 so let's go ahead and set that stuff up uh stuff as well but before that I also want to create some work spaces in here cuz it just looks really empty so what I'm going to do is I'm going to go into my Prisma studio and I'm going to close this and I'm going to click onto click on the user itself right here and inside the user we're going to find a bunch of information right here right we're going to find something called plan let's see so we have trial um let's turn this trial to true for now and we're also going to need to change the plan that the user is on let me see if we have subscription where is the subscription okay subscription in here and in here we have free plan so I'm going to open this in a new tab and I'm going to change the free plan to the Pro Plan okay and I'm going to save this and go to my front end and just quickly refresh and now I can see a bunch of buttons right here so I can create a workspace in here as well but I want to First go into my um let me see if I can go into the create workspace um you know button and then essentially change this cuz I think I did not add that yet okay so inside the create a workspace component which is right here so create workspace index. TSX you're going to find this button here but inside this we forgot to mention create workspace right so you can add that right here so users can um they can pretty much know what they're trying to do when they click on this button I'm also going to zoom in just a little bit more so you guys can see clearly okay so much better now when I click on this modal should popup nice and now it ask me for the workspace name and if I click on this just to see to make sure we have our onsubmit okay nice and this also adds the okay y this also adds it so I'm just going to quickly pass in a workspace okay and I'm going to click on create workspace let's see if everything was successful okay so it says error and it says workspace created so something looks off hm all right so looks like we made an some sort of an error in here let me take a look so go into the create workspace endpoint okay so it worked and I think the reason why it looked like it didn't work is because we probably had cached data cuz I did not refresh the page right so I'll give it a shot once more and if I see it then you know we'll probably have to look into what's going on but let me go ahead and try once one more time okay so so the reason why that was happening is in here we're returning a 2011 response okay and it's actually correct there's nothing wrong here but we could probably make some improvements to our used mutation data hook right so in here we can say if it's equal to 200 or if it's equal to 2011 and we can keep going that way or you can create an array up top and you can say data. status do includes in that array that's another way okay but just for Simplicity sake right here I'm just going to say or data. status is equal to 2011 right then we will show success so let me go ahead and refresh this and try once more so create a workspace okay so I'm going to create a new agency in here um workspace essentially they also put an alert message so I'll just remove that and if I cancel there you go it says success now okay and now you can automatically see the new workspace is added in here great job now one thing I will agree is this part does look a little empty when um we don't have the the upgrade button right so what you could do guys and I would really suggest you do this for your SAS as well which is you need to have a plan to help people at a higher level and what that means is just because you are a SAS doesn't mean you can't sell oneon-one Services we do this in our SAS as well and we we have helped so many other clients so many other SAS business owners pretty much increase their revenue make more money every single month because of this very simple strategy just because someone's using your your software it doesn't mean that it ends there they probably need more assistance they need more help and if you genuinely care about your clients you will probably have a system in place to help them out at a more high level experience right give them a more give them a one-on-one like experience with you so you could have something in here that says want us to handle your client Outreach for example because a lot of people who are going to be customers of opal are going to use this software to reach out to customers right to reach out to clients so in that case you can essentially maybe have like an upsell in here or what we'd like to call more help okay that's a better word so if you want to provide more help to your customers you can have a third tier that is kind of like hidden it's it's not really out there because not everybody should have the ability to work with you right only qualified individuals can can work with you so you can have a you know some sort of an onboarding a preet process all that kind of stuff okay honestly speaking I really like I really like the UI this is so nice if you've noticed I always have dark dark mode themed websites and applications and the reason is simply because I hate light mode and I saw someone in the comments the other day saying can you please use light mode I am sorry I don't care even if you pay me a million dollars I will never do that just because dark mode is in my opinion it's supposed to be an accessibility thing at this point right people hate light mode it hurts your eyes okay with something that is built in dark mode you can use it even if it's dark okay because it doesn't hurt your eye okay if it's light mode it's going to burn your retina anyways okay moving on all right guys so go ahead open up the folders and come on we got to speed up now we've been been on this for a couple hours so I'm going to you know go through this a little faster please keep up the pace okay pause the video and type that's the best way for you to learn all right okay so first thing I'm going to do is I'm going to shrink everything right here okay shrink everything and you want to open up your Source folder and then open up the app folder and inside the app folder we're going to create another route and this route is called the preview route okay this is the route that we can share with other people so they can view these um the videos and essentially whatever was shared with them along with activity and all that kind of stuff okay and inside this you want to create a dynamic route called video ID okay and inside that a page. TSX next go ahead and return a component and rename this to video page or just keep it as page. TSX doesn't really matter okay now we need to get the pams from this right so go in here you're going to say pams or you can do it from here as well so pams like this and we're going to get the video ID which is going to be a string okay and I'm also going to go in here and destructure these so pams and I'm going to get my video ID okay now in here first I'm going to create a query client because we're going to prefetch all the all the video data okay the preview video data so first thing you want to say const query equal new query client go ahead and invoke this and then next thing is you want to prefetch the data so we're going to say prefetch query and since this is an await we need to make this an async component and in here we're going to say prefetch query for this specific query key which is preview video and then the server action is get preview video okay so go ahead copy this name and I'm going to go into my actions folder inside workspaces and going to scroll all the way to the bottom and in here I'm going to say export const get preview video and this is going to need the video ID which is going to be a string so video ID is going to be a string nice what is this not sting string all right next we have to check if the user exists right so let's do that inside a TR catch so in here try catch block and up here I'm going to say const user equal await current US user and change this to an async component if the user does not exist then we're going to return 400 okay then the next thing is we got to create the uh the request to go into our database and get us the video file so we're going to say const await video equal await client. video. find unique for this specific video ID okay so where video ID is equal to this video ID that we passed in then we want to select the following data the first thing we need well there's a bunch that we need so please pause the screen and type this I'm just going to copy this from here and all we need inside this one is as follows so we need the title created at source description processing views summary and the user data right so select first name last name the image the clerk ID trial and their subscription plan as well all right so let me go ahead and quit this I don't know why I open that all right now at the bottom here we're going to say if the video exists so we found a video from the database then we're going to return 200 okay so return 200 we're going to pass in the data in there the author as well and we're going to say author is equal to user ID if this is equal to the clerk ID then we'll return true or false Okay then if something happened wrong we're just going to return a 404 and we'll return a 400 right here or 500 doesn't really matter now I'm going to close this and let's go ahead and import my my server action and the next thing I need to do I hope you remember is we need to wrap our component inside a hydration boundary so go ahead and bring in this hydration boundary and the dehydrate as well so we can pass in the query and in here we don't need to destructure this we just need to pass in the video ID okay and now inside this component we're going to create two things first we need the video preview and then actually I think that's about it because I also want to reuse this video preview components and another file as well right so that's why so inside this what we're going to do is I'm going to go ahead and create the video preview component like this okay and I'm going to copy this name and let's open up the folder structure go into globals so components Global and I'm going to create the video Das preview I think we already have a video file right okay we already have something in here so inside this we can create preview and inside this index. TSX and let's return a component and change this to video preview okay the first prop this component is going to take is the video ID so I'm going to grab the video ID in here and then we're going to need to fetch the data so what do I need to use if I want to get data using query uh react query great hopefully you said use Query data that's exactly what we need so I'm we're going to say cons data equal use Query data and then we also need the get preview video um server action so we can fetch all the video details using this specific video ID okay now let's go back quickly import this component as well and now we can pass in that video ID so let's go up here video ID equal to video ID all right so now I already have this page set up so if I click on it let's see what happens okay we see an error that's because inside the video preview component we are using a hook so this has to change to a use client component okay there we go nice now the next thing is we're going to get router here because if the user um does not have or maybe if we're trying to fetch some data and we're not getting it back something is not true or not authorized then we can re reroute the user right so I'm going to say const router equal to use router this one comes from next navigation not next router and then down here I'm going to say from this data if I received a status that's not equal to 200 then I want to return the user right but before that I also want to type cast some values I'm going to say const data reset it as videos status and the author and I need something here called video props okay not videos video prop so we have to go ahead and create that so go down into your types file inside here and at the bottom you're going to do the following so you're going to say status number data and for this is user first name last name image clerk ID trial subscription and you can also just if you have the GitHub you can just copy paste it from there as well right but pause this video if you don't and you can pretty much just type it out I'm going to go back in here and quickly import my video props okay nice and once I have this data I want to make sure that the status is 200 okay but if it's not I want to Route the user back to the root domain okay to the root page next thing here is I want to get the days ago uh number as well so I'm going to do the same thing in here which is days ago equal math. floor new date. getet time minus when it was created and divided by 26 into 60 into 60 into th000 okay so once I get this now I can essentially render some data out here now there's one more thing I want to do on this page when a user gets access to this page if the person who viewed the page is not the owner or essentially they're not the one who owns this video then we we need to basically update the view counts and we also need to notify the user that someone viewed your video this is super powerful right I have used a strategy and made so much money I can't even explain okay so this strategy is great and this feature itself is a reason why people would might might want to use our software okay so what I'm going to do is I'm going to put a work in progress flag and I'm going to say setup notify first view okay so for now I'm just going to call it like that and down here we're going to need to do the following so first this div is totally fine I'm just going to add a class name so please pause and type this class name because we're running out of time um and then after that inside this we're going to have another div and this div is going to have this class name right here and if you want to know what we are building let me quickly show you we're essentially building this side of the page only this only this part okay this section is not there because we're using the preview page so the preview page is going to look something like this guys I would really really suggest you get the figma file okay you're going to learn so much from this if you have not built or designed you know SAS applications you're going to learn a lot from this okay so I really really suggest you get it but if not I'm just showing you right now so you can see what it looks like so we're just building this basically okay so I'm going to go back to the code and in here the first thing we need is the video title so the video title is going to be inside this right so create another div and inside that we want one more div with the class name Flex Gap X of five item start and justify between okay and inside this we're going to have our H2 so our H2 element like this and that's going to show the video title so let me expand this so you can see video title all right looks awesome and after the video title we want to get the author so who created the the video itself so we're going to say author if the author exists then we're going to give the edit video right here or we're going to show an empty fragment and if you don't know what this is it's totally fine don't worry about it U but you will come to know as we build all right but that's pretty much what we're going to show in here so I'm just going to comment it out for now and then after the div guys right here hit enter and you want to create a span with two paragraphs inside that span okay so span two paragraphs inside it and we're going to essentially show the date of when it was created and we also want to show the user who created the file okay next up here I'm going to also give this margin top of four so we can give some spacing up top there or two also might be better okay two is so much better okay and let me shrink this so you guys can see more and after this we want to render out a video element so after this div right here you want to say video we're going to put preload the metadata for class name we're going to put width full aspect video opacity 50 rounded Excel and we're going to show the controls okay and inside this we need to provide the source so go ahead and render out a source elements and the source is going to have this following ID okay so all of this is going to come from cloudfront remember that's pretty much how we're getting the video Source right so we're going to grab all of that from cloudfront and we're going to also render it with a specific ID okay so video Source just like this hash1 and we need all of this stuff for the video to render so just go ahead put this in here and you can copy this and if you don't have I mean you're going to have it but I'm not going to so I'm just going to go in here and add this to my environment file so I can store it when I need to and let's move on to the next part right after this so after the video file go ahead and create a div right here and then inside this we're going to need one more div so I'm going to create another div inside and now first we need the paragraph to show the description right so we're going to say description in here and then if the user is the author again we're going to do the same thing down here so hit enter if user is the author we're going to show the edit video component if not we're just going to show an empty fragment but for now I'm just going to remove this and down here after this div I'm going to put the video description itself okay so right now I'm just going to show no description because that's the default value and now after this div guys so we have one two two divs right here you want to create another div and inside this div you're going to create another div inside that and please pause and type the class names okay don't expect me me to type it guys it's very difficult and then in here we're going to have the copy link component so let's go ahead and import the copy link component component we need to pass in the video ID and you know anything else whatever components we need to pass in here and then we're going to need another component in here called the rich link okay so go ahead copy this Rich link component and you want to open up your folder structure and let's see where we have our video so video in here we have our links in here right so I'm going to create a file in here called Rich dl. TSX I'm going to return a component and I'm going to rename it to Rich link now the rich link component is going to take a bunch of props I'm going to provide them right now and in here I'm just going to destructure all these values okay nice I think there's one more okay that's pretty much it nice now let's go back and also import this component so rich link let's go ahead and import this one and for the description we're going to essentially use a helper function and this helper function is called truncate string so let's go ahead and grab that as well it's very simple um let's go to the utils file first so Libs utils and at the bottom we're going to say export so export const truncate string we're going to receive the string and slice number and down here we're just going to say string. slice from from zero to whatever number or 30 and then we're just going to add dot dot dot okay or if you want you can also add the circles which I did for the sidebar elements that one works as well okay let's go back in here and I'm going to import the truncate string and then we're going to have the ID and all the other props that this component needs right so I'm just going to pass it in nothing nothing else crazy and inside this component the first thing we need to do is we need to create um a component in here called copy Rich text and this this Rich link is essentially like an embeddable link okay this is super powerful because in emails you can essentially embed the video itself directly in that email and your clients can see what what that video looks like before they even click on it right even more powerful you can take this to a whole different level and you can change this into a gif and that way your client will see exactly what the video is cuz it's going to play right gif's play inside an email so for now we need to create this Rich Text template and just please follow through with me okay so first thing is I'm going to say const Rich text like this copy R text and this is actually a call back right it's it's essentially a Handler and down here we're going to have the button that's going to help us copy this so first I'll say button like this and I'm going to import this button in here and inside this I'm going to say get embed code okay and in here I need the on click hand Handler so the onclick Handler is going to be the copy Rich text that we just created and this um I don't like that I put a capital letter here let me put a small letter and after this we want to also have a class name set to rounded D full all right nice so there you go now it says get embed code okay now in here first thing we're going to do is we're going to get the original title so I'm going to say const original title equal to the title that's passed in from the props next we have to create a thumbnail right so I'm going to say const thumbnail equal to this is a uh we're going to use back tis in here and please just if you have the GitHub open the GitHub and copy the section because I don't want you to waste your precious time okay but essentially it's just an anchor tag that's going to have some stuff on it like H3 a paragraph like the description and all that kind of stuff right so that's pretty much it so I'm going to copy this so I don't waste my time as well and essentially it's just this okay it's just a template so please go to the GitHub and copy it if you have access if not pause this video and type it out all right anyway so that's it and after this inside this we're just rendering out all of this data right which is the original title and the description as well and we're just rendering this out so we can embed it okay that's pretty much it next we're going to need a thumbnail so ins inside this or right after this anchor tag you're going to say thumbnail blob and that's equal to new blob and you're going to pass in the thumbnail right here pass it in here and the type is text and HTML all right next we need the blob title so we're going to say blog title is new blog and inside that we have to pass in the original title and we're going to say text plane all right next we need uh an object sorry we need an array called Data okay and this data is going to create a new clipboard item and it's going to copy all of this stuff along with The Blob information okay that way we can paste it kind of like an embeddable uh like an embed itself all right so down here we're going to say con data equal new clipboard item and it create an object and for text plane that means this one we're going to pass in the blob title and for text HTML we're going to pass in the thumbnail itself now we need to do the Navigator docboard dright right so Navigator docboard dright this this data do then we're going to show a toast from sonar and we're going to say embed link copied so if I get this I'm going to get all of this data and right now it's going to it's just going to show like this let's see what happened something happened here oh that was just because I pasted it in here sorry about that so if I get the embeddable link I can essentially paste this wherever I want because it's it's all of this data okay okay so I just pasted it inside an email and as you can see it put a link with you know with the elements the h2 tag and all that kind of stuff the only reason why we don't have the video is because nothing is being rendered right so nothing's going to work for now because we don't even have the API um sorry the endpoints itself right so because of that nothing is going to show but I just want to show you what it does itself right so this is pretty much what it does you see it's putting the entire thing as an embed inside your inside your Gmail okay so let's go back and I'm going to shrink this page all right and now I'm going to go back to our what is this the preview page and just make sure everything is imported all right nice and after this I'm going to have a download button okay just for it to look nicer really doesn't really matter right it's just a download button you can change the color if you like probably want to fix this as well so this is justify content items Center okay that's much better and I'm going to also change the class name to something a little darker okay so something like this looks much better all right nice so you can also download the file if you'd like all right and it's not too difficult to do that I'll I'll show you how to do that later or maybe uh okay we'll just do it later guys it's not important right now we don't even need it as part of the you know the feature of the app right okay so now after this um down here we have a div here and one more down down here sorry right below this one not the second one right below this you're going to create another div and inside this div we're going to create a tab menu okay so tab menu which will never show up okay so instead of doing the tab menu I'll create a custom component and I'll put the tab menu inside that okay so go into forms and I'm going to create a component in here this is called tabs and inside this an index. TSX and I'm going to say export const tab menu equal to an aror function and first thing is this component or let me let me actually do it this way okay so first thing is we're going to need some props in here so the first props are the triggers the children and the default value okay the triggers are a bunch of it's an array of strings and children again you know react node and the default values string as well so let's go ahead and import uh destructure all of these from the prop so we can use them and next in here I'm going to render out a tabs component and this tabs component is going to have the default value not default check sorry default value and this default value is going to be set to the default value we just got in and the class name is going to be set to with of full all right let's go to that one more time okay nice and inside this we now need to have our tabs list so tabs list component is going to have the following class name so Flex justify start BG of transparent and what seems to be the issue we need to import this component so I'm going to go in here and I'm going to import the tabs menu component component and I'm also going to pass in the three different um triggers that I need so first one is default value I'm just going to call this all and triggers are going to have a bunch in here so first one is all of course second one is summary and the third one is activity okay so I'm going to pass in three and if I expand this okay let's Al refresh all right let's move back here cool and this is going to need some children components inside this so for now I'm just going to create something in here okay so let's go back to the tabs menu and for the tabs list we have to return a tab trigger right so inside this trigger inside the list itself we're going to say triggers do map for each of these we want to return a tabs trigger component okay if it will it will allow me then I can do it but I don't think it wants to all right there we go man next just really hates me man all right um so the first thing is in here we're going to get the trigger so let's grab that value and we're also going to get the key itself so first pass in the key you guys know the drill so the key is going to be the actually you should never do this guys you should probably pass in the trigger this is much better let's not use the key okay next we need the value and the value is going to be set to trigger like this and the next thing we need is the class name and for class name I'm just going to capitalize everything say text base data State active we're going to change the background color okay and now inside the tabs trigger we're going to pass in the trigger itself so let's see what this looks like hey look at that really nice right so you can switch between these and any tab content that you have rendering for that specific trigger is going to show up down below okay so first let's also return the children components and let's go back into this right here and for this we need to have the um first we need to have the values for the content right so let's go ahead and render that out so first thing is I want to change this uh the titles guys I'm going to call this AI tools okay and in here I'm going to call this transcript and finally this one can be the activity tab that's fine all right so the AI tools is essentially all the stuff we get like um taking the title creating a title the description and you know pretty much U anything that we're trying to do AI related okay but one of the AI features is going to be inside transcript which is uh essentially getting the the transcript of the video so users can also take that and you know pretty much do whatever they want with it right I think having a transcript is insanely powerful and the reason is because you can leverage that transcript to create content right so and I have other ideas uh as to how to use a transcript like for example imagine you had a chat bot that could speak to your entire uh video right they can ask it questions and stuff we would need a transcript for that because because we can take the transcript we can feed it directly into a knowledge base and the knowledge base will have the uh answers to any questions that the users ask on that video super super powerful right anyway okay so the first thing that I will build right here is the AI tools so I'm going to go in here and I'm going to say AI tools like this it's a new component of course so let's go ahead and copy this and right now we're not going to be jumping into wiring up whisper AI or open AI or anything like that we just want to create a uh like a mockup right just the uh the layouts and then we'll come back to it to wire up the back end or anything else we need to do all right so once we have these AI the AI tools component go down into your Global folder I'm going to say AI tools. TS sorry not. TSX it's just this and inside that we'll create an index. TSX and this component is going to again um I'm just going to render something in here and I'm going to call it AI tools so this needs the plan first and the plan has to be Pro Plan or free plan right and after this we're going to have the trial which is a Boolean property and then we're going to have video ID which is a string so what is trial so we want to also give the user the ability to essentially use one of the AI features just once okay to kind of get a glimpse of what it can do that's the main reason and for that reason the best way to do it is just using something called trial all right so this is not trial for their subscription okay there's there's no trial really they only have free tier and pro tier but there there's no trial okay the only trial here is for using the AI tools okay so I just went ahead and I'm destructuring all these values as well um just give me one second okay all right and after destructuring here down here we're going to render out the tab's content okay and I think default value all means it's not going to work right we want to select the AI tools as the default value and then it should select that one as the first one okay nice now it's selecting right great um why is this not shrinking Let me refresh okay it's cuz the video was taking the whole screen all right so going back into our AI tools component I'm going to remove this and I'm going to return a tabs content component like this and inside this I'm going to give it the value and this value is going to be the AI tools okay next inside this we're going to give it the following class name so I'm going to hit enter here and I'm going to say padding five uh just pause and type this class name okay and if you want to know what we're building here um let me see if I can show you so we're building something similar to this okay it's not going to be exactly like this but something similar so we can you know at least have options where we can pretty much click and you know generate summary and titles and things like that okay so it's going to look somewhat like this not exactly like this okay so let's go back to our component and in here first thing is we're going to have a div and we're going to need a div inside this as well and this div is going to have width Set uh class name what what is this okay class name and in here we're going to be it's going to be with 8x2 and inside this create an H2 tag with the class name text of 3 Excel font Das bold and in here we're going to say AI tools okay just like that nice and after this H2 we're going to have a paragraph tag in here called take your video to the next level or the next step with the power of AI okay power of AI sounds better all right nice then after this we want to essentially look at the tier that they have and then depending on that we want to return a button okay so please follow through with me so after this div down here we're going to say plan if it's equal to free then we're going to do something here like this or we'll do something else right here so if it is equal to free then we want to make sure they're not on the trial okay and if they're not on the trial again we're going to return something here or we'll return another condition so if they are not on the trial then we're going to return a button component okay from components and in here we're going to say class name and set this to with of 4 by 12 okay margin top of two text - smm okay and inside this button we're going to essentially render out a loader that says try now okay it's a loader and uh inside that we are going to have try now right so let's import our loader component and for state is pending we're not going to have this right now so I'm just going to set it to false and let's go up top and I'm going to say work in progress and we need to set up the AI why did a not show up okay the AI uh AI hook okay so we're going to set it just like that and just for now I'll also maybe just remove this so we can see what it looks like Okay cool so we have a button that says try now like this and after this button I'm also going to um I might also want to render out a button for users to pay right so let me see what I can do for that or maybe I'll just create another button down below for now and I'll call this pay and I'll just hide this comment if it'll allow me to okay pay button so work in progress pay button okay and we're just going to have a pay now or something like this okay we'll figure out what to put in there all right looks great and I also noticed there's no gap between these elements which looks really bad so I'll go up here and I'll create another uh maybe like a div and I'll move all these buttons into this div okay and I'm going to set it to class name Flex items Center justify between gap of four if we need okay we don't need a gap really um let's just say justify between and see what happens okay for width we'll remove the width okay that looks decent okay nice now if we grow and Shrink that tab looks so much better and we can give this a gap of four okay nice now maybe for the pay button we can give it some different styles maybe we can call the variant and maybe I'll just give it secondary something like this right looks great awesome now after this button down here we're also going to have another button called generate now so I'm going to copy this same button here where is this copy this button and after this uh div so right here we have a div right after this I'm going to show another button that says generate now okay something like this and this is essentially going to help us generate the AI transcripts or whatever that whatever tool we're essentially clicking on right or maybe we can just put this button inside this guys why do we need it here right so let me drag this and put it in here so generate now okay looks nice and this is so let me just tell you why we need the button so first we needed to generate AI features but we're using this button only if they're not on the free tier okay so if they have a paid tier then this button will apply all right okay cool so next I'm going to scroll down here after this div I'm going to create another div and give it the class name of flex justify between okay and inside this we'll create another div and we'll give this a class name as well we'll set this to flex Flex D column items D Center and then we need text- Center as well we need text at a different color so please pause and type the color with me okay and then I'm going to set this to Gap y of two and then text of SM I made a mistake here so let me just fix this Y 2 text SM and this should be good to go and inside this I'm going to use my video recorder duone icon so I'm going to import the duone icon like this and I'm going to set the width and set this one equal to 36 and the height and the height will be equal to 36 as well okay so let's just take a look and see what that looks like it kind of looks horrible and I will see how I can fix the design but let me just get some stuff up and going first and then we'll get to that so I'm going to say generate video summary for example okay and then I'm going to have some more buttons in here uh one is going to be the create and read video button so right after this div I'm going to create another one for create and read video and then download icon okay again this is just for uh design sake doesn't really matter so I'm just going to import something in here and let's refresh okay looks great but I'm going to need to fix the UI looks like something is wrong here so let me quickly fix that as well all so I just made some changes here and this makes it stand out a little bit more and all I did here for the AI tools was I just set um a element here and I gave it a background color and I just created one div on top to essentially you know handle this part right and then I created a div to wrap all these elements so one div for this one div for this and one for this I had a left div and a right div okay left if right div same thing and I just use flexbox so you can pause the screen and you can type this out or you can try to take it up as a challenge and try to build something that looks similar to this or just use your own design skills that's fine as well or you can just copy it from GitHub okay so now I'm going to save us some time I'm just going to go back real quick this essentially does not do anything so it's just styling right so it doesn't matter too much just get something in for now okay so now right below this I'm going to have another component called video transcript okay and this video transcript comp component is going to have the transcript prop right here and this transcript prop is going to get the video description we're just going to pass that into it so open up your folder structure create a folder inside your Global components called vide transcript and create an index. TSX and in here we're going to need the transcript as the as the prop right it's a string and I'm also going to destructure it in here and then I want to create a tab content element that goes right in here and this is going to have the um the value set to transcript and for now all we need to do is render out a paragraph in here that will show the transcript okay and right now we have no description so it's just going to say no description all right cool that's pretty much it also I realized this weird bug here and I don't know where this is coming from it's just something CSS related I see this thing at the bottom and I don't know where it's coming from but if I turn off one of this it goes away and if I turn off one of this it still shows so is it this like I'm really confused if it's if it's the video transcript what seems to be wrong inside the video transcript like I really don't know what's what's wrong here it's still a tab content and I imported it from the right folder and H just not sure what's going on but it just looks like a bug because I'm able to also kind of swap between elements right so something just seems off maybe you guys can take a look at it and let me know what's going on but I'm not too bothered about it I mean it's still working the way it's intended to right but anyway yeah this is this is annoying me now actually whatever guys all right so I just take a look at it see what's going on there all right so let's go back now and after this we're going to need an activity panel and this is where users can essentially comment on the video okay so for now I'm just going to create something in here uh with the value activity okay and I'm going to get back to this later cuz I need to set up some stuff before that so I'm going to say Activity Set up activity okay like this nice we have a lot of work in progress Flags so I'll also take a look at that and just keep a keep an eye on it to make sure we're not Crossing too many but I think so far this should be good to go so I'm going to take a moment to quickly solve all our work in progress Flags because we have a bunch right the first one and the way to actually do this is hit command shift F on Mac I'm sorry I can't really help Windows people okay and in here you're going to look for work and progress like this and I'm just going to select these two all right or you don't even need to it's fine it's going to give you all different options and the first one is AI hook this is okay uh add loading States I see this inside folder and if you scroll down inside is uh inside the loader we have to pass in the is pending right so you can do that and then you can remove this nice then we have uh wire up invitations this is fine the invite button that's okay as well and then we have the upgrade button this is going to need stripe we're not in stripe yet uh videos logic of course we haven't or have we actually done the videos Logic Let me just take a quick look I think we're good to go on this one so I can just remove this work in progress flag right here okay and then we have wire up date this one is done as well cuz we already completed that upgrade button notify I first view we'll get to this in a second and set up activity we'll also have to get to this so I think everything else looks good let me just make sure one more time all right good job guys all right guys now before we move forward I just want to give a big shout out to stream who's also the sponsor of today's video now stream gives you access to a bunch of really cool apis that can allow you to pretty much speed up your web development process or your SAS development process now stream is essentially the foundation for realtime inapp experiences so whether you're building chats or activity feeds or even video calling features inside your application streams apis and sdks are built for this so they're built for developers who pretty much need reliable High Performance Tools that can scale so stream now Powers over a billion users across apps that are developed by SAS developers just like yourself at the moment they offer three different type of apis that you can leverage and you can use this inside opal guys you could literally offer more value to your clients or even if you have another SAS application you can leverage streams features and go live much faster than if you needed to build all of these applications from start to finish right so these features will definitely take a very long time I mean you guys can see how long it took us just to wire up authentication this is going to take you even longer than that because it's real-time support and everything scales so first you can leverage the chat API if you want something that's fast customizable and scalable right and streams chat API supports messaging for social apps collaboration tools live streams and so much more now they also offer sdks for different type of programming languages so if you're using Swift cotlin or react native and there's more of course but if you're using different languages you can use the same API so what you get is essentially a pre-built component that is fully flexible so you can customize it and it's also scalable and on top of that it's tested that means you don't have to spend time building and then testing everything and I'm sure you want to spend more time towards just building the application in general and getting your product out there as fast as possible so they can handle all of the workload for you that way you don't have to focus on building something that's scales now their chat API also handles one-on-one conversations group and Community chats but the coolest thing is it also has a buil-in moderation for safety now the next awesome feature is the videos API so if you're looking to build realtime video and audio experiences they have a solution for you okay because their solution their API is optimized for low latency and high quality calls so everything is going to feel premium so you can use this feature inside opal as well let's let's say if the prospect wants to also communicate with the business owner you could have something like this in here or let's say if you wanted to host probably webinars I think that's a really cool idea what if business owners can host webinars inside opal and you can also use the chat feature where users can text in real time you know ask questions and I think this is a great opportunity for marketers to also leverage in their SAS as well with the video's API whether you're building one-on-one chats or one-on-one video calls or even large group conferences stream offers flexible Solutions with Advanced features so you can leverage them inside your application for pretty much any you know given situation right they also have picture and picture and custom reactions which I mean you can literally build whatever you like right so I think their videos API and their video streaming capabilities is going to be very helpful for your SAS application if you want to get things out as fast as possible and you don't want to care for you know building a scalable back end or building the front end and testing everything and all that kind of stuff now the next feature is the feeds API and I hope you remember we're also building an activity tab inside our application now if you want this activity tab to scale you're going to need to have a backend system that can handle real-time data so for example let's go back to our webinar experience so if you have have 50 or 60,000 people who are watching a webinar all at once chatting at the same time you're going to need to build a backend that can scale with this component so the feeds API essentially gives you the ability to not only do this but they also give you realtime features so everyone can see what's happening inside that webinar so Under the Hood stream uses go and rocks DB so essentially they save your data and optimize it so it's fast and consistent regardless of the load now my favorite part of streams sdks and apis is they follow a developer first experience which means it's flexible it's performant and it's made to be easy to understand okay you can integrate it into pretty much any stack of your choice and you can customize all the UI components and you can rely on clear and detailed documentation so they show you how everything works and it's step by step now stream supports any Tex stack so so you can use it in this project as well you can use it in opal in grupal in you know plura or any of the applications that we have created on web prodigies and it's going to work because stream supports any Tech stack of your choice and of course guys this doesn't only work for web applications it's also for Native applications as well so I think how stream makes this possible is they probably built everything on the edge Network right so essentially they have multiple Global points which give you access to their apis and it's almost instantaneous that your users don't feel the delay at all and this pretty much gives you like 99.999% uptime all right so handling millions of concurrent Connections in a single channel is not going to be a problem with stream and streams architecture is designed for this it's designed for highs scale low latency because real time should always be in real time right you don't want real time to be 5 seconds from now and of course they also have security bakon with compliance to S SO2 gdpr and hippo compliance standards so they essentially offer you the endtoend encryption experience and all your data Frameworks can trust them right but yeah if you're ready to start and you want to use stream API for this project it's completely free to get started there's a link down in the description you can click that link and it's going to take you into getstream.io where you can essentially leverage any of the apis that you want for groupal or any of the projects that we built okay all right now I'd like for you to take up a challenge now of course if you don't know how to do this I will show you exactly how to do it but I want you to also render out the component which is the video component that we just created inside our dashboard as well because right now we only Built the preview version that means when we share a link to someone else they will see the preview version and not the dashboard version because they're not logged in so I'd like for you to try to render the same component inside the videos route so just to give you some context as well you would want to create a folder called video inside workspace ID and inside that you want to create the video ID and ap. TSX and our video component s should essentially load inside this page. TSX okay so go ahead pause this video and give it a shot and if you don't know how to do it I will show you exactly how to get this answer all right awesome hopefully you got the right answer if not this is exactly what you need to do now the first thing is you're going to notice the video ID is also getting getting printed in here and that's a little Annoying I get it and you could essentially go into the global header and you could change that if you'd like but for now I'm just going to keep it in here okay because it shows the video ID and I can also copy this anytime I want so I thought maybe it might be useful all right but essentially all you have to do is first you want to go down to your preview page. TSX just copy everything in here then you want to go into your workspace ID right here dashboard workspace ID create a folder called video and inside that you want to create the video ID uh Dynamic folder and inside that Dynamic folder you're going to create the page. TSX okay now that's pretty much it you don't really have to do anything else crazy um the only other change I made was there there used to be some padding and um I just removed it okay so I removed the padding of X which was 10 or 20 and that created some weird indent so I've removed that and it sort of fixed a lot of the problems okay so you can remove that if you would like I just removed it so it looks uh better but if not no worries and that's it so now you're rendering this component inside the dashboard itself now there's one more change you need to make and that change is when the user clicks on the video itself right because right now if let's say I clicked on this video it's taking me into this that's because I made the change but for you it's going to take you into the preview page so what you would need to do for that is first you need to scroll down into your video card component so I'm going to search for video I'm going to go to video card. TSX and down here you're going to find a preview slprs ID right props.for ID SLV video slprs ID so when the user clicks on this video uh on the video itself it's going to take them into the video not the preview link okay hope that makes sense and that's pretty much it okay so hopefully you made this change and great job to you if you got the right answer the next thing I'm going to do here is I'm going to shrink everything going to go into Source into app into dashboard and I'm going to create uh inside the workspace ID I'm going to create the billing page okay page. TSX I'm not going to go crazy in this page but if you want you can take a look at the design file the figma mockup and I put some really really nice designs in there so you can translate that if you want into um your application okay but for now I'm just going to call this billing page like this and this billing page is we're first going to need to get the payment information of the user of course we don't have this setup but um all we need to do is just essentially get their subscription plan that's it so we can technically still make this work so go into user and at the bottom we're going to say export const get payment info which is going to be an arrow function and in this all we're going to do is we're going to look at the current user that's logged in so first we're going to say try catch and on top here we're going to first get the current user and then if the user does not exist we'll return 4 404 and also change this to an async function because we're using await here and then we're going to get the payment from the database so we're going to say users. find unique okay so we're going to say const users. find unique for uh so sorry and await client. user. find unique and then inside this we're going to say for the clerk ID so where the clerk ID is of type ID and what do we want to select sorry guys this is user. ID not just ID and we want to select the following information we want their subscription we want to select the plan info all right and we're going to set this to true so that's how we get the plan info and then down here if we received everything we're going to return 200 and return the the data but if something went wrong we'll return 404 or 400 sorry okay now let's go back and inside this component I'm going to first get the payment info of the customer so I'm going to say get payment info and we need to change this component to an async components as well and now that we have this data we can render it out okay so first this div right here the first div you see is going to have the following class name so I'm going to say class name and let me just copy this cuz it's not too big but I don't want to type in make spelling errors but just go ahead and type in this class name to give it some styling and let's also try to navigate into our billing page so let's go into billing okay awesome it took us to the billing page and I see something is wrong here what seems to be the problem let me just take a quick look guys just give me a second okay so the problem here is inside our Global header component which is under the globals folder right here we're essentially getting the first element and the first element is going to be the backslash right so we're going to need to change that to the first element so we're getting the second one technically and then we need to start from the second element onward so from the from 0 1 two okay so this is zero this is one this is two so essentially starting from later on and that way we're able to remove the backslash and also capitalize the first character okay so let me go back and make sure library is working fine now this should work good all right and if I go to the homepage I'm not going to have anything I think it's just going to throw an error okay it's going to throw an error that's fine but um what other okay we don't really have any other Pages other than the folder so let me try to click on folder okay it says my library this is fine and it shows a folder name okay cool awesome all right so now let's go back to our building page and I'm going to close this here and now we can essentially continue from this section okay so inside the Billings page first thing is I'm going to have a div with an H2 and a paragraph So div H2 paragraph it's going to be text to excel it's going to say current plan and in here we're going to say your payment billing okay what seems to be the issue here why is it still showing okay it was just taking some time to reload and next we need to have another div that shows a subscription plan along with the name of the plan okay so down here I'm just going to say div H2 and paragraph again so in here I'm just going to show the plan that they're on and right now this user is on a Pro Plan right because I already upgraded them uh through the schema right sorry not through the schema but through uh through Prisma so because of that they're just automatically upgraded that way we're able to see all these features but right here I'm just going to say $99 or 0 per month and down here I say standard subscription of course please feel free to change this if you'd like um you can also you know render out exactly what their plan is so free plan or Pro Plan that might probably be better right so let's go ahead copy this information and I'm going to render payment dot the plan itself okay so Pro Plan like this okay nice this probably looks good um or you can just keep it like this I think the plan just makes it look weird all right nice that's it very simple you don't have to go crazy and overboard but if you take a look at the figma mockups which you can grab from the description I gave some really nice designs so you can use that and you can pretty much make that production ready right all right so now that the billing page is done let me see if I can create any more pages here okay let's create the notifications page so I'm going to say notifications like this and inside that I'm going to create our page. TSX and in here let's return something and call this notifications all right awesome and inside this first we're going to need to get some data right so we're going to need to use usequery data and of course this is going to become a client component so I'm going to say use uh use Query data and I'm going to get all this data from here or maybe I can try to just use the query client and try to prefetch the queries here so here's what I'm going to do guys so first thing is I'm going to create I'm going to import the server action get notifications then in here I'm going to say query equal new query client that way we don't have to make this a client component and then I'm going to say await query. prefetch queries user notifications okay and down here we're going to say query function get notifications and we're going to we don't even have to invoke this we can just remove this because it's a function right we can just pass the function itself and now uh we can I think we might be able to will prefetch query actually return anything let me just take a look all right so I think inside our code we're actually prefetching let me take a look so user notifications okay we're actually prefetching that guys we don't need to prefetch again so it does make more sense to just use use Query data okay I hope you understood why we're doing this and if you don't know the reason is because we already prefetched the data right so if we do make this call we're going to instantly get the data it's not going to take time to load anything so we're uh we're okay with changing this to a client component okay so I'm going to say use clients all right and essentially use Query data and this one's user notifications and we're just going to pass in the same callback function in here okay now the next thing is I want to do the same type casting and I also want to rename some stuff so down here I'm going to say const data as notifications okay and I'm going to provide the status like this and this is going to be equal to notifications and this is going to be uh typ cast it as the following so please type this with me so first we're going to say status is number and the data is an object and it's going to be uh inside this we're going to have notifications and that's going to be an array of this object which is ID user ID and content okay that's pretty much it so it looks like we have some uh something okay just remove this s here and this is the notification and this is notifications okay cool now if status is equal is not equal to 200 so something happened with this so if status is not equal to 200 then we're going to return a div okay and this div is going to have the class name Flex Also let's go to the notifications page so we can see what's going on all right let's just give that a second to spin up okay so of course we can't make this a client component right so I mean we can't do async here so let's remove that and let's refresh all right nice so um let's go back I don't know why it sent me back to billing all right so down here this is going to be Flex justify center items Center and then height of full and then width of full as well okay and inside this we're going to create a P tag and we're going to say no notifications okay all right awesome there we go now if there were no notifications then we have to show something right so what are we going to show well first we're going to create a div here we're going to set it to flex and flex of column then we're going to Loop over all of our notifications so over this one right here notification we're going to Loop over that and we're going to grab notification from there and we're going to say map and for each of them return a div and for that div we're going to return an avatar okay so I'm going to say Avatar Avatar fall back the user I if nothing exist and then down here I'm just going to say the content so what is the message of the notification and if you want to see what this looks like it's going to look something very similar to this one right here where is that there we go okay so we're going to have notifications just like this all right you can do much more advanced stuff like have the date time all that kind of stuff no problem but this is the basic this this is pretty much the basic of what you need right the base of what you need okay nice so the next page that we're going to be building is the settings page so open up your folder structure create a folder called settings and inside that create a page. TSX Now using tsrce I'm just going to return settings page like this and I'm going to rename it to settings page okay don't worry what you're I mean what you see right here I'll explain in a second but just do as I say for now okay now once this is done go into your Prisma schema and just I mean just make sure cross check that you have first view Boolean and it's set to false okay cuz initially I had it set to true so just make sure it's set to false so what is this feature if you were sending videos to your clients wouldn't you like it if you had a notification being sent to you saying someone just viewed your video right that would be great so this feature essentially allows us to keep track of the first person who views the video and all the user has to do is go in here and turn on this switch component and that essentially will turn on this feature for every video in their in their dashboard okay so the first thing is we're going to create a state here so I'm going to shrink everything so it doesn't confuse you too much we're going to create a state called first View and set first view as well and this is use state in here and the default types are undefined or Boolean so I'm going to pass an undefined right in here and the reason is because the way shats and UI has switches setup is horrible I hate it all right I wish they get to change this hopefully sometime in the future but that's the first thing okay you want to create a state now don't worry about this theme it's just a bonus stuff just some bonus stuff that I put in here in case you want to add it for into your application and I'll give you some instructions on how you can use this as well so the first thing is when we load this component I want to create a use effect that will fetch the data that will fetch information whether this component has to be on or off okay whether the user turned this feature on or off by default so we're going to have a function here called Fetch data it's going to be an async function and we're going to invoke this function down here immediately inside of use effect now next thing we want to do is we're going to pass in the first view in here okay and if the first view is not equal to undefined we also want to return right because we don't want to always keep fetching information what seems to be the issue here let me just take a look sorry guys it's not equal to undefined then we'll return so what this means is if the user has already fetched the information then we don't want to refetch again okay so if I refetch let's say if I refresh like this it's going to make one call in the beginning and it's going to populate this value because we're fetching data and after that if I'm changing it here based on what's In inside this dependency array it's not going to refetch every single time so that's why I'm returning it right here and that's why this undefined is going to help me okay hope that makes sense so what are we doing in here very simple we have a server action called get first view so let's go ahead and create that so inside your users. typescript inside actions you want to create this function called export const get first view it's an acing function and this function has a tri catch block and inside the try first we're going to get the current U user once we get the current user if the user doesn't exist send a status of 404 saying error uh I mean an error took place right then if the user does exist we're going to go into our user table where the user's clerk ID is the same as the user that's logged in and then we want to select the first View and return it back so that way we can tell whether the user had this option turn on or off now if we got data we'll return 200 along with that data okay that's it and then here return 400 if everything's wrong you guys know this I'm not going to explain that stuff okay so going back in here that's all we're doing we're making the call then if the response is 200 we're going to set first view to response.data so if it's true it'll immediately set it so if I refresh because it's false right now it's turning it to the false option if it was true and if I refresh it's going to turn it to the true option okay awesome so let me quickly just undo this nice and let me refresh cool so I hope that makes sense that's pretty much all we're doing in there okay now when we first load we want to turn this off okay we want to turn this off because it's going to take some time to render that out right so first thing we're going to return is an H2 tag for the for the title here I'm just going to call it video sharing settings and a paragraph tag for this detail and then we're going to have the label and the switch okay this switch component is going to need to have that option in there which is disabled if first view is equal to undefined so when we're first spinning this up uh when you're first spinning this up not off first spinning this up if you look at it it's going to be gray out let me see if I can zoom in a little bit more okay you see when I refresh it's grade out right and I can see the um the um disa disabled cursor right that's basically what you want now once the user changes this so if they click on this then we want to only use this value nothing else so this state that was used in here so this one okay so how do we do that on check change has to be set to switch State okay and switch state is a call back function so when the user changes something we want to essentially get some value right we want to fetch information and then when the user clicks on this you can set first view to um to the opposite of what we have stored or you can do the same thing inside set on check change right but the reason why actually we can't do that guy sorry about that so when we first load right when we first load if we are fetching information right here if you first load this gets invoked once so that's why I'm not going to do this onclick stuff inside this as well because if it gets fetched once it's going to immediately reverse what I have stored okay so oncheck change is going to be a a call back function let's leave that for now I'll get to that in a second disabled is going to say first view equal undefined and checked is going to be first view okay so based on the state we're going to have this on or off that's pretty much it now on click here is essentially when the user clicks on this we're going to turn this off that's it okay now let's go all the way up here now let's look at the switch State all we're doing is we're making another server action called enable first View and we're passing in the value the checked value that is stored inside the switch State uh switch component and if we got a response we'll just show a toast message that's literally it okay so let's go into enable first view all we're doing is we have a TR catch we're getting the user info if user doesn't exist return 44 then we're going to go into user and we're going to update the uh for this specific user where the clerk ID is like the user ID and then we're going to change first view to the state that we just passed in and that's it just return 200 back okay that's literally it and now this works amazing so if you refresh you see it takes a second to load but it has the data so here's a challenge for you you don't have to do it right now but something you can maybe keep for later I want you to improve the user experience right now when we get data we're doing it client side which means it's going to take some time you can either have a loading state that looks slightly better or what you could do is you could pre-render all of this data pull that data and then load it immediately in here so because this is a client component and this component down here the switch component is a client component I need to change this to a use client component right so because of that we have to Al fetch data client side so see if you can figure out a way to improve the performance and maybe improve the use experience just a little bit more but that's not the Focus right the focus is to get maximum value out of this feature now I also added a bonus feature in here called use themes and you will get this of course when if you're getting the license or you're just purchasing or just getting the GitHub uh repository to take a look at the code you will get access to this all right essentially it is a theme creator where let me see if I can turn this on and you're going to have three different type of themes okay which is system mode light mode and dark mode so you can use this to toggle between them okay looks really nice and looks per professional as well so that's why I just put that in there we actually use that in one of our past projects so you can use that for this video okay for this project as well all right cool now next thing we want to do is now that we have this turned on let's see if I can complete maybe the activities tab right so let's go into my library okay so this is our video file file looks great but we need to change the activities tab right so first thing is I'm going to go into my Prisma schema and I want to add a property now I think you will not need to do this CU you would probably I mean if you copied it from the GitHub you're probably not going to have this problem right but we need to add comment which is going to have another model called comments okay and it's an array of this comment so let's go ahead and create that comment model as well the comment model is going to look like this right below here so going to have ID the comment itself created at let me bring this all the way down we're going to have reply which is a nested comment so a reply can have a bunch of comments in it as well right and then we want to have the comment this one is essentially just relation stuff and the common ID that we're speaking about and then this is also attached to a user so we're going to have user and user ID and then we're going to have video and video ID because the comments are going to be for a video right and then that's it and then the created ad you guys already know about it so let's go back and now that we have that we have to open up our terminal and we want to say bun X Prisma generate going ahead enter and then bun X Prisma DB push okay there we go all right I think I made a spelling error just one second okay it's bun X Prisma space DB space push okay so once that's that's done now all of our schemas will have that value okay next next thing we need to do is we're going to create a component in here called activities okay and I'm going to copy this name okay and we're going to open up the folder structure and let's go ahead and build out this component so inside the preview tab you can create or where wherever we have the video transcript okay we have a separate component for that so I'll create another component in here called activities okay and inside that an index. TSX let's return a component and I'm going to change this to activities now this is going to need first the author and the video ID so I'm going to grab those props and I also need to destructure these props from here okay nice and once this is done let's go back and also make sure we import this component so inside index. TSX I'm going to import activities component like this nice now this component is going to need those props so let's go ahead and pass in those props first so we're going going to say workspace ID sorry guys not workspace ID let me see what we need the author is going to be the following it's going to be video. user. first name and we're just going to set that as string and then next we need the video ID itself so I'm just passing that in in here okay now if I click on the activities tab I should see the activities panel in the um at the bottom now click on activities and this is going to need the tabs content component so let's remove this and render a tab tabs content component and let's import this component as well and I'm going to change this to activity so now if I click on this it's going to show up you see this is really weird it's create it's creating a container for for each element and I have no clue why it's doing this but it's it's really bothering me hm or maybe that's how it works I don't think so right is that how it works guys I don't know anyway I don't really care because it does the job so I'm happy anyway so let's go into this component and the first one is we're going to create a comment form right we need the input field so we're going to need a comment form and then we're going to Loop over all comments and render out a comment card so two sections so first let's go ahead and say comment form okay just like this and let's go ahead and build this common form so copy this Title Here open up your folder structure and in here I'm going to say comment Dash actually inside forms I'm going to create a folder and say comment Das form and inside this index. TSX and schema. typescript so inside my index file let's quickly return a component and I'm going to rename it to comment form and then I'm also going to go ahead and build out my schema so for the comment form we're only going to have the comment which is a string right so I'm going to first import Zod so import Z from Zod and next I'm going to export const create common schema which is going to be Z doob and we need to provide comment which is z. string. minimum of one character and the message is comment cannot be empty so let's go back and also import the comment form component first okay awesome this is inside activities and inside this now we can pretty much build out the comment form itself I hope you guys remember in order to create a form first we're going to need to use the use Zod form hook right now we also need a bunch of other stuff like the video ID the comment ID and whatever we're trying to like we also need the is pending States right errors and all that kind of stuff so the best way to do this is because we're going to need react query and all of this let's put it into a hook okay so scroll down here and I'm going to create a hook called use video comment so down here use video okay and inside this I'm just going to call it use videos video sorry guys so use video. typescript okay now I'm going to export H use video comment and this is going to be an aror function all right nice and this aror function is going to need two things the video ID and the comment ID so let's go ahead and grab those and inside this first thing is we're going to use use Query data because we need to get some data okay so we're going to say use Query data and we only want the user profile all right so we're fetching for user profile information and once we get this response down here we're going to destructure data from this so we're going to say data is going to be rename to user okay we're going to destructure this and we're going to also get status from that okay and then we're going to typ cast this and say status number data is ID and image that's pretty much it now after this we're going to need use mutation data so let's say const data equal to use mutation data we're going to invoke this and in here first we need our mutation key this is a new comment the next one we need why did this not import why is it panicking hello okay sorry guys this is not an object this is just a function with different parameters right and after this we're going to need a callback function that's going to help us create the comment and or any replies so I'm going to say Arrow function and I'm going to create a server action called create comment and reply and I'm going to pass in the user ID the data in the comment the video ID and the comment ID as well okay now after this we also we're also going to need the mutation uh ID not mutation ID we're going to need the what do you call this one the query key key right so I'm going to pass in the query key which is video comments and then finally a server action that's going to help us reset the form okay not a server action guys sorry this is the call back right so on success we're going to have a callback function that's going to help us reset and reset is going to come from our uh from use mutation sorry guys not use mutation we're going to get reset from use Zod forms okay from use form hook basically so right now I'm just going to say reset for now because we're going to need it anyway and then I'll come back to this so it doesn't scream at me okay so up here first thing is let's go ahead and use Zod form very simple setup so we're going to say use Zod form import use Zod form and first thing is we need our schema that we just created and we also need the mutate function right now where is our mutate function going to come from it's going to come from our use mutation hook so first thing is let's move this up top here okay and down here use mutation data is going to give us is pending and mutate so let's grab this now we can pass it into Zod form okay now we need to also create This Server action so let's go ahead and open up our folder structure and I'm going to scroll up to users and down here I'm going to say export const create comment and reply and this is going to need a couple parameters we need the user ID the comment the comment itself the comment ID and the video ID and in here first step you guys know we're going to create the TR catch block right uh why is it not showing okay TR catch and first thing is let's get the comment so I'm going to say const reply or comment whatever that's fine equal await client. comment oh need to change this to an async function okay client. comments. update where the ID is equal to the comment ID and then we want to get I mean we want to update some data not get data we need to update some data and the data we're updating here is we're going to set reply and we're going to create a reply we're going to pass in the comment we're going to pass in the user ID and we're going to pass in the video ID okay nice now at the bottom if everything is successful the reply was successful right here we're going to return to 100 and we're going to say reply posted okay now we also need to create a new reply so essentially if this reply already exists then we're just in a way we're just updating that comment right but if the reply does not exist then we need to create a reply down here so we're going to say new comments equal await client. video. update for this video ID and we're going to create a new comment so what seems to to be the problem here okay so for some reason bun X Prisma generate did not win uh did not did not work so I'm going to say bun X Prisma generate and I'm going to hit enter okay and then I need bun X Prisma DB push so hopefully this does not cause okay there are no problems all right we're good to go my server is still running nice let's go back okay that solved my problem so it was just Prisma okay so anytime anytime you get this error just make sure your schema is up to date and your and you did Prisma generate okay so at the bottom if we have a new comment everything was successful in here then we're going to return this back okay still looks like something is wrong guys okay so I made a spelling error maybe that's what's causing it so this needs to change to comment okay not comment it's comment with a capital all right I think this is what it needs and then you're going to create the following data okay I think this is better all right and if an error took place I'm just going to return 400 down here okay nice let's go back and let's import our create a comment and reply hook okay sorry server action now we need to return all of this right the register on form submit the errors uh and is pending so we can grab the these states let's use that uh let's export it and now let's use it inside this component so I'm going to say const some data equal to use video comment and let's invoke that and this needs the video ID and the common ID so I'm going to go ahead and grab those from the props because that's where we're getting this from right so I'm going to say video ID comment ID author and close okay now in here I also need to destructure these values so let's grab that and I want to make sure I pass in those values that I need into this comment form okay so in here I'm going to say author and the video ID itself and that that's coming in from props so just pass that in here okay now inside this component we also need to grab all of the stuff that we just that we used from here right so I'm going to grab those and then I'm going to come down here and I'm going to return a form component okay nice form and this is going to going to have a class of Rel relative so I'm going to say class relative with set to full and then I want to check if the user has a close function in here if they have a close function then I'm going to have an x button that's going to help them pretty much close that elements right or basically fire um the close function on click okay so what I'm going to do guys is in here I'm going to say if close exist like this then I'm going to render an X button from Lucid react and I'm just going to put their close function on that okay and that's it so I just have this in here and if you don't know what this is um right side let's see what the error here is okay this needs to change to a use client component first okay now if I click on this something is still messed up let me see what's the issue guys just give me a second so I figured out the problem so the reason is because we are using use Query data and use Query data is going to look at the data that we already have and which is a pre-etched data and it's going to try to get it from there okay so you see if you click on this you're going to see right side of assignment cannot be destructured that's because we are not prefetching the data in a different part in our application so first thing you need to do is go into your users. typescript right up here we're going to create a server action so we can fetch the user data so we're going to say get user profile and say export const get user profile you want to create a TR catch and inside the tri block you're going to say const user await current user you guys know the drill and if there's no user just return 404 next profile ID and image equal await client. user. find unique for this specific clerk ID we're going to select their image and the ID and then we're going to return this if everything is successful okay so now inside the video file right here which is video dashboard okay dashboard workspace ID and video video ID page. TSX we're going to pre create our prefetch request so we're going to say await query. prefetch query we're going to pass in query key which is user profile and the function itself okay so now we're prefetching this data so copy the same thing now and you want to go into your preview folder video ID and click on that page. TSX and paste the same thing in here and just import the get user profile okay now once that is done let's go back into our hook which is use video hook and in here I think now everything should be good so if I click on activity now I don't see that error Okay the reason is because data did not exist in the beginning so when we try to destructure we're getting nothing back okay that's the reason okay cool and also one more thing is in here in the get user profile just make I'm sorry the Callback function just make sure to provide the get user profile as the Callback so now when you click on this it's also firing that callback function okay now let's go back to our video preview component or which is the activities tab inside comment form and let's proceed from here so the first thing we need here is the form generator component so I'm going to create form generator and I'm going to import this register um sorry import import it and I'm going to pass in some props I'm going to say register in here then I'm going to say errors pass in the error object the placeholder which is respond to author the name is comment input type is text area lines eight and the type is text so now as you can see you can you have a text area component in here and you can add whatever you want and if you don't like this you can also check change it to let's see what else we have an input field it's pretty much the same thing and that's probably what you would want to have right so you can have an input field in here and I don't think we actually need the x button guys because I would like the input field to actually remain in there right so let's have the input field in here this should be good to go and next we're going to have a button where the user can submit this form so right here I'm going to say button let's import this button and then we're going to have a loader component okay we're going to have the send button nice and then we're going to pass in the loading state which is the is pending next we're going to have the send icon which is going to have the following class name and the size and don't forget to add type submit on the button as well and don't forget to put these class names as well now I see that we have this here but it just looks a little out of place so let me see if I can change this okay so first thing is I changed bottom two to top of one pixel and that just brought it right in there so that's pretty much all I need I don't really need anything else and then write three this is good to go so cool now um on the form element we also have to pass in our on some on form submit so I'm going to say on submit and I'm going to pass in the on form submit function okay so now when I click on the submit button it's going to submit this data so now let's go back from the form and if there's no points and adding any data right now so I can't really test it because we're not rendering all the comments right so right below the comment form we just have to render out a small component called the comment card so let's go ahead and build that out so down here I'm going to Loop over any comments or actually since we don't have any comments for now I'm just going to create a comment card just like this and inside this uh actually first let's go ahead and create the comment itself so go into Global folder I'm going to create the comment dasc card and inside this an index. TSX and let's return the comment card itself okay nice now inside this we're going to need some props so let's go ahead and First grab those props so first we're going to need the comment itself we're going to need the author which is image first name and last name the video ID the comment ID and the reply which is going to be a custom type which we'll create in just a second and then we're also going to need the is reply okay so now let's go ahead and create the commments type so scroll down here to types and inside these types at the bottom you're going to say export type comment replies props which is going to be ID comment created at comment ID user ID video ID and then the user itself and all of that information okay so pause and please type this if you need to or you can copy it from the GitHub repository now going back here I'm going to import our comment replies props all right awesome and after that down here we're going to need to destructure all of these values okay so let me go ahead and destructure nice cool now let's go back and make sure we've imported the Comon card component and that should solve this bug right here okay awesome and now if I click on this I can see the comment card nice so let's go back into the component and now first thing we need to do is we need to create a state here and this state is essentially to keep track of replies okay so it's not all the replies but it's just the reply itself so if something is if if we're essentially reply to something then we're going to have a button a state here that you know pretty much keeps track of if we're replying or not and then based on that state we can render out some data so first I'm just going to create the state called on reply so let's invoke you state and pass and Boolean for now so this is going to help us keep track of that okay next we're going to need to create a card component so I'm going to remove this and create a card component and let's also import CN function and this card comes from components UI and if the you if this specific reply is a um or this comment is a reply then we're going to give it the following Styles which is we'll kind of indent it a little bit more from the left side and we'll give it border of none okay if not we'll give it border one pixel and the specific border with a padding okay nice now um inside this we're going to first create a div or this is actually for the Avatar right the Avatar section so in inside this hit enter and we're going to create a div and inside the div we're going to have Avatar and the user's name so div Avatar and the user's name instead of paragraph so go ahead and import this component as well just like this nice and please pause and type these class names as well but here we're just going to have the author's image itself in there so we can show uh what the what the user's icon looks like I see an error here so let me try to see if I can solve this error on defined is not an object author is not being passed in so let me go back and let me quickly pass in these props so it doesn't scream at me anymore so I'm going to say right here comment is a comment. comment ID and I'm going to get this in just a second as well but just for now the key is the ID as well the author I'm just going to pass in values and now we need to capture that information right where are we going to get the data well we need to get the data from get video comments so I'm going to go ahead and say get video comments or actually let me create it in the other server action file so open up your folder structure you want to go down uh all the way up here and you want to say export const get video comments equal to an arrow function this is going to be an async function and this needs the ID which is a string and in here first thing we're going to do is have a TR catch block and let's get the comments first so comments equal to await client comment. find many okay we're going to invoke this and down here we're going to say where where um and just please type with me okay so don't make any spelling errors here we're going to have an or condition and we're going to say the video ID is as follows or we need the comment ID so the comment ID as as follow is as follows as well okay so comment ID is the following ID okay and then after this we're going to to say the comment ID is null okay cool now after this we're going to need to include the reply and the user info so I'm going to say include reply and for this we need to include the user true and I'm going to say user in here as well true for this comment itself okay nice now if everything is successful and we got responses we'll return 200 so if comments and comments. length is um is successful then and it's greater than zero then we'll return 200 with that data and if not return 44 here and return 400 inside this error okay let's go back now and now that we H have the server action done let's go ahead and use the usequery component sorry the usequery hook to fetch this data okay but I think we also have to create a prefetch I'm not entirely sure let's see if we need it so video ID we're going to pass it in here let's import use Query dat data and get video comments okay so it says comment is not available that's because we need to uh do the same type casting and renaming our data right so we're going to say data is going to be comments and we're destructuring that from data now it says the right side of the argument cannot be destructured and the reason is because we haven't uh first we need to create these props as well so let me go ahead and grab this typescript prop and again you can scroll down to types and at the bottom here I'm going to say video comment props is going to be data and in that we're going to have user with the ID email first name last name created at clerk uh clerk ID the image trial and the first view or null and here the reply is going to be this comment replies props okay so you can pass that in there which is also going to have the ID comment created at comments ID user ID and video ID and that's an array of all of these okay so please pause and type that or you can copy it from GitHub and I'm going to get this in here so now this is no longer going to also throw some errors so how do we need how do we get this data well we are going to need to first um make a fetch right so first we need to make the prefetch request so what I'm going to do here is I'm going to open up my folder structure okay and I'm going to scroll to where I find I think I can put this inside let me just think guys give me a second maybe we can just put this inside the same folder right so okay just go into video page. TSX and down here I'm going to say video comments I'm going to invoke this and pass in the video ID okay so this is the prefetch request so video comments get video comments and pass in the video ID okay and now inside our preview page right here I'm also going to do the same thing in here okay so now that error is gone but we're still having the cannot find comment error so I'm going to go back into to activities and I see the comment here is renamed to comment okay so we have okay so essentially what we need to do is we need to render out a comment right so for now I'm going to say comments. map and for each of these I'm going to render out the comment itself and here I'm going to get this comment okay so let's see if this throws okay no more errors and undefined is not an object if evaluating contents comments. map okay so it looks like this data returned undefined okay so we're not able to Loop over them so let me see if we can fix this all right guys so I had to make some changes here it looks like something was broken so the first thing was inside our create comment and reply action down here first we need to put this inside an if block because if we don't do it and the user provides um and we're essentially providing an optional comment ID right so this is this is not required so if it's undefined we're going to send undefined into this call and it's not going to work so if that comment ID was provided that means the the entry already exists and it's just a reply so then we can do this step okay if not of course we need to create a new comment so that's why outside the if statement we're going to do this down below okay then the next thing is the get video comments so I made some changes here which is essentially down here I had return 200 and I think it was inside a an if condition which is if comments exist then only if comments are greater than zero are we going to return that but that's not true because we want the comments which is going to be a default array to be returned regardless okay so just return 200 of and um also return the comments as the data okay nice so now when you try to create a comment here here you see it's showing that little uh component with the user icon right that's exactly what we want okay cool nice now I'm going to get out of this so get out right here and let's go back to our component main component our form sorry I meant to say the the comment card so I'm going to go into the comment card component just like this and now I can add the message as well cuz right now I only have the Avatar so let's go ahead and add that in so after this div guys right here I'm going to create a div and inside the div a paragraph Okay so div and paragraph just like this and let me try to refresh okay so I just had to spin up the server once more and now you can see right here we have the image we have the user's name and we have the message itself right honestly you could remove whatever you want cuz if if you know someone who's not does not have an account is trying to comment then you want to of course show Anonymous right I'm going to leave all of that up to you I don't really care about if I'm having the user's name or not uh I think what would be cool is when the user tries to comment and if they don't have an account then we can prompt them to sign up right so you can get more signups for your application as well so super cool feature okay next you want to check if this is a reply so down here if this is a reply I'm sorry if this is not a reply then we're going to return a div just like this and again here we're checking if this is not a reply then we're going to return a button here okay just like this and we're going to say reply to this message so let me open this okay and we also need the comment form so I'm going to bring back this comment form real quick all right and it says use dat picker why do I have this component I'm not actually using this okay so first thing is I'm going to change this component to use client because I'm using some use States in here not sure if that's causing the issue or not probably that's probably not it let me see guys just give me a second okay the button is from the wrong folder it's supposed to come from components folder okay so let's go back into the activity so you see I can click on this and when I do it's going to open up the response or the comment form that's pretty much it okay nice so let me go ahead and refresh again the next thing is I also changed the width and height here to six pixels uh to six sorry width six and height six on the Avatar so it's slightly smaller and for the reply button I'm trying to see if I can put it h just give me a second guys let me see what I can do here all right never mind well I thought I could put this reply button up here but then it's just going to change a whole bunch of stuff and looking at the figma mockups it looks a little similar so I think we're good to go okay so if you click on reply it's going to show a message here and now you can respond back to this one okay so again in here if this message is a reply then we're going to be rendering this and if the user tried to click on the on reply button then we're going to be returning either the comment form or if they haven't yet then we'll show the button itself okay cool next if we have some replies we also want to map over those response uh responses and we want to render them out down here maybe with a small indent right so we're going to say reply. length if it's greater than zero then we're going to show a div here and then we're going to say reply. map we're going to get the reply in here and then for the comment card we're going to response we're going to provide is a reply and for reply we're going to set it to an empty array or maybe I might need to change that let me see right here so reply is going to be comment reply props I don't think we really need it because we're recursively rendering out replies in side right so I don't think we need it really cuz yeah okay that's fine and inside that we're going to put in the comment the common ID video ID key ID and then the author who created it okay so let me go ahead and refresh and let me test this out okay so as you can see I just responded back to this message and just like that I can see a button in here uh I can see a response to this message down here okay awesome guys all right guys I finally figured out why we had that real really ugly looking those rectangles that that pretty much showed up for every single tab right so first thing is you want to go into each of these uh elements right so let me go back and show you right from here so first click on AI tools and why is this not taking me inside okay and you're going to find a class name right just remove this class name on the tab content so essentially the tab content was rendering I guess but it's also rendering for I mean it's showing a background color I I don't know how that works um but if you remove the class name and you remove the the background color it just removes the padding and everything that created that element itself so it's still like magic to me and I don't know I think it's just how the component works okay so remove that class name then you want to go into video transcript you remove it from there if you I mean remove only the background color then same thing for the activities and here remove the background color as well okay that's pretty much it so there we go great job now I just want to quickly finish up the work in progress Flags cuz we only have a few more things and the payment option and then we can move on to our electron application and the express app okay so in here first I'm going to click on the first one that's called AI hook all right and then we have the pay button um send invitation okay let's do that one okay so why up sending invites to customers or to team members sorry so first thing I'm going to do is I'm just going to skim over this so I can see what I have missed out in here okay and I'm going to change my workspace from my personal workspace to a public workspace okay so I'm going to go into prodigies University that way I can see this invite to workspace model and if I click on it now I can search for users and pretty much invite them into the application so let me quickly go ahead and create another user inside my app and then I'll see if I can invite them into this specific workspace all right so just to test if our search functionality is working I logged in with a different user and I created a bunch of users inside um our database and now if I switch to a public workspace so I'm going to switch to product University now I can click on invite to workspace and I'm already seeing two users right away so I can go ahead and let me see if my search functionality is also working awesome there we we go so this way you can select users and invite them but of course we don't have the invite button set up and I can tell based on the invite button because there's no onclick Handler so let's go back here and inside the search component if you scroll down you're going to notice when you click the invite button there's nothing happening on the onclick Handler right so we need to complete this functionality right here so what we're going to do is I'm going to scroll up top right here here and where I have this mutation um the use mutation data I'm going to need to First uncomment this okay so I'm essentially um calling this use mutation data so I can make that that call uh that API call and to make that I also have to pass in the server action to get the user right so so I'm going to create invite user this is another server action or invite members and I need to First invoke this let me also shrink the screen a little bit okay invite members and I'm going to invoke it and inside this I'm going to pass in all of the values that I have here okay so first I need uh actually let's first go ahead and create this sorry guys so go into actions and I'm going to go into user and first thing is I'm going to say export const I'm going to put this Arrow function and this Arrow function is going to take the workspace ID the receiver ID who is essentially the the user right user ID and then the email ID itself and in here first thing is we need to do try catch so I'm going to call try catch like this and first I need to get the current user and because I'm using a weit I need to make this an async component and after this if there's no user I'm going to return status of 404 and next I'm going to look in the database and search if the sender info exists so I'm going to say const sender info equal to await client. user. find unique I'm going to invoke this I'm going to say where for the clerk ID where the clerk ID is equal to the user. ID okay and I'm going to select their ID and set this to true all right so now that I'm getting this information here I can see if the I can say if the sender's information exist and the ID exist on the center info then I want to do the following so in here I'm going to First grab the workspace so I'm going to say const workspace equal to await client. workspace doind unique sorry this isind unique and I'm going to Simply pass the S I'm going to say where the ID is like workspace ID and I want to select the following info so I want to get the name okay so I'm going to say name true next right here I'm going to say if the workspace data exist so if workspace exists then I'm going to first create the invitation so I'm going to say const invitation equal await client. invite. create and in here I'm going to essentially pass in an object and I'm going to create the data so I'm going to say data like this I'm going to pass in the sender info which is basically the sender info. ID right and this is right up here basically the user that's sending the request then I'm also going to pass in the request the receiver's ID and then I need to pass in the workspace so which workspace we're inviting the user into and then some content so I'm going to say you are invited to join this workspace and workspace right here click accept to confirm okay next down here I'm going to say select ID and I'm going to set this to true and after this down here I also want to create a notification so I'm going to say const notification equal to await client. user. update and for this I'm going to pass in so invoke it and inside this I need to pass in where and I'm going to say where the clerk ID is like user. ID and the data that I want to create is going to be notification and we're going to set we're going to create an entry in here we're going to set the content equal to I'm going to put back ticks and then I want to say user. first name and user do last name invited dollar sign and we're going to add this invitation user that we just sent an in invitation to which is the sender info right so sender info and what else do we have here let me just take a quick look let me see if I can get some more information so maybe I can get the first name right and last name as well set this to true and now I can go down here and I can say sender info. first name okay into um into this workspace so I'm going to say dollar sign workspace do name okay it's not required but I just want to show you uh that you can send notifications just like this okay and we don't really need to save this so I'm just going to remove it but yeah that's pretty much it now we have created the first um entry but I mean we have pretty much sent the user an invitation but now we have to send an email so the user can click on the that email and then join right so how do we do that I'm going to show you in just a second so right after this um the notification one right here I'm going to first check if invitation is successful right after this one guys sorry I made a mistake I put it inside the object so if the invitation is good to go we're going to use um we're going to be using node mailer to essentially send an email so open up your terminal I'm going to open one right here and I'm going to say bun add no mod mailer like this and go ahead and hit enter okay awesome and now that we have that installed I'm going to create another server action and This Server action is called send email okay so you can scroll down or actually scroll up top all the way to the top of the file because we might need this for any other server actions right and I'm going to say export const send email this is a server action and this one is well it's not really a server action it's just inside the Ser action file but it's a helper that's going to help us send an email okay and in here we're going to need four different parameters so first we need the two subject the text and the HTML okay and inside this we're going to first need to create our transporter okay now the transporter is also going to need an email and password and that's some setup that I'm going to show you later on because we have to populate our environment file okay but essentially what we need to do in here is we're going to say const transporter equal to node mailer and we have to also install I'm sorry import node mailer so I'm going to say import node mailer just like this what seems to be the issue here okay so it's telling me to add this types for node mailer so I'm going to open up my terminal I'm going to say bun add I'm going to paste exactly what they gave me and hit enter okay and let's just let's just give this a second all right that solved our problem awesome awesome now I'm going to say node mailer doc creat transporter notate create account create transport transport and inside this first I'm going to create a host and this host is going to be smtp.gmail.com and then down here we're going to have the port and this port is going to be set to 465 then we also need secure set to true and then we're going to need the off credentials okay now for for now I'm just going to pass in the user which is user the mailer node mailer email and the node mailer password okay but again we need to populate these values because we don't really have them but I just want to provide them in here so that way we can go to our environment and we can populate it with those two values okay next I'm going to create something called mail options just put all these values inside this so I can return it back and I'm going to return the trans along with the mail options okay so let's scroll all the way down down here into invitation and inside this invitation now I can use that send mail um function helper function that we just created so I'm going to say const transporter or first let's say send mail send email let's invoke that okay and now the second one is going to be mail options and the first in here and the first parameter is let's see it's the two so I'm going to put the email ID and then I need to put the subject right the subject and then the text so I'm going to say you got an invitation right like this and next I'm just going to create another string in here and this is the text itself so let's go ahead and put something in here okay have a huge space here so let me fix that nice and then I'm going to need to put something else after this what is this let's see we need the HTML okay and this is going to be a link tag that's going to take the user to a special page called invitation inside our application okay we'll create that as well but in here first I'm going to create an anchor tag just uh pause the video and type with me okay I'm also going to explain don't worry about it but essentially it's anchor tag like this and we're going to have hrf set to dollar sign process. environment. nextt public host URL because when we deploy we want to use this URL right and then we're going to use slash invite invitation. ID and the style is set to background color we're just going to use black for now and then just padding five pixel uh 10 pixels right here this is top and bottom this is left and right okay and if you don't know the syntax that means you don't know CSS all right it really sucks the Tailwinds really changed a lot of stuff but um this is the traditional CSS guys okay hope you remember and then here is border radius I'm just going to set it to 10 pixels and I'm going to say accept invite okay you can make this as pretty as you want I don't have too much time to waste here so this is more than enough okay now once this is done we have to go ahead and send this email so right here after this const at the bottom I'm going to say transporter. sendmail and I'm going to pass in the mail options and it's going to take in a callback function here so I'm going to create an async function and inside this I'm going to pass I'm going to get access to the error and information so let's grab that and first if there's any error in sending this then I'm going to console.log and first I'm going to put a little Le red icon like this and after this I'm going to say error. message okay error. message awesome and if not else we're going to say console.log and I'm going to pass a green icon so I'm going to say or just say check for now and I'm going to say email sent plus we also have to have the info so I'm going to pass in the info as well cool now after this down here I'm going to return a 200 100 saying invitation sent and after this 4 400 saying invitation failed and after this one 44 saying workspace itself is not found and after all of this down here I'm going to say 404 recipient is not found and down here I'm going to say 400 oops something went wrong now let's uncomment I'm sorry unlock this browser and now we can go ahead and use this hook in here or use this server action so I'm going to import the server action real quick and now inside this I have to pass in first the workspace ID or yeah workspace ID then I need data. receiver ID and then I need data. email okay so I'm going to pass all these values in here and that should be it let me also check the spelling invite member okay good I don't want to mess up any of the queries query or the mutation Keys okay so now that this is done um if we scroll all the way to the bottom here in our onclick Handler we have to essentially pass in the mutate function right so I'm going to invoke mutate like this and I'm going to pass in the receiver and the email okay and behind the scenes it's going to use that and it's going to send that for us now for this I'm going to change this to is pending okay and is pending comes from here so let's just give that a second to okay cool nice so now we pretty much have this set but again we need to set up node Mailer on Gmail right we need that email and the password stuff so let me go ahead and show you how to get all that information please follow these instructions this is how you can get your app password because we are going to be sending emails through our Google accounts okay so first thing you need to do is of course get your email right get that ready then you want to sign in to Google and you want to click on the manage your Google account now please keep in mind this might or probably hasn't changed but this might change in the future okay all you have to do is just make a Google Search and you'll find it okay it's not the end of the world all right it's still going to be there so don't be confused if something changed okay it's the same exact idea all you have to do is create an app password okay so click on manage your Google account and then the next page is it's going to take you into the Google account itself so click on security right in here then it's going to show you um if you scroll to the bottom it's going to show you this two-step verification you have to get this set up okay this is done to prevent people from spamming or some fraudulent abuse and that's why they have two Factor authentication here so go ahead and set this up if you don't set it up this will not work okay just keep that in mind so once you set up two-step verification of course you're going to see a green check mark like you know like I do right here and then you're going to go back to your Google account same way so go back here and click on Google accounts then you want to in search you want to search app passwords inside the search field and then click on this one right here okay that's going to take you into a page that looks like this and all you have to do is down here you want to put the app password sorry the app name and just hit create so I already went ahead and said opal web prodigies do the same thing and then hit create and it's going to give you a password you're going to copy that password and you're going to populate the respective environment variable inside environment file okay I am not going to show you that because that's private information but I'll also delete it it doesn't really matter I'm going to go ahead and delete this after this project um but I just want to let you know that you're not supposed to share this with anybody else okay any of the environment files are supposed to be kept private I'm only if I'm sharing anything with you it's just because I don't I mean it's not that important or I either deleted it okay so please be careful with all your environment variables do not push it to your GitHub or make an a stupid error like that okay all right that's pretty much it okay so now I think we have almost everything set up we can go ahead and try I'm going to invite this person if it doesn't work I'll come back and see how we can fix this but I'm first thing is I'm going to open the terminal so I can see any console messages and I'm going to click on invite okay awesome uh but it it shows 200 here but it said error so let me see what's the problem guys all right guys so it turns out I just needed needed to reset the server that was the first thing so I just quit everything in my terminal and I restart it once more then the other thing I noticed is this return statement I think I accidentally put it inside the transporter block so inside the Callback function so you want to bring it down below right in here okay so make sure you do that and also once you update your environment file go ahead and reset everything okay you want to go and quit your terminal and then restart that one as well and then up top in here everything else looked fine I really know why that was happening um everything else looks per perfectly okay and I went ahead and also sent an email to this person and let me Al just show you here so it says success invite sent nice and uh I already have the email but you see I just received another one right so I can click on this right here and as you can see I just got that email right here okay now if I click on it it's going to take me to the correct link but the problem is this link does not have the public ql okay so because we don't have that it's not going to take us to that specific login page okay if not um I mean if it's in production then it's going to work but just because of this it's not sending us to the correct URL and it says invalid URL okay so we're on the right track great job so far okay so I just went into my environment file and I set the next public host URL to local host. 3000 and slash okay I don't even think we need this but let me see if I just add this one right here and also don't forget to start up your terminal I think I already have the auto reboot so it's going to solve that problem for me I don't have to care about it but down here um it's going to just render out that address right so I think putting a slash here would be better so we have HTTP slash hm okay I think this should work let's just give it a shot okay so I'm going to invite another user once more and let me go to the email address and take a look at the email okay nice and I think this is the one so looks like or maybe this is the one which one is it exactly all right so I think I need to restart my server never mind let me do that guys all right awesome guys so it worked all I had to do was add add HTTP do like this turns out that it doesn't added for you I don't know why it was so misleading because if you look at the link above right if you click on the accept link it's showing HTTP I don't know why they did that but anyway so right here if you click on this link it takes you to Local Host 3000 SL invite and it has a unique ID so we can use that ID to pretty much um give the user access okay so let's go ahead and set that up so open up your folder structure you want to shrink the workspace folders okay so click on this one and then you want to create an invite route and in oops I made a spelling error invite and then inside this you want to create a dynamic folder called invite ID and of course inside this a page. TSX and now I'm going to return a component like this and call this page okay now inside this first we're going to get access to pram so let's go ahead and grab the invite ID from our pams and let's also destructure it right here okay so pams and the invite ID now down here first thing is we're going to need to accept the invite so for this we're going to need a server action okay so let me say const also change this to an async function because we're going to need it anyway and I'm going to say const um maybe I'll call this invitation or invite equal to await accept invite and I'm going to invoke this and I'm going to need to pass in the invitation ID Okay so let's copy this and I'm going to go into users scroll to the bottom and I'm going to say export const accept invitation or accept invite and this is going to receive the invite ID which is going to be a string okay and this is of course going to need to be an async arrow function and now inside this let's go ahead and use a TR catch and I'm going to say const user equal A8 current user so we want to make sure that user is authenticated and if there is no user then we're going to return status of 44 okay and if everything else looks good we're going to say invitation equal to A8 client. invite. find unique and we want to find where the ID is like the invitation ID and we also want to select some information from this right so we're going to get the workspace ID of the user um I mean of the workspace itself from this invitation and then we're going to get the receiver information and from that we only need to select the clerk ID okay so I'm going to say clerk ID and set this to True next I want to make sure that the user that is signed in is the same user who was who received the invitation right so I'm going to make sure that the user ID so if the user ID id. ID is not equal to the invitation so if there were someone else then we want to return a401 okay so I'm going to say receiver do clerk ID so if it's not the same user then we want to return status of not status bar status of 401 okay but if everything looks good we're going to accept the invite so we're going to say accept invite equal to await client. invite do update and in here we're going to set for this one so where the ID is like the same ID in here so invitation ID no it's invite ID and we're going to update the data and we're going to set accepted to True okay awesome and then after that if we need to update we also need to update the users information right because we need to add the add a add the user as a member of a workspace so we're going to say const create member or update member equal to client or await client dot or I have a better way to do this guys let's use a transaction because we don't want this to end up in a race condition right so we're going to say client. user dot update and we're going to update this user info so where this their clerk ID is the same as the user. ID and for data that we're going to update we want to specifically update the members and we want to add that means we want to create a new workspace under their membership so workspace ID and we're going to set that to set that to invitation. workspace ID okay nice now now down here to avoid this race condition we're going to use a transaction and if you don't know what this is you can take a look you can research in Prisma okay so I'm going to say members transaction okay and this is equal to await client do dollar sign transaction why is that not showing up okay dollar sign transaction and you have to provide an array of different um different values right so here we made two calls so let's go ahead and pass those in so accept invitation and create member sorry not create member it's update member okay update member nice so and make sure this one has await as well okay now if we have a response here and the response is going to look like this we're going to say if the member's transaction is true we're going to return 200 response okay if not we'll return a 400 and a 400 right here here now let's go back to our component and let's import our accept invite server action and now that we have accepted the user's invite and also verified the user even has an invitation in the first place we're going to check the status so if invite. status is equal to 404 do we even have a 404 let me take a quick look okay right here that means there's no user not verified and 400 right okay so if it's 404 then we're going to return and redirect the user to the sign-in page okay and this one comes from next navigation so I'm going to return them to au/ signin and then after that down here if it's 401 that means they are not authorized to see the page I'm going to say if invite status is for a one then go ahead and return a div with an H2 and a paragraph okay so I'm going to say div height screen like this return div hide screen container Flex Flex column gap of Gap of two and justify Center item Center so we have an H2 and a paragraph tag so I'm instead of saying this actually I'm going to say not authorized okay much better and that's it now down here if everything was good and the user was uh pretty much you know they have access they're verified to access this information we're going to see if it's 200 and then we're going to redirect the user to a/ callback okay awesome and the Callback route will essentially handle routing them to their first workspace that's pretty much it so now let's go ahead and give this a shot and see what happens and I also want to make sure that the user that's signed in is the exact user that got this request so just give me one second guys all right so I'm I'm going to go ahead and click on this link so I just sent a new invite back to myself and just to make sure there's no confusion I also deleted all the entries from our Prisma Studio okay and I sent a brand new invite so now if I click on this let's see what happens so it takes me to Local Host 3000 SL invite and something looks wrong it's saying 404 cannot find let me take a look guys just give me a second okay so the problem here is I created this invitation route inside the workspace ID so you want to bring it to the root of our app directory right here and you want to move it in there and let's see so we have invitation okay nice and that should do the job so let me go ahead and see what happened in here okay item. workpace uh let me try this one more time okay all right so it almost worked it took the user to the Callback route and it took the user to the dashboard route but something happened here the ID was undefined so let me see what happened here all right guys so we got to make a couple changes so go into your sidebar index. TSX and now wherever you find the workspace do uh workspace do members like this right you want to refer to the workspace here with a capital S okay so change this before this had used to be I think work work space like this change it to capital S you're going to see red squiggly lines in the in the beginning that's fine because we need to change the types as well okay but first change that in here so I Chang it here here here and here as well okay then there's one more place I think it's above this somewhere right here uh no not right there where okay right here so workspace members. map and I returned the same thing okay so workspace capital s capital S capital S now we need to go into the types so we can change that so I'm going to click on workspace props and inside this this used to be small letter so I just changed it to Capital as well so that should solve your problem and the other problem is because I sent like probably four or five emails to the user they were accepted into that account four times okay so that's something that you might also want to uh prevent from happening but apart from that everything else looks great so great job so far so for example if I create a folder inside my prodes University um workspace right here just like this and if I go into the other user you're going to see they're going to see this in here as well now this is not real time okay it's not real time the reason is because we are using react query okay react query is super super powerful it's just a little Annoying to work with just like Redux but the benefit of it is much more than you were than if you were just using axios so essentially if you hop out of the page or if the screen goes out of focus it refetch data right so it almost feels like things are in real time so with the power of react query and optimistic UI you can create the illusion of realtime data inside your application okay but yeah that's pretty much it so this section works as well great job now we can also see the private um workspace in here and of course this is private to this user only okay so they can also swap back and forth nice looks amazing guys great job all right now the next thing we want to do is I notice there's another um work in progress flag so I'm going to go ahead and set this up okay so let's remove this and the first thing we want to do is let's keep this uh let's move this up top this is good to go and first thing is we need to make a request to essentially send an email for the first view right so you're going to send an email to the user the owner of this workspace saying someone just viewed your video and we'll also send them a notification so I'm going to say notify first View and this is going to be a new server action that we need to complete uh create so I'm going to copy this uh server action and also I'm passing the video ID in here so we can send that link or whatever we need to do essentially right so let's go back into our into our server action file right up here and inside workspace I'm going to scroll to the bottom and I'm going to say export const send email for first View and this is going to be an async function and this is going to take in the video ID now inside here I'm going to have a TR catch block and inside this TR catch first I need to get the current user so I'm going to say await get current user if there's no user return a44 error and then I'm going to go into my database so I'm going to go in and then find a user um with this user ID and I'm going to essentially get their first view okay so I'm going to say const first view settings equal to await client . user. find unique and inside this I'm going to pass in where and I'm going to say clerk ID is user. ID and down here I'm going to select the following information so I need the first View and I'm going to set this to true and now I can look into this and say if the first view settings do first view exist sorry if this does not exist then I'm just going to return a44 right or just return this is fine as well and if everything else I mean if um if essentially we need to set that then here I'm going to update that video okay so I'm going to say const video equal await client. video. find unique and and for this specific video ID I'm going to update the following information or actually I'm not updating guys sorry I'm going to grab the video itself all right so sorry about this so I'm going to say select and in here I need the following information so I need Title I also want the views of the video and then I also want the user information and I'm going to get your email okay then after this I'm going to check if the views if the video views are zero or and there's something in here and the video views are zero then I'm going to update the views okay and I'm also going to send a notification to the user saying that someone view the video so I'm going to say await client. video. update and inside this I'm going to say where the ID is video ID and I'm going to update the data and I'm going to set the views why is this not okay sorry okay let me do this and I'm going to say views in here and essentially I want to add this so I'm going to say video. views hello plus one okay nice the next thing we got to do in here is we have to send that email so I'm going to say send email and I'm going to import this okay and H okay so I think this is a slightly different version so just give me one second guys okay so first thing is I have to say await here so await send email and now I have to pass in this data so if there's no video then I'm going to return here and I'm going to say video. user and we're going to get the email then we're going to send um a the what what is this called essentially I think this the subject right so we're going to send the subject and then we're going to send some text and you can send HTML if you want I'm not going to waste any time but that's pretty much it and now we have to send this email right so this was setting up the settings getting mailing options and the transporter now we need to send the email itself so we're going to say send mail and let me see if I did it the same way in the other components as well okay so I said transporter oh this is the this a different one okay transporter. sendmail all right and then Okay cool so transporter. sendmail we're going to pass in the mail options and we need a function in here so I'm just going to call an arrow function and this is going to give us access to error and the info okay and now inside this I'm going to say if there's an error we're going to console.log the error. message right and after this I'm going to say else and in here I'm going to say const notifications notification equal A8 client. user. update and in here I'm going to say where the clerk ID clerk ID is like user. ID okay and what's the issue here okay this needs to be an AC function and after this if there's no error then down here we're going to need to also update some data so I'm going to say data is going to be notification and in here we're going to create the following data why do I keep typing P my fingers are mismatched guys so I'm going to say content and in here I'm going to say mail options. text okay nice now that I have this if the notifications exist so right after this then I'm going to return 200 so notification notification okay cool and that's it and then if there's an error I'm just going to print this error out so I can see what's going on and uh that's pretty much it okay so let's go back now to this component and this is our sidebar component actually so I'm going to go into the send mail okay this one which is a video preview components and I'm going to import This Server action next we're going to have a use effect down here that is essentially going to look for the video views and depending on that if it's equal to zero then we're going to notify the first view so we're going to call this function in here okay so I'm going to say use effect like this and if it's equal to zero notify and then we're also going to return this that's pretty much it okay so I'll try and see what happens here let me just take a look so right now I'm on this account let me go into prodigies University or I think I have I have one in here right okay cool so if I view this it's probably going to do the same thing let me just take a quick look okay nice I just received an email saying your video um prodigies University is just watched or something okay nice great job and just to show you that right here as you can see I just opened the email it was just sent 0o minutes ago okay awesome okay and I made another quick change which is inside the global header in here I added if the path um and the path should also not be equal to should not include video in the title okay so not path name. includes video and down here I'm just saying path name that includes the video if this is true then I'm going to render an empty string so I'm removing the ugly title okay cuz I realize I don't really need it anymore okay so yeah I can go ahead and remove that and also same thing and that's pretty much it and then you can render my library if uh as the else option and you can also remove this one so based on this so you can say if path name. video if this is true then you can render out an empty string or you can render out the workspace title okay it's not really important right or you can also look at which type of path name we are looking at so if it includes the preview then you know you can change it all right so this is a good time to pretty much set up stripe so let's go ahead and get started with this part so I'm going to remove this button in here and as the footer I'm going to create another button called the payment button okay so let me also see if okay I think this should be fine so I'm going to call this payment button okay like this awesome and I'm going to open up my folder structure and I'm going to create that payment button in here so I'm going to say payment dasb button and index. TSX and I'm going to return this and call this payment button okay and I can pretty much just replace whatever I have with this button for now and then I'm going to essentially put the logic inside the payment button itself so the first thing is we're going to need a a hook called use subscription and this use subscription Hook is going to essentially help us get the user to subscribe it's also going to you know take them to whatever page we need to send them to and this time we're not going to be using the custom payment form because I already did it in the past four videos so you can take a look at that if you want to learn how to build custom forms custom payment flows and all that kind of fun stuff okay this video is only the important stuff remember your goal when you're building a SAS is only to get an MVP out okay I've worked with so many students and you guys think your application should look beautiful before you go live trust me if you are not embarrassed with your SAS application when you go live you built way too much okay and this is a pretty decent experience I still know SAS business owners who till date still have the S the uh not SAS uh checkout they have the stripe checkout page right they haven't even upgraded that section because people are still you know people find Value in your service so as long as you have something that's solving a problem and you're helping people and you genuinely care about people and not just a sale and your solution is not just a want it's a need you will sell like crazy okay but all you need first is to get an MVP out there as fast as possible now there's more to this like the illusion funnel and the sell first strategy and so much more that I have broken down inside prodigies University in a course called the ultimate SAS course now this may not be for you if you are not a SAS business owner or a SAS developer you might not want to start your own SAS company you might probably just want to build fun applications like this and that's totally fine as well but if you are serious about your SAS Journey and you want to start a SAS the right way get guidance from hundreds of SAS business owners including myself and our team so you can get technical support pretty much whatever you need through weekly coaching calls and unlimited courses then you can join prodigies University and learn from there okay awesome anyways let's proceed now so the first thing is I'm going to say uh I'm going to create this hook so this Hook is going to give us access to ons subscribe and is processing and it's called use subscription hook so scroll down here and I'm going to create this hook here called use subscription. typescript and in here first export a variable called use subscription or sorry uh actually yeah use subscription and this is an arrow function and this is first going to need a state in here okay so we're going to say const is processing and set is processing and this is going to be equal to use State and we're going to invoke that and we're going to pass in false okay next we have to also create the unsubscribe function and this unsubscribe function is essentially what we're going to return back to that component okay so you're going to say on subscribe equal to async and in here we want to pass in the following so first we're going to set is processing to True okay awesome and then down here we need to get a response we're going to say const response equal a weit axio so right here only here I'm going to be using axios so go ahead and say bun add axios like this and go ahead and hit enter and now in here I'm going to say axios if it I don't think it's going to let me import so I'm going to say import axos from axios okay nice and down here I'm going to say axios like this I'm going to invoke it and in here I have to also tell which method which it whether it's get post or whatever right so I'm going to say get and we need to go into the API folder and inside the payment folder okay and this is the route that's essentially going to give us an endpoint okay we need to render out that endpoint essentially we're going to use wind window.location.href and we're going to push the user to that um to that location okay that's pretty much it so in here we're going to say if not off if response. dat. status equal to 200 then what we're going to do is we're going to say return we're going to say window.location.href is going to be equal to we're going to put quotations in here and I'm going to say dollar sign the curly bracket response.data do session URL okay please don't make an error in here with the spellings copy this correctly okay it's session s SS i o ncore URL okay then once this is done we can set is processing to false and down here we can return the value which is on subscribe and is processing okay nice awesome now let's go into our folder structure and I'm going to go into our API folder if we have one I don't think we have one all right I thought that actually comes by default anyway so you're going to go ahead and create an API folder in here so under app I'm going to say API just like this and inside that I'm going to create a folder and this folder what did I just do here I opened the settings file sorry about that so inside this API folder I'm going to create another folder and this one is called payment okay and inside this we need a route. typescript file so inside this file all we're going to do is first we're going to get the current user and then we're also going to get our stripe keys right and I'll show you how to do all that stuff don't worry about it and once we do that we're just going to create something called as a checkout session okay we're going to pass in all the values that we need such as the mode the price the quantity all that stuff and then we're going to essentially create a checkout session and return that session with the session URL to the front end okay that's pretty much it so this is going to be a get endpoint so don't forget about that so export async function why can't I type today okay function and this is going to be called get okay so function like this nice let me shrink this so you guys can see clear and first thing is I'm going to get the current user so I'm going to say await get current user just like this nice and if there's no user let's return 404 okay and this is next response and you can import it from next server and then after this we need to get our price now we don't have the price uh ID yet that's totally fine all we have to do is go into our stripe dashboard and we need to just create the stripe stripe price ID for a product okay and then we're going to get a price ID from that and then we can just set that in here but for now this is all we need okay just say like this and then we'll populate it inside our environment file okay now we're going to need Stripes to open up your terminal we're going to say bun add stripe like this and hit enter and now that's it that's all you need for stripe okay um and then right here you're going to say import Stripe from stripe and now we need to create our checkout session so we're going to say const sorry where am I typing okay const session equal to A8 stripe stripe like this okay and oh I need to First create a client guys sorry about that so const stripe equal new stripe and I'm going to invoke it and of course we don't have this right now but I have to pass in our our stripe client secret key okay so I'm going to say process. environment client secret key as string okay next down here I'm going to invoke uh I'm going to call stripe and I'm going to say checkout. sessions. creates and inside this session I'm going to say mode and I want it to be a subscription payment and next I'm going to create some line items and this is going to be an array of multiple items or just one so we just need one right now so for this I'm going to pass in our price and the quantity so price quantity one that's it next after this array we need to pass in the success URL so once everything is completed we want to we want to send the user back to the payment page okay and this is a custom page of course which we haven't created and it's going to be inside our um our main route okay so inside the route inside app so success URL is going to be our um our public host URL SL payment session ID and that's going to be equal to the checkout session ID okay and this checkout session ID is essentially what we get from from stripe okay next in here we're going to take the cancel URL and we're going to pass this in here as well this is just the payment and cancel set to true that's it okay next if the session exists we got everything and everything successful we're going to return a next response and we got to return Json data send status 200 the session URL and the customer ID as well if none of this was successful then we're going to return a 400 response okay simple stuff not too complex but do I see something red in here okay it's because I haven't completed this section yet sorry about that so let's go back into that component and first thing is I'm going to need to pass in something right use subscription okay I don't think it need oh it doesn't need anything all right we're good to go so it gives us access to this all we have to do is get unsubscribe and I'm going to set on click on this button to unsubscribe so when you click on this it's essentially just going to render out that page right and now we also have to pass the is processing inside our loading State okay nice and now we have our endpoint setup we can go ahead and import this payment button just like this and let me see if we need to pass some props okay no props for this component so nice all right now all we need is let's go ahead and grab our stripe keys and our stripe ID so I'm going to open up my API right here go into route so I can keep this first thing I need is a price so let's go ahead and do that now before we go into stripe I just want to show you a stripe quicklink guide that I created I put it up for the cheapest price I possibly could okay so you can go ahead and grab this right now it it's essentially all the links that you need for every single page or integration type in stripe and trust me when I say this stripe is massive you need you literally need to know how to look and where to look inside stripe in order in in order to find what you're trying to look for okay so that's why I went above and beyond and I created a simple document it's not too complex it's just straight to the point for example if you're trying to do how to accept a payment we know exactly where to go how to create a direct charge how to create subscriptions and how to do stripe connect stuff so this took me literally two weeks to find out and I just put it in a simple document so it can save you a ton of time so if you click on that you can purchase it um it's right here and inside this I also have a bonus stripe direct support um support link where essentially you can get 247 support from their uh private Discord chat okay so you guys are not going to find it very easily if you try to search for it but this is the best support I've received from stripe and I've put the link in here it's a little secret link if you click it's going to take you directly into their support Channel and you can get um support from their tech leads okay awesome so I went ahead and logged into stripe and make and I also made sure that I turned it on to test mode okay now first thing is I'm going to go into products and as you can see I've created a bunch of products right here I'm going to create another product and I'm going to call this opal pay tier okay not t e a okay and or just say opal paid or just say the price right I think our platform is how much are we even charging I'm just going to set $99 to make it easy and simple all right that's what everybody charges so it's at 99 for opal so I'm going to say opal 99 and down here I have to charge $99 every single month okay now go ahead and add this product it's going to create the product for you click on the product and then it's going to take you into this section right here now you're going to notice a new price called this was created right you can go ahead and copy this price ID so let me make sure it's the exact same price ID 107 or 1 Q7 and ends with 23 1 Q7 and ends with 23 okay so if it will let me copy this oh man why can't I even copy this see all lines okay I have to copy it this way great nice so now that I have copied this I can go into my environment and I can populate that okay so go into your environment file and you're going to scroll down right here you're going to find something called price ID and just put it into that okay and once you're done with this you're going to go back into your dashboard okay and if you have the document you can directly click on the stripe link which is the dashboard link to get the API documentation if not this is what you have to do so first you have to look up for Developers then it's going to take you into this page just note how you there's no way you can access this page right so you have to search for this so don't forget okay then you're going to click on API keys and you're going to find a bunch of stuff right here first copy the publishable key okay and paste it in here I'm going to put it inside quotations and then you're going to have a secret key so you can delete this and you can pretty much create another key if you want but I already have a test key so I'm going to copy this and go into your stripe uh client secret key and you can paste this in here okay awesome now that we have all these values I'm also going to make sure my stripe publishable key has the right ID let me go ahead and take a look just give me one second okay so we don't need that because that one is only for if we're using custom stripe forms okay we're just using the custom U the default stripe page so I don't think we need that but it's okay for now I'm just going to put it in here okay now let's go back and essentially let's just give this a shot and let's see what happens okay so I just clicked on this button and I see an error so status code of 500 API payment so let's go ahead and take a look at that man I hate this dude it I literally spent a whole day a whole day trying to figure out the solution as to why I'm not able to upgrade a user to a pay tier and if I tell you the if I tell you the problem you're going to laugh at me but what I did wrong was down here I had the same key duplicated twice and one had a value and one did not how stupid is that okay and because of that the the terminal was throwing a 500 and my app was throwing a 500 and I went into stripe documentation I went into every possible resource on the internet to get you guys the answer because I was so determined that you need that I have to give you guys the answer to this problem all right well I've also done this in the past the same exact issue and I it turns out I did it again but I just wanted to say that was the problem okay see my goal here is I don't care if I have to go above and beyond and spend an extra two three days of sleepless nights to get you guys to your goals because my goal is I want each and every single Prodigy every every single person who's watching this video to have the ability to monetize your code I I'm not here to teach web developers how to code don't get me wrong that is not my goal right my goal here is to give you SAS developers and SAS business owners the ability to finally quit your job because you can monetize your passion you can monetize your code you can monetize your SAS and it is the best business model to start today because next year is going to be the great Bloom of SAS and I'm making this prediction right now itself because there's a sudden Trend in AI tools and you guys know about this right ever since what 2023 right 2022 we had this sudden Spike for assassin AI tools and the Champions that means the you know the clever people they jumped into it right away and started Ai sasses and software services and they made money right there's still a chance and that's why I'm doing because I want to give you all the tools completely for free I'm not charging a single dollar right all this code is done for you you have the code you have the knowledge we did the research we built the UI we got you know people to build the best designs for you and we did everything all you have to do is the other tiny portion that's left Market start today we have done every single thing you have no excuse if you say I don't know what to do we have done everything for you all you have to do now is get it get the application go live and make money okay that's literally it because I really want each and every single one of you guys to experience what it feels like to not have a 9-to-5 job okay everyone working in prodigies University and in web prodigies none of us have 9 to five jobs we build what we love we work on things that we love we wake up every single day and we love the things that we do and I want you to experience that as well I don't want a single Prodigy around the world to ever wake up on a Monday and wish it was a Friday never never again that's my goal okay so I've done everything completely for free all I'm asking is to give a subscribe okay if you believe this is enough value so that you can get even more free resources just like this and you want to give me the motivation especially after this torturous one day 24 hours where I had to find the stupid error and it turns out to be in my environment file if you want to just support me and support the channel and also get high quality products like this on your feed then all you have to do is just hit that subscribe button okay okay awesome so now that we have done this if we try to click on this it should 100% take us to the stripe checkout page let's go okay awesome all right I'm excited all right let's proceed now now that we have the checkout page set up we want to also make sure that when the user comes back to this page right through the success URL we want to First make sure that they are getting uh we are listening to this endpoint right because we don't have this endpoint set up so go ahead open up your terminal I'm sorry open up your folder structure and you want to create another folder inside the root folder so I'm just going to shrink everything so it's easier inside app you're going to want to create another folder right here and you're going to call it payment and inside that you're going to create a page. TSX and a loading. TSX okay it doesn't really matter but I'm going to also have a loading page in here and this is basically a spinner component okay so I'm just going to import spinner from our from our components and I'm just going to render out a div just render um you know height screen with full Flex justify Center item Center and this the spinner is going to be right in the the center of the page okay and inside this page. TSX I'm going to return a component in here and the first thing is we're going to get access to a bunch of search prams okay and these search prams sorry these search prams come from from uh stripe and if you don't know where that is let me show you right here you see we have the payment session ID and the other cancel ID and all that kind of stuff so essentially we want to destructure them from the search pams and we want to capture those those values in here okay so let's go ahead and get search params and let's also destructure the other two variables and the first thing we want to do is we want to check to make sure that we have this session ID so I'm going to say if session ID exists like this right then what what are we going to do here so first we're going to complete the user subscription and once we get a 200 response we're going to redirect the user to the off call back page so that that way we can send the user into their workspace okay so what do we do first like I said let's go ahead and complete the subscription so I'm going to say con customer equal to let me also zoom in guys so you guys can see clearly okay customer equal to await complete I'm going to call this subscription and I'm going to pass in the session ID inside this now first thing is change this to an Asing component and then let's go ahead and create the server action so I'm just going to go into the user page like this and at the bottom I'm going to say export const uh complete subscription and this is going to be an eror function and this is going to need the session ID so session ID ID is going to be a string okay and inside this first I'm going to have a triat block and I need to first get the current user that is signed in so I'm going to say const user equal await current user and if there is if there is no user I'm going to return status of 400 okay or 404 sorry and then after that change this to an async component now and then I'm going to say const session equal to await and now I need to create that stripe client so a good thing to do guys would be to actually create the stripe clients in a different file okay and then you can import it right here so that's another way to do it but for now I'm just going to make this simple I'm going to scroll up top to this file and I'm just going to put the stripe client up here okay and let's also import Stripe from stripe like this and now we can instantiate that stripe client all right so down here I'm going to say if I'm sorry const await stripe. checkout. sessions. retrieve this specific session which is this session ID and if it is a valid session right if it if everything is good then we're going to upgrade the user plans I'm going to say const customer equal to await client. user. update and I'm going to invoke it and say where the clerk ID where your clerk ID is like user. ID and the data that I want to update is your subscription status and in there I want to update specifically the f following data so I'm going to change I'm going to change the customer sorry I'm going to set the customer ID in here and I'm going to pass in the session. customer okay customer like this session. customer okay and this one has to be as string okay and next I have to also pass in the plan so I'm going to set plan to Pro Plan Pro hello give me Pro all right thank you all right now at the bottom here if everything is successful we we will just return 200 so I'm going to say if or inside this actually let me see where I can put this okay this is fine so if customer exist will return 200 response that means everything is successful and if not then we'll return 404 and down here just return a400 error okay awesome now let's go back and quickly import this uh the action that we just created and now we have to ensure that we have a 200 status so I'm going to say customer dot this customer. status what seems to be the issue here it's possibly undefined okay so we want to make sure this is returning the status number and undefined so let me go in here and make some changes guys just give me a second okay so all I did was move this from up top here down here okay now in here once we get customer status and it's 200 then I'm going to redirect the user using next navigation to a/ callback okay done now I have to make sure that if the user was trying to cancel right if something happened uh not the user trying to cancel but if the subscription session was actually cancelled in some way then I have to search in here and check for that param so if cancel is true then I want to do the following I want to return a div with a message that says something went wrong so I'm going to say return a div Flex Flex column justify Center item Center Height screen and width full an H4 tag and a paragraph tag that says something went wrong okay done so now we're pretty much set with the Ed subscription hook and let me go ahead and try to test this out just give me a second so I'm going to click on subscribe and it might take me to a different page and I might not be authenticated let's just see as long as it okay so it redirected us to this page oops I missed it okay never mind okay um but yeah that's it so now this user is no longer a free tier member right as you can see we lost access to that banner down here and we can also do other AI related features and whatnot great job guys all right guys now we we come to the fun stuff we will be building an electron application which is a desktop version of opal now it's not entirely the browser version in electron but it's a plugin that's going to help the user to record their screen and upload that into opal users can then go into their browser version access opal they can copy links and send them over okay so this is essential to do right now do not skip this part because if we don't have the video we're not going to be able to get transcripts and as a result we're not going to be able to use AI features and as a result we're not going to be able to finish the entire application in the right order we also have to set up AWS S3 buckets to store these videos so please watch this entire course in the right order okay so first thing is go ahead and create a folder I'm going to call this opal - web prodigies Das desktop app okay just like this and now you want to go into your cursor and make sure your opal web prodigies the main application your browser version is still running okay you're going to go and click on new window that's going to open up a brand new cursor window and I'm going to move it all the way right here and now I'm going to move my opal application the electron application that I just created inside this folder okay now open up your folder structure and I will be using npm for this because bun is not truly optimized so um I don't think it's a good idea to use it inside an electron application okay so go ahead and please type this command with me it's npm create electron Das Vite because we will be using Vite for for this application and then you want to say at latest then you want to put a space and click on the uh dot okay and then hit enter it's going to give you the first command is what project template do you want we are going to be using react okay please do not do vanilla um then you're not going to be able to follow with the course so click on react and it's going to give you a full native react application and this electron version is just used using react and it's combining it with standard uh electron stuff and it's connecting all of the files and building us an electron version of a desktop app that can work on any device okay now of course there's a you know a disclaimer I want to point out you will have to also make some changes per for every device right right now we we have only set this up for Windows we have optimized it for window Windows and Mac okay even with Mac I might have issues because you know Mac has now changed a lot of stuff they are prioritizing security so there's a lot of things that that we might you know come across and if we do we will figure out a solution okay because there is always a solution so now go ahead and say npmi which is going to install all of our dependencies and as you can see we have react and react on also included in this package so it's going to go go ahead and install everything and then you should see all the errors pretty much disappear okay so let me go ahead and refresh stuff and make sure everything is good to go now the first thing I'm going to do is inside my main. typescript file let me also zoom in a little bit more which is inside the electron folder you want to click on this and remove this line and then you also want to remove create require we don't need it for now okay next just to make sure that everything is good to go I'm going to type npm runev and hit enter awesome and if everything looks great you should see a native application that looks like this it's essentially just a counter application that uses react of course but if you don't see this for some reason just make sure you follow the right steps you can go back and do it one more time okay now electronjs does not come out of the box with Tailwind stuff installed so we have to go ahead and install Tailwind along with um any other components like shaty and UI or any other libraries that we need right so I'm going to go ahead and open up the browser and I'm going to search for shats Andi now click on installation click on VJs and you're going to find this Command right here you can copy this one we already did this so we don't need this we only need this part and I'm going to open up the terminal I'm going to quit my terminal right here I'm going to paste this command and hit enter next we have to create or in it Tailwind so it creates our files so in here I'm going to type the same command and hit enter and you should see a post CSS file and a Tailwind config file okay and this is going to use JS you can change it to typescript and you can change this one as well to typescript okay this entire project is configured using typescript but I don't know why this gave me JavaScript here but that should solve that problem now if you look into the installation you'll see the current version of Vite splits typ typescript configuration into three files two of which need to be edited the base URL the paths and properties to the compiler options uh and also the typescript configuration and this ts. app.config file as well okay so go into your tsconfig Json file which should be right in here and we have to essentially make these changes so I'm going to copy copy this and I'm going to go into my Tailwind sorry typescript configuration file and in here I'm going to add my new compiler options okay so I don't really have to do this instead I can go up here because I already have the compiler option right I just have to provide the base URL and the paths like this okay nice and that's pretty much it okay now let's go back here and see it also says we have to update the typescript config app.js so let me search for that real quick okay so I'm not able to find this file I think they probably removed it right I'm not sure if we even need it so if it's supposed to be there then you can update it at the moment I don't find this so I'm just going to skip over this and if any errors take place then I will come back to this okay so go ahead open up the terminal and you're going to type in the following command which is this one right here so I'm going to type this in and hit enter and now we can copy this right here and we have to add this to our file so Define config right here at the bottom you can hit enter right after this and you can put this inside actually not right here guys it's after this bracket okay you can put the resolve path right in here next let's go ahead and initialize chat cnii so I'm going to open up my terminal one once more and I'm going to say npx chat CN at latest in it and it's going to ask me I'm just has ask me some stuff I'm just going to hit yes for this and let's just give that a second okay it looks like no Tailwind CSS configuration was found and I think the reason is probably because it was looking for hm Tailwind let me just take a quick look at this all right so there was some error which was essentially telling me that it could not validate the Tailwind CSS which is really weird cuz it already generated the Tailwind config file so first thing did was I just changed this tojs I don't think it actually matters you can still keep these two at as typescript and the next thing I did was inside my TSC config.js I added the Pats and this is something that Shaden is giving me inside the documentation so make sure you add this in here next inside the TS node. Json you want to add the base URL like this and you want to also add the paths like this same thing okay next thing is inside the Vite config I added the resolve Alias and I passed in the at right here and I set the source as the um path to resolve to okay so make sure you type this out as well and once this is done I took a look into my index.css and for some reason it did not install any of the CSS related stuff in here so what I did was when I ran the command it said click on this Tailwind configuration to learn about how to wire up tailwind and I noticed the first thing is it said well do all of this and we already did this clearly it's telling me to to configure the templat I'm going to copy this right here and I'm going to go into my Tailwind config file I'm going to remove content and I'm going to replace it with exactly what I found okay then I'm going to add one more in here and it's it's it's called what is it called I think it's called dark dark mode or okay I don't think it's giving me that so it should be fine for now but let me take a look all right it's working so weird all right dark mode okay so go ahead and say dark mode and you want to pass it an array and pass in class inside it now if you click on this it's showing nothing is in here right so if you scroll down it says you have to copy these three utilities and you want to go into to the CSS you want to remove everything and you want to paste this in here then it tells you to run Dev but before that I want to also do npx shaten latest at latest and in it and if you hit enter it's going to give you this part saying it validated the Tailwind CSS file so now go ahead and click on neutral and New York and for yes for CSS variables and it's going to go ahead and do all the CSS stuff Tailwind CSS stuff okay nice now the next thing is I also want to install components in here so what I'm going to do is well you could either just install all the components or you could just do only the components you need and for this project it's a very small I mean very small project the only thing is we just need three Windows a recording screen access to you know stuff on the computer and that's pretty much it and we only need three components like the popover button and sonar so we should be good to go but I want to just get everything just for the sake of it so let's go ahead and do that first so I went into shat ceni and the same exact thing you want to copy this command and I'm going to open up my terminal I'm going to paste this but instead of button I'm going to remove this and just say add okay then you're going to ask me which component do you want I'm going to hit a and I'm going to pretty much install everything but before that guys I also want to make sure hm okay let's just do this and see if it installs it under the correct directory and hopefully it works and we'll get back once this is done okay awesome it went ahead and built a components folder and it also built a hooks folder with the hook that we need which is used toast so that looks great now let's go ahead and say Bun Run Dev and hit enter okay something looks wrong here sorry guys it's npm runev because we're not using hm H so something is wrong okay let me go ahead and fix this okay so nothing was wrong really it's just that we had the JS files for these and if you want to do that you also have to go ahead and configure your con your TS config file to essentially use the typescript configuration types okay so TS node so I don't have time for that so what I did is I just changed this to JS and now if I do npm run Dev that should spin up an application for us okay there we go guys great job the next thing you want to do is we are going to install clerk inside our application okay so for that we're going to need two environment variables so inside your env. example um I mean inside the GitHub repository you can find this you can copy it and paste it if not no problem all you have to do is you have to create your EnV file so I'm going to say EnV like this in the root and then also in get ignore we want to go in here and at the bottom we want to say EnV okay nice and the next thing is I went into GitHub and I created a new repository and I just copied this line by line right here because this by default does not come with the GitHub repository okay so I just copy this the get in it one line by line and just hit enter and that essentially uh install my GitHub repository into this and you will notice your EnV file will be pretty much grayed out like this okay this is exactly what you want I just did that right now so that way I know my get ignore is actually working okay so now I'm going to close this I don't really need this terminal so kill this terminal here okay and the next thing is I'm going to go into my example and I'm going to copy the URLs right in here and I'm going to paste it now I'm going to go into my other application which is our web application and I'm going to copy the clerk publishable key next let's go back into this and I'm going to paste that publishable key in here okay and this one when we need it we'll get to this right now we don't really need it so next we also need to install clerk so let's go ahead and do that now the next thing is because we're using VJs we have to install stuff with respect to the Vite version right so we have to go ahead and open up clerk documentation and I see a react quick starter guide in here and I see the command that I need so I'm just going to copy this command and in the terminal I'm going to open another one actually not sure if I have to quit this terminal it's very different from the traditional react application right so I'm going to go ahead and paste this in here and if I look at my okay in my package Json I see the clerk react okay and let's go ahead and run Bun Run Dev or npm run Dev and now I can restart and I should see a window popup okay nice so let me also make this a fulls screen window now first thing is I'm going to go into my index.css if you have the CSS file from GitHub you're good to go all you have to do is copy it from there and you can paste each and every class we're going to need these classes to essentially make each of our Windows draggable okay because they're all individual plugins right so you can create these classes by copying it from GitHub or you can pause and type the screen type from whatever's on the screen so first one is draggable and non-d draggable then for scroll bar I'm going to turn that off as well um sorry I'm going to change the width to five pixels and for Border radius on the scroll bar tracker I'm going to change it to 10 pixels and for the handle on the scroll bar it's called scroll bar thumb I'm going to set it to Gray and set the Border radius to 10 pixels okay nice now I'm going to go ahead and close this and let's let's go back into our app. TSX and sorry our main. TSX and let's continue from here so the first thing we want to do in our main file is we want to say const publishable key is equal to import met. env. Vite clerk publishable key next I'm going to say if there's nothing inside the publishable key then I'm going to throw an error and just say missing publishable key okay so so far so good because we have it so good to go next inside here this application is supposed to be wrapped inside our clerk provider so I'm going to grab our clerk provider and this clerk provider can be imported from clerk at clerk reacts and now the clerk provider is going to need the publishable key and the after signup URL so I'm going to say clerk provider like this okay and inside that I'm going to pass in my app and I'm going to pass the publishable key as well as the after signout URL okay and down here let me just make sure this looks good Yep this one looks good too and this is some stuff that we don't have to really care about it's just the IPC renderer essentially listening to events and stuff like that okay so you don't really have to bother about this now if you click into this app. TSX you're going to see this file right here right let's go ahead and remove everything from here and you can return a div and you can just say something in here like this and it should render inside your application okay nice now the next thing is we are going to need our react query uh react query and our client inside here as well so let's go ahead and grab that okay so I'm going to copy this Command right here and inside my terminal I'm just going to paste this and that should installed uh install react query for me and now that I have that installed I can import it from here say import query client and the query client provider and now I can do whatever I want in here okay so first thing go ahead and remove the state and since we don't need the state I'm also going to remove this import and now I need to First create a client right so I'm going to say const client equal to query client and then I also need to wrap our application inside this query provider so I'm going to say query client provider and inside this I'm going to pass in our new client so I'm going to say client equal to client just like this okay now in here we need to have um essentially our off button the widget and the layout for this app application but if we're using toasters we also need to import the toaster component so I'm going to grab that as well and the toaster component comes from soner so let me go ahead and install that so toaster just like this and I'm also going to render out toaster in here nice now I don't need these so I'm also going to remove this so it doesn't throw any errors and you shouldn't have any problems with your application as well so inside your folder structure right here you're going to create something called layouts okay and inside that you're going to create a control- layout. TSX now usually in a react application I like to name everything with capital letters now this is totally up to you you don't have to do it but I just like to do it because it makes more sense okay uh because these are components and they're not similar to routes so you can call this control layer. TSX like this and this is probably what you would see in a you know in a production environment as well now I'm going to going to go ahead and return a component right here and this is going to be called control layer because of the component name right here okay nice now this is going to need first the children and the class name prop so let's go ahead and grab that and let's destructure this from the props and now the first thing is we're going to create a state and this state is essentially going to check to see whether the IPC renderer wants to hide the Plugin or show the plugin and based on that we're going to set the is visible state to True okay so let's go ahead and create that state right here so is visible and is set visible and we're going to import UST State and this is going to be set to Fault by default now remember we had something called the IPC renderer right we're going to go ahead and call this method here call on hide plugin and we're going to pass in a callback function so it's kind of like I mean it's basically event emitor right think about it that way and I Al I'm also printing the event here so I can see what's going on and I have set is visible and I'm going to pass in the payload and the state okay nice so now once this is true down in here I'm going to render out a class name so I'm going to say class name and I also need the CN function so I'm going to say CN I'm going to import I'm going to invoke it and pass in anything that was passed as a prop for the class name and now if it is is visible then I'm going to set invisible to True okay so uh if is visible is true we'll render this if not we'll render in invisible right here okay nice and then after this we want to also pass in the default class names so I'm going to put a comma and I'm going to say the following class which is BG of this color Flex PX of One Flex column rounded 3XL overflow hidden and height screen and inside this let me see if I just return something okay it's not going to return and the reason is because I have to render out this component so let's go back one step and inside our app. TSX before the toaster we're going to render out our controlled layout okay so our controller our control layout is going to come from this folder so let's go ahead and install that and down here I'm going to go ahead and render out this component and the toaster can be outside that's totally fine okay and now inside this component we can render out the anything else that we want so now let's go back into our control layout okay so it looks like there's a problem with the Imports right because I'm getting this from a different file so I'm going to change this to controller layer or controller layout okay so there seems to be a problem with the spelling errors so layout like this and let's go back and I probably also want to change it right here this is why I hate typing guys I make so many spelling errors it's crazy but it's okay everybody makes problems everyone makes errors right so what's the issue let's see so this is a default export so we don't really need this okay nice and now this needs children and the props and we'll go ahead and pass that in so in here right now now we need to First create some components but let me make sure okay we still haven't completed our layout so let's go ahead and complete that first so inside this we're going to create another div okay and this is going to have the following class name Flex justify justify between items - Center and padding of five and then also we're going to make this element draggable okay so let me change this padding of five and I'm going to change this to dragable just like this and then I'm going to have our user button so I'm going to say span and inside that I'm going to change this to non- draggable and I'm going to import our user button component which comes from clerk okay nice now the next thing is I'm also going to have an x button right here so after this span we're going to show an x button like this and that's going to have a call back called onclose app and let's go ahead and create that one as well so inside your list Li folder you're going to find uh something called uols and inside the uols I'm just going to create this one in here okay so essentially anything that we need for our app we can put in here now just keep in mind guys this in no way is a production ready you know like structure or anything for our electron application I'm just getting it to work as fast as possible all right so you can go ahead and create all the folders whatever you want cuz I just showed you probably a 10-hour course on how to do this and I've also created more than 100 plus hours of free courses that teach you how to create a good folder structure and you know maintain a production ready approach to your application use the same principles in here as well okay but for now I'm just going to go ahead and set it up this way because I want to do it as fast as possible so basically when the user clicks on the close app we're firing an IPC renderer called uh close app okay and then inside our main file when we start up our entire application we're going to set up the listener for this event and when this event is fired then we're going to essentially crash the window whatever we need to do okay quit the window sorry not crash okay that's probably what we need to do in there so just wanted to give you a heads up that events are going to be across different pages and if you don't understand well it's very simple if we're sending something from here we're probably receiving it from somewhere else and if you're receiving from somewhere else we're probably sending it from a different file so just keep that in mind as we develop okay that way you're not confused and you're not lost as to what's going on so now I'm going to import the on close click Handler and now this x button can act as a close uh a closing option for our application okay so I'm going to also import X from Lucid react and now I have that component all right awesome and after this div guys right here go ahead create another div and inside this we're going to say Flex -1 height of zero overflow of Auto and inside this another div okay and this one is going to have padding of five Flex with a full and now one more div inside this and this is going to have image so image tag and the source is going to be the opal logo and right now of course I don't have this so I'm going to go ahead and grab that so open up the old code base and search for the public folder and click on opal logo and just copy this file and you can paste it inside your public folder okay so yeah so now I can copy this directory and in here the path sorry I can just paste this in here I'm going to say slash logo.svg and that's pretty much it okay for all tag I don't really know if it matters but I mean sure so I'm just going to say app logo okay all right now after this I'm going to create a paragraph and I'm going to say opal and this is going to have a class name of text- white text- 2XL okay and that's it that's for the starting part of our application now as you can see we have this window like this with opal right here right also made a spelling error somewhere so Flex where did I make that spelling error let me search okay let me just change this to flex items Center and GAP X of two okay all right nicer so this is essentially going to be one part right so it's kind of like the login screen and if you close this it's going to fire that event and not sure if we can see this here probably can't right but essentially you'll be able to uh close the application so one more thing I want you to keep in mind is in our application we're going to have three different entry points okay because all of our apps are handled as separate react applications and this this is some custom configuration that we need to do because technically whenever you show an individual window it has to be an individual react application in itself okay so it's going to have its own index file its own app file all that kind of stuff so this window this window right here it's a it's essentially a layout for our controller right so we're going to have the type of you know the audio files or the um the audio you know devices the screens and all that kind of stuff inside this one okay and also the login screen so that's why we have this x button because this is the only component that you can close the entire application with Okay so let's go back in here now that we have this let me see what other errors we have okay we also have to render out the children elements so inside this you see this height of zero right let me do one thing let me remove this and I'm going to paste this after this okay and in here we're going to render out all the children elements so I'm going to say children like this nice now let's go back and inside this we now have to pass in our children elements and the first thing we're going to build is our o button sorry I kind of choked there it's our o button okay so go ahead and you're going to say off button like this and you want to open up your folder structure you want to go into your components you're going to create a folder in here let me close this um where is that okay components we're going to create a folder called o um or sorry Global okay and inside this I'm going to create another folder called o button okay and inside this an index. TSX and now in here I'm just going to return a component and change this to whatever I want now this does not have any props so you can pretty much remove this okay we don't need this there's a lot of squiggly lines so you could go into your typescript and change that if you'd like but all we need right in here is the sign out and the signin button so let's go ahead and grab those it comes from Clerk and first thing I'm going to say in here is signed out okay and I'm going to wrap this component all the components inside this so first we're going to create a div with flex Gap X3 height screen and we also to have justify Center item Center and inside this we're going to have the signin button and then the sign up button so sign in right here and this is going to need a button right here and it's called sign in okay and I'm just going to provide the following Styles please pause and type okay and then the and the but button right after this is the sign up button so I'm going to say sign up button passing a button again and say sign up in here okay cool so now let's go back and let's quickly import our off button and that should not have any errors okay nice and next thing is we're going to need to set up um the widget okay okay and our widget is is essentially our media sources and everything that we need in terms of this specific application right so as you can see sign in and the signup and opal got pushed to the bottom okay I just had to scroll down so opal is right here so go ahead and sign in okay it's taking us to Clerk and just give me a second okay so I try to access my account and it's just giving me some prompts so let me go ahead and try to to allow all right awesome and now I can see the clerk icon great job guys okay another quick fix I made in here is I went into the controller layout and I removed the height screen from here okay that way it doesn't always take the full height of the screen and it's just kind of in one single location okay feels easier okay next thing we're going to do is we're going to go into our app. TSX and in here we're going to need to create our widget components okay so go ahead and after this you're going to say widget like this and open up your folder structure you're going to go into Global components and I'm going to create a folder called widget and inside this an index. TSX file now let's go ahead and return the widget component itself this component does not need any props I'm going to remove all the props for this component and in here first thing is we're going to need to get the user state right we need all the user information so for this I'm going to create something uh sorry I'm going to invoke not create guys we already have a hook actually I thought I could create a hook but I don't think I need it so let me go ahead and say const user equal to use user okay and you can invoke that and now you're going to get access to the user and once you get access to the user itself you can scroll all the way down here and let's go ahead and return a div like this with the class name padding of five and after this down here I'm going to show a clerk loading component and this is going to have a div with the class name height of full and then I'm going to put flex justify center items Center okay nice and then inside this element I'm going to render a spinner component which I don't have right now so I'm going to go ahead and grab that component and you can pretty much um grab it from the GitHub or you can go in here and you can just pause the screen and type okay but I just suggest you just get the repository once you're going to be typing forever so I'm going to say loader like this and inside that I'm going to say spinner or index. TSX and maybe it makes sense to call that component loader right not spinner so loader like this and I'm going to quit this rename this to loader and I'm going to import it from our loader file nice so now that we have our spinner components after the loading I'm going to show the signed in signed in component and the signed in component comes from clerk as well so let me go ahead and grab that stuff so in here I'm going to say signed in okay or not sign in guys sorry signed in like this and we also need I think this is enough okay just signed in for an now and here I'm going to render out the signed in component but the signed in component actually needs the profile profile info so what I'm going to do is I'm going to grab some of the information um for the user profile and I'm going to need to create a state to actually hold that user right so let me go ahead and do that so up here I'm going to say const and I'm going to call this profile and set profile and this is going to be equal to use State and let's invoke that and this is going to have a default type okay so this type is going to be as follows so let me go ahead and copy this and save you some time so it's going to look like this right we have status the user and this is going to have the subscription plan Pro or free and the studio information which is all the settings right so the ID the screen the mic the preset everything that they need including the camera and the user ID and then we also have the user information in here which is the string email first name last name created at en clerk ID or this this one will be null or this entire data will also be null okay and by default I'm just going to set this to null right now okay now you can take this and put it into a different file um but I'm just going to keep it in here and the next thing we want to do is we need to have a use effect that can fetch this information right so I'm going to say use effect like this and in here I'm going to return an empty dependency or actually I'm going to pass in the user information from here right this is right here and I'm going to pass that in here and first thing I'm going to do is I'm going to say if the user exist and user. ID exist then I'm going to do the following so I'm going to say fetch user profile info like this and it's another um basically a request an API request that we need to make so we'll do this inside the U tools file but first thing is this is going to need the user. ID and then I'm going to say do then so once this is completed this is going to take a callback function uh and all I'm going to do is set the profile to the profile we get okay and all right so for now this should be good so let's go ahead and create this so go into your Libs folder and click on new tools and in here you're going to go ahead and say export const fetched user profile equal to an arrow function and this is going to be an async function that takes in the clerk ID which is going to be a string and in here I'm going to say const response equal await HTTP client okay and the htdp client is not showing up okay so weird so I'm going to say htdp client. get all right so let's do this instead guys so open up your terminal and we're going to say npmi axios okay and go ahead and hit enter and right here first thing is I'm going to say const HTTP client equal to axios and axios is going to get imported from axio so I'm going to import that right here and I'm going to say do create and I'm going to pass in some options so I'm going to set the base URL equal to import meta environment. vit host URL of course we don't have this right so we'll create that in just a second but for now I think we could just pass in the HM I think we could just pass in Local Host URL right so let me go ahead and do that okay so I said HTTP Local Host 3000 and let's go back now and where do we have that call okay we have the call done right here so in here I'm going to say the following so I'm going to say await acdp client doget we're going to invoke this and we're going to pass in the Au route so we can to say Au slash and this is going to be the back tick sorry and I'm going to say dollar sign clerk ID this one right here okay now if this is good also we have to pass in some headers sorry about that so after this go ahead pass in an object and I'm going to pass in the headers and I'm going to say contenttype application. Json and after this here I'm going to return this response.data just like this okay now the first thing to keep in mind is if we need to make requests between this application and the other one we have to create something called as a proxy okay so let's go ahead and set up that configuration so right right below this right here I'm going to say the following and I'm also going to quit my terminal so I don't get any errors and guys this is something that you can't see in real time right we can't because it's going to keep constant refreshing the entire application and it's going to keep navigating me to the app okay but this is just configuration stuff so for now we're good to go so the first thing we're going to do is we're going to set up our proxy so we're going to say server and this is going to be an object and I'm going to put a comma after this and in here we need our proxy itself and we're going to set the proxy settings like like the following so I'm going to say slash in a string slash API what just happened so okay SL API and this is going to be an object and this object is going to have first the target URL and the target URL is going to be Local Host 3000 SL API okay and then after that we have to have the change origin so I'm going to pass the change origin origin in here as well and I'm going to set this to true and after that we need to have okay looks like this is in the wrong place this has to be along with the target okay so we're going to say change origin in here and the next thing is we need to pass in a rewrite path so the rewrite path in here is going to be the following so I'm going to say rewrite path path. replace this API with nothing okay so now we're going to be able to make requests now go ahead open up your terminal and you're going to install the following so I think we actually don't have this let me just take a quick look guys okay so I'm going to say npmi v- TS config - Pats and let me go ahead and install this package and we're going to scroll down to where you find plugins right here and after react you're going to pass in the plugins the plugin that we just imported and you're going to import it okay and this can be imported from the new library that we just installed okay now I'm going to go ahead and close my Vite configuration file and inside my app file I think I also have to import the widget itself okay nice and let me just take a quick look at this file okay so we can now import the fetch user information and that's it so now we have the users information right here and we also have to use this profile right so let's go ahead and do that right below down here so inside this signed in component we're going to say if profile exists then we're going to need to render out a uh component called the profile UPS the media configuration okay so media configuration like this and if not then we're going to render something else and here we're just going to render a div and this div is going to have a class name of width full height full Flex justify Center justify Center and items Center okay and inside this div I'm going to pass in a loader component and I'm going to set the color to white okay nice now for this component we can go ahead and create it but we're also going to need another server action right sorry not server action I'm so used to saying server server actions but we're going to need to create another hook and this Hook is called use media resources because we want to essentially get all the resources that the user had and we want to render their devices in here right so I'm going to scroll up top right here and I'm going to say the following so I'm first going to say const we are going to get a state or let me first put the other side of the equation which is use media sources okay and this is going to give us the state which we're going to get from this hook and we're also going to get fetch media resources okay so let's go ahead and build this out so you want to open up your folder structure and I'm also going to comment this out for now this whole section CU you don't really need it I'm going to scroll down and I'm going to click into my Hooks and I'm going to create the used media resource. typescript file now inside this I'm going to do the following so first I'm going to say export const use media resource and this is going to be an aror function and we're going to use the use reducer right here to essentially create a getter State and also uh pass in some reducers like get devices and you know anything else if you want to expand on top of this and we can use the reducer in here to essentially change the state in the future okay so right away I'm just going to say const State and action this is equal to use reducer we're going to invoke it and this is going to take the first one uh this is going to take an arrow function as the first parameter and um after that we also need to pass in the default data right so in here first thing is we're going to get state right and this state is going to be of a specific type and that type is going to look like this so let me go ahead and create the type up here it's called Source device State props okay we're going to have displays audio inputs error and is pending and for each of this app icon display id id name thumbnail and um down here for audio it's going to be device ID kind label group ID and that's pretty much it so pause and type this out okay so now here I'm essentially going to call call this one um and say the state is going to be of this specific type and our other one is going to be an action and our action is going to be um you know a bunch of different action props so I'm going to scroll up here and I'm going to say type type like this and we're going to call this display device so display device action props and we're going to have the first type called get devices and the payload for this is going to be the exact same thing okay so this type right here and right here I'm just going to pass in that type for the action now inside this first of all I see an error here um let me see what's going on okay let's just fill this up and then maybe because we're not returning any data it's screaming at us so we're going to need a switch statement and the key here is going to be action. type and for the value here I'm going to say if this is equal to get devices then I want to return the following okay and down here I'm going to return the the state itself for default now inside this section I want to First return a return all of the devices that I currently have so all of the state data so this one but I want to also pass in the action. payload okay so I'm going to say everything inside state but we're going to pass in action. payload okay um what seems to be the issue here okay I have to use a spread operator for this one as well all right right nice and by default we'll just return the state itself now after this purple one I'm going to create another object and now I have to pass in this the default data right so my displays the audio inputs and is pending is going to be like this so I'm going to say display like this displays are going to be an empty array audio inputs and empty array errors it's going to be null and is pending it's going to be false okay now now right here at the bottom we're going to need to create a function called Fetch media resources and we are going to essentially return the state and the fetch media resources so we can essentially get all that data okay uh and we can also do it inside the component so that's pretty much it so I'm going to say const and this one's called Fetch media resources okay this is equal to an arrow function and this aror function in here is going to essentially invoke this action and we're going to fire this specific type we're going to dispatch an action to this reducer okay and now guys if you want to see a much more in-depth breakdown of the entire um you know user reducer and how you can pretty much build your own Redux Library completely from scratch then you can watch the plural video and you know pretty much any video I've created in the past so I've done this a thousand times and I've explained it in Great depth the plural video is going to pretty much explain everything for you okay so you can watch that video if you want more guidance but right now this is the simplest way for us to set this up so I'm going to just invoke the action and I'm going to pass in the type in here and the type is going to be get devices and then I have to pass in the payload as well and my payload is going to be an object with is pending set to True okay and then down here uh I'm also going to return an object first so I can get rid of these errors and the fact media resources okay much better and now after I invoke this action I want to essentially call another function that we're going to create from our utils folder and that is called the get media resources okay it's a it's essentially an API request so I'm going to say get media resources and let me go up top here and first let me just go into the uols file and I can create this so export const get media resources is going to be an async function okay and inside this we're going to make that request okay so first thing we're going to do in here is I'm going to say uh displays equal await window. iipc renderer do invoke get resources okay so let's go ahead and say this just like this and then after that we have to say const enumerated devices is equal to window. navigator medad devices. enumerate devices okay we're going to invoke this now guys this is all syntax stuff so don't worry about it just keep typing even I was completely clueless um because electron is very new to me and you know I had to make this work so I found the code just use this and if since you have cursor you can highlight everything and you can ask cursor AI what it does okay but just follow through with this we're going to be here forever if I explain every single thing so next we need the audio inputs right so I'm going to say audio inputs equal to in your ated devices. filter and we're going to filter for this specific device so it's a callback function right so this is going to give us the device itself so I'm going to say device here but if the device doind doind is equal to audio input then we're going to return this okay and make sure there's no spelling errors here right don't take this one it's audio input not audio output and then you can console.log a message here that says getting sources okay so we know what's going on and then you want to also return some data so I'm going to return this right here saying displays set to audio okay oh sorry guys displays um like this so This display is right here we're going to return that and the audio is going to be as follows it's going to be the audio inputs okay awesome so now we can go back and we can import the server action sorry I keep saying server action we can import this API this API call and then we can say then and in here we're going to get access to a callback function okay so now first we're going to get these sources and inside this we're going to say also remove this guys it's not a we're not this is not an action in here right we're returning something returning data so let me just bring this back so in here I'm going to return action I'm going to invoke it and in here I'm going to pass in the type I'm going to set it to get devices and then I want to set the payload and the payload is going to be displays set to sources which we're getting from here right sources. displays and then we also need the audio inputs so let's go ahead and say sources. audio and I also need is pending and I'm just going to set it to false okay nice now let's go back and let's invoke this hook right here and now we have some data okay so let me go ahead and also console.log the state and the um let me just console log State and see what's going on all right so one more fix we need to make here and I totally forgot about this if we're trying to fetch the users's information if you see right in here we have the fetch user profile we're making we're making an API request to au/ ID right so now if we don't have this set up on our code in our code base right here we're not going to be able to listen to it so we're going to we're not going to get any data back okay so we need to fix this first so what we're going to do here is go back to our codebase which is our browser our web application and in here we're going to create another route called a and inside that create a dynamic route called ID like this and a route. typescript now inside this route. typescript we're going to export a get function okay and I'm going to call it like this and the first thing we're going to get from our parameter is the request so I'm going to say request is going to be next request from next server and we're also going to get some pams right so I'm going to say pams and I'm going to destructure it right away so why is this not showing up so pams like this and this is going to be an object with pams and this is going to have ID set to a string okay now inside this I'm going to first go into our database I'm going to say const user profile equal to await client. user. find unique and we're going to get the user ID right so we're going to say where the clerk ID clerk ID is of type ID so the sorry the one we got in the param right so that'll be ID that's correct and then include because we're going to get some data from it we want to get the studio information and we want to set this to true we also want to get their subscription plan so we're going to set this one to true as well and now it looks like it's saying cannot find ID in here let me see why that's going on okay it's because I haven't destructure it from here right so I can say ID like this and now I can call that down here and once this is done we want to make sure we have the user profile so down here I'm going to say if user profile exist return a next response and send the Json data to that uh call so 200 response and send the user profile now the next thing is down here I'm going to say the following which is if the user does not exist then we need to create the user right so we're going to need the clerk client which comes from next JS uh from clerk nextjs server and we're going to need to create the user down here so in here I'm going to say const clerk user or instance this makes more sense so instance equal await clerk client you want to make sure you import it and then we're going to say users. getet user and then import this and you want to pass in the ID okay and now down here we're going to essentially say const create user equal await client. user. create and we're going to invoke this one and inside it we're going to pass in the data so there's a lot in here so please just follow through with me first one we need is the clerk ID then we need the email ID next we need first and last name so let's go ahead and pass that in as well then we need the studio information so I'm going to say studio and we're going to create an empty data so all the default data then for workspace I'm going to create a workspace along with their name right as your first personal works space and then after this down here I'm going to create a subscription and just use default data for now and then after this down here which is after the data so once we create we also want to include the subscription and we're going to select the plan okay and now after this all the way down here if we created the user and everything was successful we need to return a201 response right so I'm going to say if user exist if created user exist then I'm going to to pass in the uh return a next response with Json of two status of 2011 and I'm going to pass in the create user okay and also I just want to make sure uh this clerk ID was set to pam. ID but here you just want to change it to ID okay and for email I'm just going to extract everything from the clerk instance and that should be good to go now if this failed then I'm going to return a 400 and also maybe console.log and say say error and you can also put this in a TR catch if you'd like but for now I'm just going to say error occurred here or maybe let's do that guys so let's wrap everything okay let's wrap it inside a bracket like this and I'm going to scroll up here and I'm going to say try and at the bottom I'm going to say catch like this okay and inside the catch I also need to get access to the error I'm going to say error and I'll pass the error in here okay and if this endpoint is hit I also want to know so I'm going to say console.log endpoint hit and maybe we can pass in an emoji right something like this okay nice cool all right and it looked like I made another error inside our environment file so go back to our opal uh the electron version and inside V hosted URL you want to change this to API okay/ API and now now if you go back to our endpoints right here and if you open our application and if you refresh this awesome and if you take a look right here it's saying end points hit and we got a 200 response from this okay awesome all right guys so the reason why we were not getting any data back was because we were getting the cores error now there is a much simpler way of approaching this and fixing the problem and resolving the Coors problem but the good news is we are hitting the Endo even without the fix and we were still getting a 200 response okay it's just that it was blocking us from you know pretty much getting the data back because of course okay and by the way if you don't know you can actually open a uh Dev tool like this in here by clicking on view and clicking toggle developer tools okay that's how you can open this inside an electron application all right so yeah guys that was um that was a problem and the fix I got for this was I mean again thanks to the cursor AI because I can I all I did was I created a nextjs documentation uh I think it's called a composer and you can literally call the doc Itself by just passing the URL right and if you don't know how to do all of this it's totally fine you don't need to because I already have the code but I'm just telling you what I did right so I basically created a composer and I think it's command K if I'm not wrong something like this I totally forgot what I did but I created a composer and inside the composer view I essentially added the nextjs documentation and by just providing the the website and it automatically got all the code for me and it told me exactly how to fix it now the first method was to install cores and do a bunch of setup and I wasn't really interested in that stuff um because I know there you don't really need to do that right I'm just having some weird errors and I will probably find a better solution but this is uh pretty close to a decent solution so the problem is our nextjs application does not recognize this as a as an allowed origin right so we can do that inside our middleware file so you want to go into our web application version and you want to scroll down into your middleware typescript file and this is what it used to look like so you probably had something like this right you want to basically redo this file okay you can keep this configuration stuff at the bottom the exact same um we only need to change what's happening in here so essentially first we're going to create um a variable called allowed Origins and then we're going to pass in Local Host 5173 and then 3,000 of course in here and then inside this variable course options we're going to create access control allow methods we're going to say get postp put delete and options and same uh the control allow headers now this was methods this is headers and we're going to do content type and authorization okay so once you have these cores options next down here this is by default it's already there I guess right yeah you see this we already have this it's essentially just the protected routes and inside the clerk middleware we're going to have this call back back right the exact same thing as the previous one but inside this first we're going to check the origin so we're going to we're going to say request. headers do get origin and we're going to see if it is an allowed origin so allowed Origins this one do includes the origin that we just got if it's a part of that then we're going to handle pre-flight requests and how do we do this well pre-flight requests are essentially the first request that's made right so we're going to say if request. method equal op options this is essentially the pre-light flight request then we're going to say const pre-flight headers equal to an object and in this we're going to conditionally destructure right here we're going to say is allowed origin if this is true then we're going to conditionally render out uh sorry return this object with allow uh sorry Access Control allow origin and we're going to pass in the origin okay and then all of our cores options that we just created up top right in here okay cool and then we have to return next response. Json and we're just going to pass empty in here but we're going to pass in the headers and these this is going to be our pre-flight headers next we're going to handle any protected routes and this is by default already done above right so if uh this is basically for clerk so we already had this before so if it's a protected route then we're going to say au. Protect okay next for simple requests um we have have to say con response equal next response. next and then if this is the allowed origin then we want to say response. headers do set and we want to say Access Control allow origin and we have to pass in our origin right here okay and then object. entries um is going to essentially get us all of the key and values right you can read this if you don't know this is just JavaScript stuff and we're going to pass in our cores options in here and for each of them we're essentially going to set a response header that's it so we're going to grab all of these values right these key and value each of these and we're just going to create a header for it so response. headers doet the key and value that's it okay and then return response and this can stay as is and now if you go into our application and you refresh refresh the electron version you're going to see status of 200 and you're also going to see all the information of the user okay great job so let's go back to our app do let me search okay so this is the desktop app so this is good so in here you're going to find the app. TSX I'm going to go into the widget and down here I essentially have this part where I was rendering something right so now I can remove this and basically by default it used to show that loading icon but now it's no longer going to but the problem here is I don't have this component yet right which is the media configuration component so now that we have all this data we can go ahead and create this component and pass all the information okay so first thing you're going to do is you're going to go ahead and open up this component so let me go in here and I'm going to create a page in here first a folder called media configuration okay and inside that an index a page called index. TSX okay and you can put the same thing in here if you want as well but um let me change the spelling here okay nice I'm going to return a component and I'm going to rename this and we're going to have some props here now please pause the screen and type this I will go absolutely crazy if I sit and type everything okay but basically this is the type that we're going to get just the user and the state that's it okay pretty much the same thing as the previous one and let's go ahead and get our source device State props as well we're going to import that okay nice and down in here I can essentially destructure these values which is user and the state itself okay nice so inside this component all we're going to all we're going to be doing is just check to see if the user has a source if not then we're going to use the First Source that we're going to get from their you know from uh from all the uh what do you call that the media files sorry the media uh devices right and we're also going to render all of them out inside here okay so let's go ahead and do that so let's go back and quickly import this component right here and inside this we also have to pass in this prop so let me go ahead and say user and state like this and now I can create a form element inside this so I can create that um you know pretty much the drop- down items for them to select from right so inside this I'm going to say is pending so if we're still fetching for something or actually I don't think we need to do this yet let me just think guys give me a second okay so we have to do this right now and it's a hook that's essentially going to give us all these Studio settings okay so for example which screen the mode such as HD or whatever mode the user the user needs we're going to get all of that information and we're also going to get use mutation and pretty much set up all that stuff in here so we can basically send API request to update the Studio settings as well every time the user changes stuff okay so there's a bunch of things we need to do inside this hook so let's go ahead and set that up so first thing I'm going to say is const I'm going to create this object here and I'm going to set this equal to use Studio settings and guys there's an a bunch of other setup that we also have to do and um such as you know rendering the right files and stuff I mean electron is just a is crazy okay it's not very simple um things are just all over the place but that's just how electron works I mean it's a desktop application right so go ahead copy this we're going to open up this folder structure we're going to go down to hooks we're going to create another hook we're going to call it use Studio settings just like this and first let's go ahead and Export const U Studio settings which an arrow function and I'll also zoom in so you guys can see slightly clearly much more clearly and why is this not going away okay just close this nice and now in inside this we're going to get some props so let's go ahead and grab those props sorry guys not props it is the parameters that are being passed in right and next we're going to need the use Zod form hook okay so use Zod form is essentially going to help us like you I mean I hope you remember like you remember it's essentially going to help us register the input field so go down into hooks we're going to create use Zod form okay. typescript and in here I'm just going to do the following so essentially I'm just saying use Zod form and we're using generics here so you don't really have to care about this stuff um AI pretty much helped me get it you know perfect perfectly typed okay so essentially it's a function which gets the schema and the default values and we're using the use form hook right from Hook forms and we're passing in the resolver and the default values and we're just returning the register error handle submit watch and reset okay so let's go back and now we can use this in here so I'm going to say use Zod form like this and I'm going to import this form and next I'm going to destructure and say give me register and watch and of course this one is the schema which we're got which we have to create but we're going to need to also pass in a schema in here and for the schema file you can just open up your folder structure and I'm going to shrink everything and inside source I'm going to create another folder called schemas okay and in here the first one I need is my um my studio settings right so Studio Das settings. typescript and in here you can oh sorry guys not typescript it's do schema. typescript okay and in here all I'm going to do is say Zod uh Z from Zod z. object and it's a screen audio and preset and these are all strings okay but the preset is an enum which is hdnn D okay so let's go back and now I can import my schema okay nice and now I need to get these I mean I already have these two values but it's not being used anywhere so it's just you know kind of screaming uh watch has assigned a value but it's never used okay that's good to go so next I'm going to create a state here that's going to save the preset okay so I'm going to say use state so on preset set preset equal UST State it's going to be one of these types are undefined and for now we we can just pass it nothing okay next we're going to need use mutation and use mutation is going to help us update the studio information if the user changes anything okay so that mutate function that we're going to get from here we're going to return to the front end and every time the user changes the dropdown right they can we essentially we just fire the mutate and let me also show you what this looks like so you have an idea all right there we go so hopefully now everything makes sense this is the opal page there's going to be an exp Mark here this is just a rough mockup and you know we're going to have the tray right here we have this and then we're going to have some more components right we also need the users uh screen sharing right and also the overlay so we can show the user face if they have a camera so all of that stuff so essentially when they change this we need to save the information so these are the drop- down items that I'm speaking about okay so let's go back now and in here first thing I'm going to do is I'm going to say const I'm going to destructure some data from the use mutation hook so use mutation like this let's invoke it and inside this we need to first pass in or I think I can also get mutate here and is pending first okay nice and in here we need to pass in the mutation key so I'm going to say mutation key is equal to update Das Studio okay like this please don't make any mistakes here okay take a look at the spelling and type correctly and then the mutation function is going to be a callback function and this callback function is going to give us data from here but we're going to destructure some values from this so the first thing we're going to need is screen ID the preset and the audio so let me go ahead and say screen ID audio and preset okay and I'm also setting some types on these values and now inside this I'm going to have the server action so or the API call so essentially I'm going to say update Studio settings not schema just uh just settings and this is the API call that I need to create so I can pass it with this mutate okay so go into your Libs folder and click on utils I'm going to scroll to the bottom going to say export const I'm going to paste this use uh the update the update call right and inside this this is going to be a arrow function and now this is going to need some props I'm going to go ahead and get those props which is ID screen audio and preset and next in here I'm going to make that call okay so the API call essentially so I'm going to say const response equal await HTTP client um if it will give it to me okay and also make sure you change this to an asnc component okay and down here I'm going to say await client. poost okay post endpoints and in here I have to send this to the studio endpoint and this needs to be um the backt guys and I'm going to say dollar sign curly bracket and pass in the ID okay and next the next value I need to passing is all the data so I'm going to say screen audio and the preset so in case they change that stuff and after this I'm going to pass in one more which is the headers so I'm going to say headers and I'm going to pass in the content type so content type and I'm going to set this to application- Json so I'm just going to copy this so I don't make any spelling errors okay nice and if um we don't need to check we can just return the response so I'm going to say return response okay uh or response.data is probably better all right nice now let's go back and let's call this let's import this uh function and now that we have the data we uh now that we have this function here we also have to pass in all this data so first thing is I'm going to say data do ID so this one okay so make sure you don't pass this in right you can just pass this data from here so data. ID data. success uh sorry do screen data. audio and then we also have to pass in the data. preset okay nice and now once this is done we also have we also want to have an on success function and this on success function is going to help us essentially invoke a uh send a toast message okay so I'm going to going to say on success and this is going to be another error function okay and this is going to give us the data and in here I'm going to return a toast from sonar and I'm going to say data. status if it's equal to 200 then I'm going to return success and if not then I'll return error okay and let's change this to success nice and it looks like something is wrong in here as well what seems to be the problem oh okay this is the error here okay and next we also have to pass in the message so description is going to be equal to data. message like this nice so cool now we are done with our Ed mutation and at the bottom I'm just going to go ahead and say return and for now I'm going to need to let me think about this what if I could have a a use effect that could essentially do this for that component so what I mean guys is inside this form we also have something called watch right so we could just use the watch to listen to the element changes and then accordingly we can just fire the mutate function that might be better right so we can do that all right that was just a good idea anyway I'll do that later I just wanted to remember so I just say it out loud so I'm going to first create a use effect and this use effect is going to fire our IPC renderer okay and the IPC render is like I like I said it's kind of like an event amiter we're going to send an event and we're going to listen somewhere else okay and I'll tell you where we're going to listen to this specifically we're going to be listening to this um inside our main file okay and when that happens that means when we get that data we'll also pretty much you know push the content to our to our feed whatever we need to do with it doesn't matter right we just need to know that we're sending data from here that's pretty much it so let's create a use effect to do this okay and we're going to pass in uh an empty dependency array and in here we're going to say if screen exists first and the audio file exists first so not audio file audio device and then the preset exists as well then down here I'm going to say window. IPC renderer not window store guys sorry about this let me go back one step window. IC renderer do send and we're going to send media- sources okay don't make any spelling errors here and next we're going to have an object where I can just pass in all this data so I'm just going to say screen ID a uh audio preset and the plan okay done now let me do that other use effect here so essentially all we have to do is is you know mean we have to listen to watch right so I'm going to say use effect not use reducer use effect and this is going to have have a callback function and in the array we're going to need to pass in watch okay so now we can listen and based on this this is going to invoke again now we need to create create a subscription so I'm going to say const subscription well technically the watch is a subscription so I'm just going to say subscribe equal to watch and I'm going to invoke it invoke it and I'm going to pass in the Callback function okay so keep in mind this in itself is a subscription okay we don't have to create another one and in here I'm going to need to first set the preset value so I'm going to say set preset and I'm going to invoke it and pass in the values um and the value that I okay I can get the value from here so I'm going to say values in here and I'm going to say values. preset and next I need to fire the mutate function right because every time they change it we want to fire this so I'm going to say screen okay and this is going to be equal to values. screen and I'm just going to put this exclamation point right here and then ID is going to be like this and then we need the audio which is going to be values. audio and then we also need the preset which is going to be values. preset okay awesome now after this we're going to essentially send the user ID to the second screen okay so um this media resource right here is pretty much the screen that we need to where we need to listen to all this info and then render the information out right so we need to send that info to that screen again so we're going to make another call right here sorry another IPC render event trigger and we're just going to send the same information okay so inside this use effect I'm going to say window. IC renderer and I'm going to say do send and I'm going to pass in media Das sources same exact thing okay and in here I'm going to pass in Thea I'm just going to copy this where is that so screen um oh okay I might need to okay this is fine no problem so I'm just going to copy this and here I'm going to say screen from here okay so copy this entire event and move it into this watch okay and inside here we're essentially going to pass in these values so values. screen and this one is going to be ID this one's fine no problem so let's set this then audio is going to be values. AIO then preset is going to be values. preset okay and then plan is going to be values uh plan or actually we can just pass in the plan that we have above okay cool next we need our cleanup function okay and in here I'm going to say I'm going to return the subscription and I'm going to unsubscribe okay awesome now finally I need to return all of this so because we're doing the watch thing in here we don't need to return the mutate function if not we would have to do this inside the component so it doesn't really matter but this is probably a better approach and in here I'm going to say is pending and then I'm going to pass in the uh return the on preset as well all right let's go back now and call this use Studio settings hook so I can do all of this magical stuff behind the scenes and now down here first thing is I'm going to get access to is pending on preset and register so I'm going to get those and now I need to essentially pass in all this um all the information this that this hook needs right so let's go ahead and do that as well so I'm going to say user ID like this I'm going to pass in this screen okay if not I'll pass in the state that we're getting from here so state. display at 0. ID so essentially guys if you remember in the beginning I explained what we're doing right I explained how we're getting the media files and if the user does not have anything then we're going to use what we have what the user has on their device right so we using the first one in the array that's pretty much what we're doing right here so um so I hope you remember that's why that that section was so important so go back and watch that if you haven't okay good now now that we have done this part we have all this data another thing I want to do is I want to get the active screen and the Active Audio that way I can render it out inside this place right so let me go back to our code and right here I'm going to say const active screen equal to State DOT or not stat state. displays. find and in here I'm going to get a call back and I'm going to say where the screen this is going to give us access to a screen right so I'm going to say where the screen do ID is equal to the users Studio preferences so Studio do screen okay and then I also have to get the active um audio so I'm going to say con Active Audio equal to state. audios audio inputs. find okay and for this it's going to give us the audio or device maybe right we're going to find where the device. ID or device. device ID is equal to user. studio. what is this okay user. studio. mic okay awesome all right what seems to okay we have to put this condition right here all right nice so now we have any active screen we have the active screen and the Active Audio as well so let's go ahead and try to render out something so of course you're not going to see anything right now and the reason is because I don't think we're passing in all this data so let me see right here okay we have this State and we have the profile information and what else seems to be the problem we're getting undefined cannot read properties of undefined at 42 so right here screen user. studio. screen. ID okay this part so clearly the user does not have this so we're going to try to get what we have in the state and since we haven't stored anything in this state and let me show you that so right here we're getting this state here from the used media sources right as you can see um let me see if I can show you clearly right fetch media sources we're going and getting this and we don't have any data we also have to store that somewhere so we need to make sure to do this okay so I solved the problem by putting this but that's not the solution really because we still need to get the users information right we still need to get the users devices now one thing that I notice is I'm not sure if this component is actually being fired well it is here I see the state index at 48 so I see it being printed and it gives me the correct information whatever I need but what I mean by this is if you go back to the previous components the fetch media resources right here should should essentially fetch some data for us this one right here right so I think there's an error happening in here and I'd like to chain this with a DOT cat and I think it's right here catch and I want to render out the error if anything happens so I'm going to say console.log error and I want to see what's going on if there is any error in the first place right okay so I don't think there's any error but something has to come from here right so what's going on in here so if you go into this you can see we're essentially invoking the IPC renderer but IPC rer renderer needs to also listen to this so there's a bunch of steps that need to be in place so if you see we're only doing get resources in here only in this page right so I think this is a good time for us to go go ahead and move on to the other part which is doing the setup to get everything else uh like the windows and stuff set up okay so first thing we're going to do is we're going to go to our main. typescript file and in here we're going to do a bunch of setup for our application and we also need to create three different entry points for different Windows okay so let's just take a quick pause right let's take a quick pause from the other stuff we were doing and let's go to this and then hopefully um as we keep building and getting our um you know all the windows and all the information we need then we might be able to proceed further from here okay all right so first right here we have one window being created this is inside the main. typ script under electron we have a window being created for the entire browser window right so this is pretty much good to go right here but we also need a bunch of other windows and that's why I was explaining saying we have to create multiple different windows for this application so I'm going to say let studio and that's also going to be of a type of browser window like this and we also need another one and this one is called the floating webcam which is also like a tray okay so I'm going to quit the terminal right now because we don't really need it for a little while and then when we do we'll come back to this okay and now down in here you see we have a bunch of settings for this window for the main window we have the icon the web preferences and so much more but we need to do more on top of this so first we're going to set the width the height the minimum width and the minimum height as well so I'm going to add those in there and now let me go ahead and say npm run Dev okay and I'm going to close this window and I'm going to render this one and let's go ahead and open the terminal as well um the console so we can see anything if needed okay so now that we have this we're setting the width and the height let's save this and let's take a look okay you see the width and height is set to a certain uh certain width right let's set it to 200 and let's to see what happens okay I think it's it's an entire browser window inside this but I think you get the point right you can change the width of the window like this so go ahead and Shrink this window and now if you go in here and change this to 200 now you'll notice that this window will shrink okay I have a better version right here let me close this one okay you see so it's shrinking accordingly if I set this to 500 same thing it's going to change in size okay you're not going to be able to see it because it keeps refreshing the other one was not refreshing because it was on full screen so I'm going to set this one to 600 okay nice next I want to give it a frame and I'm going to set the frame to false I'm going to also want to remove this background here right so remove this background right here I want to remove all of this stuff and for that I have to set some settings as well so I'm just going to copy this once and for all because it keeps throwing me back and forth between different different window windows and it's hard for me to show you guys right so first thing is I'm going to copy this and then I'll explain what we did in here it's very simple stuff okay so let me go ahead copy this and let me paste it in here so first thing is we set width height minimum height like this the Min width to 300 frame to false transparent to True always on top to true focusable to true and the icon is the same thing and the web preferences we're going to add def tools true context isolation true node integration false and preload we're going to set this to preload do uh MJS the same thing that it had before all right so the cool thing now is this window can be placed on top of any other window okay so it's going to be like a layover but you notice we still have this white border so turns out the frame is actually the one with the uh with the menu options right like cancel and Shrink right and even if I set the background color to anything it doesn't really matter doesn't change anything okay so that's something to keep in mind so how do we do this well we can go into CSS right here which is inside our source and you should find your index.css file inside here and we need to change the background color right here okay so I'm going to set this to transparent and that should pretty much um okay looks like it's not removing it give me one second okay it did remove it but the problem is you need to refresh right so I'm also going to add overflow hidden on top of this and now I'm going to go in here into my main file and just save and that should reboot into this now the other thing is you might want to make this light mode so um I mean it's up to you your pre uh personal preference because you know you want it to stand on top of um most I guess overlays right so you could technically put a border on top of this or you could change the background to White it's totally up to you um I'm going to go do some U modifications to this and I'll tell you how you can improve it all I did was I changed the I added a border and I did that inside the layout file so I went into layout right here and inside this I added border two border neutral of 700 okay so that's going to look like this now if you're wondering why is your not yours not mounting to the top of the screen well the reason is because we haven't done part yet okay I did it on my end just to test it out and uh if you're not seeing it it's because of that okay but first we just created this window um so I'm going to scroll down here and I'm also going to need to create the other windows as well okay so here I'm going to say Studio equal to new browser window we're going to invoke this and I'm going to pass in some of the styling okay and also I'm just going to quit my terminal for now because it's going to keep routing me back to that page and sending me back and forth but so here first I'm going to have some width height the min max same exact thing okay so let's go ahead and do that so width of 400 please pause and type with me okay height of 50 Min height of 70 Max height of 400 Min width of 300 Max width of 400 and for this as well we're going to say frame false transparent true always on top true focusable false as well and now for this we're going to need an icon path well I'm just going to use the same thing that I have above here and we have also have to add the web preferences right and it's pretty much the same so no integration the same thing as false true for this true for Dev tools and the path is going to be preload do uh MJS okay now for the next window uh this one is called the webcam right so let's go ahead and say floating webcam equal to new browser window let's invoke that and for this we're going to pass in the following style so I'm going to say width height Min height Max height Min height minwidth Max and Max width and frame I'm going to set these values and let me close this and after this I have to also put the same thing which is the uh frame um sorry transparent true always on top true focusable true and icon path uh like this now if you're wondering even though we're saying always on top true here why is it still not working well the reason like I mentioned before we have to uh we have to essentially let it know that even on the full screen we want it to be visible right right now we haven't done that so we'll go ahead and do that once we're done with this window okay and finally I have to add the web preferences I'm going to say same exact thing okay copy and paste this down here then after this now we're going to essentially tell all these windows to load on the main screen okay so for this first I'm going to do the um the window for the window itself this one right here w n right so I'm going to say window like this also I made some errors here guys let me make sure I use the right okay it's just not used somewhere that's why it's throwing that okay so first window. set visible on all workspaces we're going to set that to True visible on full screen and set that to true so now this will uh pretty much put that window on the main screen okay even on full screen and then down here for this we also have to add another setting which is set always on top so on top of everything this component window will always show okay then for Studio we're going to do the exact same thing so here I'm going to do studio. set visible on all workspaces true and say visible on full screen true and then down here set always on top top to True screen saver and one okay this is just syntax stuff don't worry if you don't understand I promise you this project is going to be so rewarding when everything works okay so now down here I honestly don't even know what's going on here but I think this is just once the window starts to load right but you don't really have to Bo don't have really have to care that's just I'm the reason why I'm sharing that with you is that you don't have to know every single thing okay they just have a boiler plate that runs under the hood now I also want to do the same thing for did finish load but for the studio okay because once that happens I want to essentially fire um some sort of an event okay so what I'm going to do in here or not really fire I essentially want to create the do the the same step for the other window um as well okay so studio. web contents um like this web contents going to invoke this and going to sorry it's do on so on did finish did finish load this specific event we're going to pass in the Callback function that's going to do the exact same thing that is done right here but for the studio uh version okay so studio. webc contents. send main process message new and you're going to pass in local string okay that's it then down here we have this if Vite Dev server URL um I think essentially let's see I think this comes from our environment variable right process. env. vubl okay um all right nice and that's by default it was already there right we did not touch anything and but what we have to do in here is we also have to load multiple different files okay so how do we do this so right now this window is loading this specific index.html but we're going to need a a separate HTML for the studio and for the floating webcam as well okay so what you're going to do is scroll down here into your file we're going to create another file in here we're going to call the studio. HTML okay it has to be in the root of your folder all right please don't make this mistake and then we're going to create another one we're going to call it webcam. HTML just like this okay okay so we have the studio file and this one so first let's go into the studio file and we have to essentially add like a boilerplate HTML boiler plate in here and I think we can do this with Doc five or uh I used to have a ah I forgot anyway we'll just type it out so first thing or let me see if I can do HTML H oh I used to I used to use a snippet to give that for me but anyway so I'm going toate create an HTML uh tag right here I'm going to say language is English and inside this HTML I'm going to pass in the head tag and in the head tag I'm going to say meta character set utf8 the link for essentially you know for the icon so link relation icon Type image SVG plus XML HF is v.svg and The Meta uh a meta tag in here that says name viewport and the content is going to be with equal div minus width and initial scale is going to be one uh 1.0 okay and for the title you can uh set it as whatever you want right now since this is the studio I'm going to say Studio okay like this and then we need to have a body tag so in after after the head tag we're going to say body we're going to create the ID root because react is going to need this root element to pretty much render right and now we have to provide the script as to where it has to load Lo this file from and the file that's going to load all this react stuff from is Source SL uh Studio uncore main. TSX and of course we don't have that right we don't have that file but we're going to create that file eventually and inside that file we're going to have all of the react related stuff and by react related stuff what I essentially mean is we're going to have the the one for the studio okay so down here we're going to create another file so I'm going to say like this and this is inside my source right root of the source folder and I'm going to call this file Studio do uh Studio cor main. TSX okay the exact same way we said inside this HTML file okay not this one where is that HTML file okay it's right here okay Studio main. TSX perfect okay and all we're going to do in here first is I'm going to go back to the other main. TSX file which which is uh not this one the main. TSX right here and I'm going to copy everything from here and I'm going to go into my studio Main and paste it in here okay so paste that component and this app component is going to change soon so we're going to create another one in here and let's say like this uh create another file we're going to call this studio cora. TSX okay and now we're going to go into this component and instead of importing in this from the app. TSX we're going to import it from a different file okay so dot slash um okay do slash and I need to add the studio app. TSX okay um looks like I'm making an error here sorry guys I'm in the wrong file I have to go in here and then make the change inside this one so here I'm going to change this to/ studio app. TSX okay now of course nothing is being exported from here so we have to go ahead and Export that so I'm going to click on the app. TSX in here copy this component click on Studio app. TSX and paste it in here so it just solves that error for me okay nice that's it okay now inside this component we're going to have a studio tray component and the studio tray is going to render you know our pause the square button all that all that kind of stuff right remember I showed you the design that's pretty much it so what I'm going to do here is for now I'm I'm just going to remove this and I'm just going to have a an H1 tag H1 or H2 or H1 actually and inside this I'm just going to say Studio component okay and let's remove this let's remove all these so I don't have this error anymore and now I know this is the studio component and in here we're rendering the right component all right awesome now we also need to tell our Vite configuration file where to get this uh where to essentially get this file location so it can use that as an entry point okay so click on your invite. config file and I'm going to hit enter here and during build I'm going to tell it that you are going to get these entry points from these specific files okay so the empty out directory we're going to set that to false and we're also going to set manifest to true then the out distribution folder or output directory here is going to be for now I think I'm not sure if it's going to be dist electron or dist but I'm just going to put dist because I think when we build it's going to create another folder for us and then we have to get rollup options okay and if you don't know what rollup JS is you can take a look at it um and let me see if I can open it and give you some information on it as well so rollup essentially is a module bundler so very similar to something like web back and um you know other type of bundlers that we have rollup is essentially used inside electron so I'm going to go back and I'm going to use this in here and I'm going to invoke it uh sorry I'm going to pass in an object for it I'm going to say the input which is the files that you're going to you need to expect are going to come from here so the main file is going to be we're going to say resolve directory name right so this is uh how we get directory structure in nodejs right so you're going to say directory name like this with two underscores okay and we're going to say index.html and this resolve actually comes from node path so let's go ahead and import that so I'm going to go up top here okay so I've already imported path so I need to just get the resolve from this as well okay nice and after this we need the other Studio import as well input as well so we're going to say Studio like this nice and now we can go back to our main. typescript and let me search for this where is this exactly okay right here and inside this part we essentially have to let it know that you want to load the URL from that specific uh endpoint that we just created so I'm going to say studio. load URL okay you're going to invoke that and you're going to pass in HTTP do um local host or you might want to use the production links right so you can make that uh change before before you push but for now I'm just going to call it Local Host all right guys so I went into my environment file and I created another variable in here called Vite app URL and I set that equal to http dolal host. 5173 okay and I'm going to go back here all right and in here I'm just going to grab this value okay so I'm going to say um oops I just made an error here let me go back and copy the right value here so I need this one and I'm going to go back and let me quickly replace this so in order to import a environment variable you have to say import meta Dov and then the value right so I'm going to paste that in here so import meta EnV and I'm going to pass in the other values that I need as well okay and now if you run the dev server you're going to see two things in here okay you're going to first notice a a window that looks like this and for some reason I'm able to kind of scale this and drag it up and down but this is going to be our tray and this is going to be our main window Okay the reason why it's showing up like this is because we just copy pasted some stuff right so I just wanted to show you what that looks like anyway so let's move on and I'm also going to quit the terminal so it doesn't keep sending me back to a different screen and in here after this part now that we have loaded the studio we also want to load the floating web Cam and for this first I'm going to do this in here and then I'll go create my environment file okay not environment I'll go create the HTML file so I'm going to say load URL and I'm going to pass in this value right but I made a small error here guys we have to first put the dynamic uh we're going to put the back tiex in here and we have to render the right path right so this is going to be dollar sign and we're going to put the curly bracket and then we're going to put / studio. HTML okay like this because it was rendering this one all right and then down here we also want to put the other one so I'm going to say dollar sign like this and after this I'm going to say webcam. HTML so I think that's why it was showing the other component inside the same Studio component as well let me try to see if I can and uh render this let me just see what happens okay so npm run Dev let's just give that a second all right awesome now I have the other Studio component uh but I'm not able to drag it or show it because it's on a different screen but you have to just trust me bro okay all right now I'm going to quit this and let's proceed from here another thing in here that we need to do is when um essentially if we don't have the dev server in production we have to have the rendered distribution folder which is essentially I think it's going to be one of these the distribution uh folders itself right the DD and from there they're getting index.html so we have to do the same thing for the other folders as well the other files as well so here I'm going to say studio. loadfile and then floating webcam. loadfile and I have to say path. jooin the same thing but here I have to change this to studio. HTML and this one is going to be webcam. HTML all all right now open up your folder structure and you want to scroll to the bottom and let's go ahead and first complete the webcam. HTML file so this is essentially pretty much the exact same thing as the studio. HTML so I'm going to copy everything in here I'm going to go down in here into this file paste it and now I just need to change the path so this has to get it from the webcam so we're going to create another module right called webcore cam _ Main main. TSX right and that's where we're going to get the main file for this um this HTML all right so here you're going to scroll up into your root directory inside source you're going to create another file you're going to call it web camore main. TSX and you're going to go into your studio main you're going to copy everything in here and paste it inside your webcam main okay then you're going to create another file in here called webcore camore app. TSX and you're going to click on this studio app. TSX and you're going to paste it inside the app in here the webcam app and we're going to rename this one and we're going to call this webcam app okay webcam component this is fine and now let's go back here and let's also update this so I want to change this to webcam app and that should solve this problem right here okay now we also have to do the Vite configuration so go into your Vite file and and we're going to set the webcam main right here and we're going to say it's the webcam. HTML so please roll up use this file that's what we're telling it right here okay awesome now let's go back and let's try to do npm runev and let's just give this a second all right awesome now I see two components I'm just not able to grab them and show you but I have essentially the webcam component and a studio comp component and this compon component as well all right you can go ahead and do it yourself and you can probably see from there too all right now we have this window all closed event right and if you remember we also fire this from our main file right from our main. typescript let me see if I can show you sorry guys it's not uh it's not window all closed I got the wrong event the event we're firing is called close app right and you can find this inside our file uh because we're we are fire ing it when the user clicks on the X icon on the app right so this is going to do something else this is behind the scenes um but we also need to create an IPC main listener okay so this comes from electron uh let me just make sure yep it comes from electron and I'm going to say dot on and I'm going to listen for close app okay and when this happens I'm going to pass in a call back that should get fired and all I wanted to do is I want to search and check if the platform is not equal to Darvin like this and down here I'm going to say app. quit going to quit everything and then I'm going to set window equal to null Studio equal to null as well and then the floating webcam equal to null as well and I'm going to copy this step guys right here and I'm going to replace exactly what I have in here with the same thing all right so that's essentially going to help us close the application in itself so I'll go ahead and test that out now to see how that's working so open up your folder and I'm going to go into my app. TSX I'm going to click on the controller layout and right here I just want to confirm that I have the onclose app callback okay you see window. IC render do send close app right so let's go ahead open up our terminal and say npm runev and let's give this a shot okay so I have this in here and if I close this okay so some something seems to be going wrong let me fix this real quick just give me a second all right so I might be wrong here and please correct me if I am wrong but I don't think you can quit anything on Mac so I was just reading this comment and it looks like except on Mac OS devices it's you can't really close the window so if you are on Windows you might be able to get this to work it would just quit the entire application but if you're on Mac devices you'll have to rightclick the app in your doc and you're going going to need to quit from there okay and I took a look at a bunch of stack Overflow you know threads as well they are pretty much saying the exact same thing and um another way to simulate it is you can hide it and I think that's how Mac actually does it it doesn't fully close the app itself it just minimizes the application okay so if you're wondering if you do have a Mac and you're wondering what the hell is going on that's that's exactly what's going on all right okay so now that we have the close app right here here let's move on after this right to the bottom right here and I'm also going to quit my terminal cuz I don't need it anymore so down here I'm going to say IPC main we're going to basically set up all the events that we need guys and the events that we need here is stuff like resize studio um hide plugins media storage all that kind of stuff okay so in here I'm going to say um IPC main. handle and we're going to handle for get resources or get sources okay so we're going to say handle get sources and we're going to pass in a call back function okay and we are also firing this inside our uh our Libs folder right remember when we're trying to invoke get sources right and this happens from one of the components and let me see if I can find that as well where is this component I think it is probably our not our widget get sources fetch media fetch media sources somewhere here guys we we're going to need to also fire that regardless um we're going to need this so we can essentially grab the data right let me just also take a look at my uols file why did it not show the uols file did it oh it did never mind so there you go you see when we're trying to get the media sources which we're doing again inside our use media hook right right here we're trying to invoke get media sources like this right that time we're going to need to also fire that event invoke that event and here we need to handle that event when it's being invoked okay so for get resources in here I'm going to say return and I'm going to say uh await or actually let me change this to an asyn component first and I'm going to say await desktop capture so desktop capture from electron doget sources we're going to invoke this and inside this we're going to pass in the thumbnail size and I'm going to say height is going to be 100 width is going to be 150 okay and now after this we also need to say fetch Windows icons we're going to set this to true and then for types we're going to set the windows and we also need screen okay like this so this is essentially going to uh help us handle getting resources of the device okay next we're going to need to do one more down here which is to get media sources and media sources are stuff like the microphone right or the studio the studio web components essentially so let's go ahead and grab that so I'm going to say IPC main IPC main like this andon we're going to invoke Doon and in here we're going to say media sources so media- sources and for this again we're going to need a callback function and this callback is going to give us access to the event and payload so I'm going to grab these from here and inside this I'm first going to print this out if um you know we need to debug or anything and down here I'm going to say studio. web contents. send and we're going to send profile Das received and we're going to pass in the payload load okay just like this awesome and please do not make any spelling errors in the in these events okay I cannot help you because it's going to be very difficult to debug this okay so let me just pass this in here all right nice the next one is another event called resize studio and it's like this IPC m.on resize studio and the call back we're going to essentially print the event we're going to say if payload do shrink studio. set size to 400 and 100 and you can take a look at what this is so width and height and then if payload is not equal to shrink then we're going to say 400 into 50 okay then we're going to have another IPC event here called hide plugin and in here we're going to say window. web contents. send hide plugin okay that's pretty much it and uh we have the on ready at the bottom so when ready do then and we're essentially creating the window itself great job now if you try to run the application it's going to tell you that an error occurred inside the get resources and I think this is because we have to respond to this right so we have to give this application access to our devices now on Windows I don't think priority u i mean a lot of priori is given for security so you might be able to bypass this but I'm going to try my best to see if W if uh Mac is also going to help me ignore it and uh just give me one second okay so I just went into the settings and I gave access to my devices so cursor wanted access so I did this and the other thing is I think this is a new update okay you can only give it for one month at a time um so just go ahead and click yes for this as well and it's going to try to get access to that and that should be good so far I'm still seeing this weird error here let me see what what's going on okay so I think the reason why that was happening is because I need to open my browser uh version as well cuz I had to reset kind of like restart everything so let me go ahead and say okay so we have our regular application all right nice so open up the terminal and say bun runev and that's going to spin that up for me and I also have to make a request to this but I mean I don't really have to but let me go ahead and refresh my app here all right there we go and that solved our error great job all right guys now just to make sure I'm getting the resources I'm going to print the resources in the terminal and if you can see in here let's open our terminal if you scroll to the bottom you're going to see that we are printing each and every single screen okay so this looks like it's working so nice all right if you don't see this for some reason again guys just reach out in the Discord and the community will help you okay so now that we have this let's move on to kind of getting our resources set up and the components itself so click on app. TSX go into the button right in here and you can click on the media configuration component and then let's con let's pretty much complete the this exact component right here so I'm just going to quit the terminal or if it will allow me okay it just looks like there's an error okay I'll keep this for now if it bugs me too much I'm going to I'm going to close it uh but essentially down here we're going to say if is pending so like this is pending and is pending is going to come from one of the hooks actually right here so I'm going to say if is pending like this if this is true and we're going to return a div okay and looks like I made another error here so let me remove that remove this as well and inside this div we're going to give the following class name so I'm going to say fixed like this and Z 50 withd full top zero left zero right right zero bottom zero so it's essentially um stretched across rounded to XL height full uh BG black divided by 80 and then Flex justify Center and item Center and in here I'm going to create the spinner component okay or a loader component so let's bring that in nice and now after this down here once we get the devices we're going to render a div and inside this div I'm going to actually set the following class names so I'm going to say Flex Gap X of 5 justify Center and item Center and then I'm going to get the monitor icon which comes from Lucid react so go ahead and import that icon and you should see it like this okay and after the input uh after the monitor we want to render out a select component and for each display we want to map over them and return an option okay very simple stuff so let's go ahead and grab that as well so I'm going to say select like this and I'm going to return a uh I'm going to essentially use a register element in here right use a d structure and D structure our register which comes from use form I'm going to pass in the class name outline none cursor pointer padding xfi you guys can just pause and type this then for each of these I'm going to render an option that's it okay so you can see I can click on this and I can pretty much change to different type of settings okay screen one screen two whatever I want and this is the display essentially now after this down here we're going to find this div hit enter we're going to create another div and this div is for the audio so um it's for the microphone so I'm going to say Flex Gap xfi justify Center item Center and in here I'm going to get the headphones icon so let's go ahead and say headphones and I'm going to provide the following color just like this and after this again same thing we're going to render out a select element and we're going to show the uh different audio inputs okay so I'm going to say select I'm going to use uh use form and the register just use a spread operator and put it in here and then I'm going to pass in the class name and then I'm going to Loop over each of these options and so I'm going to say state. audio inputs. map and for each device I'm going to render this specific option okay and what is this selected so essentially which one is the default value right so which one are we going to select here so if we have the audio device and the audio device is um equal to the device. device ID then this is essentially going to be true right here okay so you guys can just copy this it's pretty much the same thing we're just rendering out some values and as you can see I have a bunch of audio inputs and right now if you're curious I'm using this microphone okay it's a really really nice microphone and right down here I'm going to add another div and this div is going to have the following class name so I'm going to say Flex Gap X just I mean pretty much the same thing and here I'm going to render a settings component okay so return a settings icon first like this let me see if there's a better settings icon I think there's only one type okay you can render whatever you want I think this one looks slightly better right maybe I don't know so I'm going to render this component and in here I'm going to return a select component okay with one different option so first we're going to say select then we're going to use the spread operator for to register this element then I'm going to provide the following class names and after this I'm going to create an option in here okay that shows 720p or 1080p and this is based on their plan guys okay so this is super super important right here this application is so powerful take a look at this we're showing you how you can essentially give users the ability to change you know their um the quality of the video based on their their tier so you can pretty much set as many you know filters as you want to give them access to cool features okay so in here we're saying uh pretty much the same thing the most important part is the value should be HD and value should be SD right here and also um selected okay so right here you want to render um sorry right here you want to disable this based on their plan okay so for example if this was set to True like this then if we try to hit this you see we can't select that item okay so that's pretty much it and that's it that's all for this component simple right now let's go back and let's uh see if we can create anything else left in here let me take a look all right nothing else left in here so let's go back to the other windows and let's complete those as well so go ahead and click on the studio app. TSX and then here we're going to remove this component and we're going to return a new component called Studio tray okay and go ahead and copy this you want to open up your folder structure and let's scroll into Global components I'm going to create another folder called Studio tray and in here an index. TSX and let's also return a component and rename this component as well okay so the first thing we're going to do in here is I'm going to well I don't really need any props so I'll just remove this for now okay because you're going to get a bunch of build typescript errors because of es Lin so go ahead and remove that and first thing is I need to get an initial time so I'm going to say initial time equal to new date okay and I'm going to render this initial time inside this component itself okay you'll pretty much see where it's going to where it's going to uh show up now I don't have a design for this so I'm not able to show you guys what it looks like but um just keep building with me and then eventually you'll see the design just kind of come in picture okay so I'm going to create a div in here and I'm going to set Flex Flex DC column justify end and I want to set gapy of five and height of screen okay and now let's go back to our studio tray component and let's import this component itself and now if you're running your terminal you should see that component show up okay and I also I'm going to add draggable um what was the class name that we had for that okay you don't have to do this um I'm doing it right here because I want to show you that the component exist it exists okay it looks awful but I promise you it does exist so um you can do this if you want as well and the main reason is because it shows up on a different monitor for me so that's why I have to kind of Bring It um bring it up like this okay I think I might have solved this problem I'm not entirely sure but we'll figure it out but as you can see I have the webcam component as well showing okay it's just not placed on top but eventually we'll get to all that stuff but that's it so now you see we have this component right here right um okay cool now let's go ahead and continue so inside this div component we're going to render out a video component okay and this is going to have the following so we're going to say autop playay like this and we're going to say ref is going to be a video element and this video element is going to come from a ref element so let's go ahead and say const video element equal use ref and let's import that and inside this this is going to be of type HTML video elements or null and for now I'm going to set this to null okay and inside this video I'm going to essentially have a class name so let's go ahead and also I'm going to change this to a closed component I'm going to say class name and I'm going to need CN for this and I'm going to set it to width of 6 / 12 border 2 self end and if we are previewing this component then we're essentially going to show hidden in here or we'll show the elements and now where does this preview come from so up here we're going to say const preview it's just a state okay preview and you uh set and this is going to be false by default and why is use State not being imported okay there we go and uh this is just going to be set to false all right so right now you can't see it but if I bring it up you can now see it okay now next thing is down here inside this uh after this video component not inside right here I'm going to hit enter and I'm going to create another div and this div is going to have the following Styles so we're going to say rounded full let me move this so you guys can see clearly so rounded full Flex justify around item Center height of two um with full order two and background of something like this and draggable okay so essentially if you see this this component can be you can you can pretty much move it whatever you want and this is going to be the video player okay hope that makes sense so right now I also see that there is some sort of a border radius and I think that border radius uh essentially comes from all of this let me move this actually um I made a small error here okay it's also looks like I can also increase the size of it so you might want to change that with a class and I think I do have something that can do that but for now I'm also going to remove dragable on this element which is this one and I'm going to make only this element dragable okay so yeah it looks like I can increase the height and width and that might just be some setting stuff but I'm not too bothered about it okay so inside this now I'm going to create another div and this div is going to have first we're going to dynamically render an onclick uh Handler okay so for this onclick Handler we're going to need some values so let's see if uh we can get that up here right now um so we'll call this on sources okay and we want set on sources like this equal to use State and this is going to have the following type so I'm going to copy this and paste it in here so please pause the screen and type along with me okay so we're going to say sources on sources and this is going to have um an object or undefined so it's going to be an object of screen ID audio preset and plan okay that's pretty much it so now down here inside this div I can dynamically render this based on that okay so for this you need to create this object like this and we're going to use a spread operator and you don't need react here I don't know why that came and in here we want to say on sources if this exists then we're going to return an object here called onclick okay this is how you can use the spread operator to conditionally render props on an element and this is of course going to need a callback function and in here we're going to need two functions okay so I'm going to go up top here uh not function sorry we're going to need two values so the first one is we're going to create a state called recording and and set recording and this is equal to use State and let's invoke that we're going to set that to false okay and this uh what just happened here why does this okay never mind so we're going to take this and we're going to put set recording and we're going to invoke it and we need to pass in true okay so this is essentially the button that's going to allow the user to start recording their U their screen okay and once this is done we also need to have a server action that can essentially help us um record uh not server action guys I keep saying server action but we also have to create a video transfer file right if you remember we have to turn on the recorder and do a bunch of stuff right so let's go ahead and do that so this one is called start recording so I'm going to say start recording like this and we're going to copy this and we're going to open up our folder structure we're going to go into Libs right in here we're going to create a recorder. typescript file and in here we're going to export const start recording okay and this is going to be an arrow function and this is going to takeen on sources which is going to be an object with screen set to a string okay and then audio which is set to a string as well and finally ID which is set to a string as well okay and then in here first we're going to to need to hide a plugin okay so in order to do this and the reason why we're doing this is we don't want some we don't want some windows to show up inside our recording right so let's go ahead open up our utils files and we're going to scroll down to the bottom we're going to say export const okay and this one is called hide a plug-in window and it's going to be a state like this and this is going to be State uh we're going to get a Boolean value in here and in this all we're going to do what seems to be the issue here okay it's never used and in here we're going to say window. IC renderer do send and we're going to fire the hide Das plugin okay and in here we're also going to pass in the state now if you take a look at this inside our main file we're also listening to this event and we are sending some events from here as well right so IPC on um this hide event plugin we're saying window. webc contents. send we're sending this exact data in here okay so let's go back now uh one more file okay and Insider on sources we're going to first invoke the hide plugin so we're going to say hide plug-in window we're going to invoke this and after this we need to create our transfer file name right so I'm going to say video transfer file name like this it and it's equal to backtick dollar sign and we're going to need uu ID so open up your terminal and just say npmi uu ID and that's going to install a package for us and this package is going to essentially help us create IDs okay so scroll up here and you can say import V4 as uu ID from uu ID and it also needs types I believe let me just take a look okay so I'm going to copy this and paste it in here and hit enter that's going to solve that problem for me and next I'm going to go ahead and create this value okay so in here first I also need to pass in true and for this value sorry guys um for this I can create const in here and then set this or what I'll do is I'll go up top to the all the way to the top and I'll say let video transfer file name be a string or undefined okay so I can create some types for this and in here first I'm going to say uu ID like this uu ID and I'm going to invoke this so it creates a dynamic uh ID on the Fly and after this I'm going to put a dash dollar sign curly bracket on sources doid and do slice and we're going to slice from 0 to8 okay we're just creating a name for our file that's pretty much it okay so it doesn't really matter you can just use the ID itself I'm doing this because I want to have different formats or pretty much uh not different formats but I want to do this because I want to have a specific format for the name okay and this is going to be webm and down here I'm going to say media recorder uh media recorder okay let me go up top and create this variable sorry so go up here I'm going to say let's media recorder and this is going to be of type media recorder okay so now I can get type intelligence for this and now I can set this equal to a um not equal guys I can actually call this so I can say do start we're going to invoke it and inside this we can pass in 1,000 okay awesome now let's go back I think I made an error here what seems to be the error is declared but its value was never used interesting okay it's because we're just setting it here right we're not actually using this value so that's probably why it was giving that error I mean that is why it's giving that error so let's go back and now import our start recording function and we need to also pass in on sources inside this okay cool now where are we getting the on sources so scroll up here and we're going to essentially listen to our IPC renderer and on the event called profile received we're then going to set our Resources with with the payload so let's go ahead and say window. IPC renderer Doon okay invoke this we're going to say profile Das received okay and in here we're going to invoke this and pass in sorry pass in a call back function which is going to give us the event and the payload sorry and in here we're going to say console.log event if we need to see and then I'm going to say um set on sources and I'm going to set this to the payload that's being passed in so we're getting all our sources from this event and if you don't know what this is you can literally take a look at uh where we're firing this event right and then you'll come to know but um yeah that's it so we're just passing this and getting the payload for the profile information and we're just setting the sources in here okay now let's go down and now that we have our sources um we also want to make sure we have the sources before we render this or we're going to have an error right so what we'll do guys is wrap this right and or let me do this instead so I'm going to say return if no on sources right if this is true we're going to do something if not we'll do something else so copy this entire thing right here remove this and we're going to paste this right here okay and for if it was if the statement is true then we'll just return um an empty react fragment okay let's scroll down here and I I also want to pass in some class names on this div so I'm going to say class name no draggable okay I'm going to set it to rounded full cursor pointer relative hover opacity 80 recording if this is true then we're going to make it red color if not we'll make it this kind of like salmon color okay all right so I went ahead and fixed this bug and essentially what was going on is right here when we are trying to set let me see if I can show you so you can also see it right so this is how this works initially when we start our application this is the main window and this does everything right this is going to send all of the resources to all other windows through events okay and of course some of them are also we're also listening to on this place itself so for example the media sources right if you take a look at where we're firing this you'll notice that we're doing this inside one of the um one of the compon this component right there's a hook called use Studio Ser uh use Studio settings and that's firing in this component so when that's being fired the first problem is right here the user does not have any kind of preset right we had something called add and preset right here but when we're getting data from the database the user does not have that preset by default so because of that it was never entering this IPC render do sendevent okay and so that's the first thing so once I saw this problem that means I removed it it it was then running the use effect itself so that's good news but down here we never had a dependency and the screen and audio essentially was updated after the first render because it takes some time right and the EAS effect usually fires twice right it fires the first time and then when the dependencies update as well so that was a problem so remove this keep it like this and add these two values in the dependency array and now just to show you that it actually works I'm going to quit this and I'm going to go ahead and say npm run Dev and now it's going to spin up the first one and then few seconds after once I get the resources boom there we go okay and as you can see in here I have the event which is now fired and this event comes from our main file right here okay so you see I put some cool Emoji so I can it can help me debug and you see right here it's saying this is the payload and this is the event so media sources so this is how I was able to kind of debug okay all right this application's insane man I'm having so much fun I really like electron it's a little bit I mean it's a little annoying but I think it's it's really cool because I'm communicating with a web application and I have a native application as well right really really cool all right so now right here I'm going to remove this and we never had this as well well okay just assume you never saw that and what we're going to render here is if the user is recording then we want to show a pause icon okay and if they are not right we're just going to keep it like this so what do we do for this well inside this inside this div first we're going to say if the user was recording so recording like this if they were recording then we want to render out a span okay a span tag and inside this I'm going to set the following class name so this is going to have um absolute right 16 top I made an error here so right okay -6 top half transform Translate Y half negative half and text white okay and inside this I'm going to put the timer in here okay and the timer is something that of course I need to create so I'm going to go up top all the way up here and I'm going to say cons timer and set timer and this is equal to UST State it's a string and by default we're going to put 0 0 0 okay put the same way I have it right in here now down here I'm going to change this to ontimer okay awesome and now I'm rendering the timer down in here okay now the other thing is when do we start this timer well when we start recording right so when the State updates then we want to essentially start our timer and do pretty much whatever we need to all right now to keep track of this timer I might also need a counter so I'm going to say const counter or count and set count and I'm going to set this equal to UST State and this is going to be a number and it's going to be Zero by default and now to activate this I'm going to say uh use effect okay and I'm going to pass in an empty depend not an empty sorry I'm going to pass in this value which is recording because only once this updates do we want to fire this use effect right so once this updates we're going to first make sure that the user is recording so if they're not recording then we want to return okay and we're going to say const record time interval so interal equal to set interval we're going to invoke this and as the Callback function we're going to do the following so we're going to say let time equal count plus we're going to say new date not data transfer sorry new date we're going to invoke this and uh after this we're going to say get time and we're going to invoke this as well minus the initial time and for we can also store this initial time somewhere up here so let me go ahead and create a value all the way up here and I'm going to say initial time is new date okay so when we start the application we're going to essentially subtract we're going to create this new time here and then down here here we're going to subtract this from it so I'm going to say uh initial time. get time like this okay and then I'm going to set the counter the count to this time okay what seems to be the error here use const instead oh okay cool well it just wants me to do that no problem and then I'm going to also need to essentially um get this in terms of in in like a format right so I'm going to use a um a helper function and this helper function is called video recording time so let's go ahead and open up our util folder our utils file okay right here and at the bottom I'm going to do export const video recording time which is going to be an arrow function it's going to take milliseconds which is a number and in here I'm going to say const second equal math. floor and I'm actually going to copy this formula so I don't make any spelling errors but I'm I'm going to say math. floor milliseconds / th000 divide uh percentage 60.2 string pad start 2 to zero okay and next just copy this guys all right this is just like a formula it's not important uh I'm just going to paste the minute and hour as well pretty much the same thing just make sure you make these adjustments and then after this I'm going to return an object with length set to the following so I'm going to to create a string literal and I'm going to pass in the hour minute and the second and then after that I need to also pass in the minute here return the minute as well okay now let's go back and let's go back here and now we can invoke this video recording time so I'm going to set it to a variable I'm going to say const recording time equal video recording time and I'm going to pass in this time inside this okay next if the user has a free tier then we're going to only limit them to uh record only for 5 minutes so I'm going to say if sources. plan if on sources. plan is equal to free tier then I'm going to say recording time do uh and recording time. minute is equal to 5 then I'm only going to allow them to uh set recording to FS okay or actually sorry guys here I'm doing it by default so if they are in a freeer and it's 5 minutes we're going to instantly stop recording okay and for Clear time it's going to be a helper function I'm going to go all the way up top right here after this and I'm going to say clear time equal to an error function that essentially sets our timer to zero and sets count to zero as well okay and then we're going to have our stop recording uh helper this is going to need the media recorder right remember we created a media recorder and um or maybe I don't think think we did that let me just take a look so if you scroll down and go into our recorder where is this inside the libs folder okay we did create the media recorder all right no problem so all we need to do now is we're going to say export const stop recording and this is going to invoke the media recorder and we're going to essentially stop recording itself all right now let's go back and let's import the stop recording awesome and then after this we want to also set our timer so we're going to say set on timer to the recording time that we just got from here length Okay so that pretty much that string and then if time is less than or equal to zero then we're going to set our timer to zero right reset it all the way and we're also going to need to clear our clear the interval so let me go ahead and clear this interval here all right awesome and now after this part where is this right here the interval right this is the first parameter we're going to have a second parameter which is what is the type of interval itself so I'm just going to put one in here it's like the number right so you can this is milliseconds essentially and you can hover over this and you can check okay so after this we're going to return a cleanup function that's going to essentially clear this interval for us so clear interval and we're going to pass in the timer interval the record time interval okay awesome so every time recording gets updated we're essentially doing something in here okay why is this uh okay it wants count we don't need that okay don't put all this stuff in here okay anyways now scrolling let's scroll down after this after this div right here we're going to say if the user is not recording then we're going to return something or we'll return something else and then here we're going to return a pause button okay okay and this pause button is actually an icon so I'm going to import the pause icon and I'm going to pass in the class name no non- draggable opacity of 50 size 32 Phill white stroke none okay then after this down here if they were recording um then we also want to give them the ability to stop right so for this I'm going to render a square component and this is an icon from Lucid react and it's going to have size equal to 32 class non-d draggable cursor pointer hover scale one 110 transform transition dur duration 150 The Fill is going to be white and for on click when the user clicks on this we're going to set recording to false we're going to clear the timer and we're going to stop recording itself and this is the action that we created here okay so let's go back and now after this the next one is going to be a Cast icon okay so hit enter here and you're going to say cast from Lucid reacts okay and let's give that a second and in here we're essentially going to pass in the on click and the size 32 fill white non- draggable and cursor pointer hover opacity of 60 and then stroke white all right guys now it turns out that this is technically it is still there but sometimes this is uh kind of like you can you can change the height and width and I don't really know why that's happening but let me just take a look at our main file and in here we have our studio settings right and the height is set to 50 pixels um not sure if you change it to 300 what what exactly is going to happen but okay well nothing really did happen um it looks good so you can set it to 300 and then if you click on this you can see the preview okay and if you're seeing a little square what I did was inside here uh which is inside the studio tray I just remove this and I put this behind a preview flag okay so the same thing that was inside here I removed the styling instead and I said preview video just like this and I put it in here okay now when we change this by default we're not going to actually save it in the database that's because even though we are making the on change right here so for example inside the widget media configuration when we're making the change right here you see we are actually firing this behind the scenes cuz we are using the watch function and with the help of watch we are you know firing the mutate function right so the mutate is going to go behind the scenes and it's going to update the studio settings and it's going to make an a request to our SL Studio endpoint but of course we don't have this so let's go ahead and set this up so open up your uh app which is the web application version and then you want to go into your API folder you want to create another folder called studio and inside that you want to create another studio called ID okay this is the dynamic route and that way we can call this endpoint and then inside this you want to create a route. typescript and go ahead and return a function like this okay and it's going to be a post function because we're making a change right and down here first I'm going to get request and the pams and from the pams I'm going to get ID specifically so I'm just going to create those um the string right here sorry I'm going to destructure and only get pams in here then I'm going to print a message saying console.log called and then down here I'm going to say ID pams okay I'm going to destructure ID from here and then I'm going to say body equal await request. Json and in here we're essentially passing the data through the body right so that's how we're going to get all the data in here then we're going to say await client. user. update for this ID we're going to update the studio settings and we're going to update the screen the mic and the preset and then we'll return a 200 response and then in here once this is successful because we're using the use mutation hook we will essentially um fire a toast message so that's it and then here you can return a 400 message if something went wrong so now when we change this you're going to see we're going to have a success message great job okay so now the next problem that I need to solve here is the preview I want to essentially render our video or screen or whatever we're recording on this page so let me go ahead and do this next so in order for us to render an element inside this we could either make the call here to get all of our media resources and then we could send that into this ref right the video element itself we could do that or a much better way to do this would be to create something um outside maybe like not a hook exactly but we could create a helper function that essentially takes in all of the values we need and accordingly we can pass in the ref as well so it can mount the video to that element right so go down here and you want to scroll down into your Libs folder right here I'm going to click on recorder. typescript and inside this file I'm going to create a function here called select sources so I'm going to say export cons select course select sources equal to an arrow function and this is going to be an async function that's going to take in the on sources okay S oou I think I made some spell errors okay like this and this is going to be an object it's going to be of the three types the first one is screen audio ID and the preset which is HD or SD okay and then inside this we're also going to get the second parameter and this one is the video element itself and this is going to be react do uhre object and inside this we can pass in HTML video elements okay nice and inside this now we're going to make sure if on sources exist and these sources which sorry on sources what did I type here this is and all right and um the sources on sources. screen exists and the on sources. audio exist and also the on sources. ID exist so if this is true then we're going to do the following so in here we're going to say const constraints I think I spelled this wrong okay constraints and this is going to be of type any for now and this is going to be equal to an object and this object in here is going to have the following properties so we're going to say audio is going to be false and then video here is going to be an object again and we're going to set a property here called mandatory okay and this property is going to be another object and please copy this and paste it or pause and type so you don't make any spelling errors okay first we're going to say Chrome media source is going to be of type desktop then we need Chrome media Source ID is going to be the sources. screen and then we also have to set some minimum and maximum width stuff so I'm going to say Min and Max width Min height and Max Heights and for that I'm going to set on sources. preset if it's HD it's going to be 1920 if not it'll be 1280 okay and for height it's going to be 1080 or 720 okay next frame rate is another property that we're going to create here but for now I'm not limiting the user on frame rate I'm just doing 30 frames per second but you could go ahead and you know do whatever settings you want and down here I'm going to say user ID is going to be equal to or user ID not use ID equal to on sources. ID okay I'm just going to store it in here why is this not setting okay and this user ID is going to be a variable that I'm going to store all the way up top right in here okay awesome so now that we have this user ID first we're going to create the stream so we're going to say const stream equal await Navigator do medad devices. getet user media and we're going to pass in all of our constraints okay so I'll put some notes here for you as well this is creating the stream okay next we're going to get the audio and the webcam Stream So audio and webcam stream so down here we're going to say const audio stream is equal to a weight Navigator do media devices. getet user media we're going to invoke this and we're going to pass in some values so I'm going to pass in video and for audio uh video I'm going to set it to false and for audio I'm going to set it to on sources. audio if that exists we're going to return an object here that is devices device ID and for that exact on sources. audio and then we're going to set or we're going to set it to faults okay now after this down here we're going to say if the video element exist and this video elements because it's a ref we want to make sure current also exists so we're going to say if video element and video element. Curren exist then we're going to say video element. current. Source subject is equal to the stream okay and then down here we're going to say await video element do current. playay okay awesome now down here go ahead and hit enter and now we need to combine our streams right the tracks the audio tracks and the stream itself so this one right so what we're going to do here is we're going to say const combined stream equal to New Media so New Media stream we're going to invoke this and we're going to pass it an array and this is going to use the spread operator for stream. getet tracks okay and the second one is audio stream. gett trcks okay cool then go ahead and hit enter and now we're going to create uh now we have something called media recorder right so down here we're going to set our media recorder equal to a new media recorder and we're going to pass in our combined stream and we're going to pass in an object with MIM type set to video okay it's not giving it to me so let me just go ahead and copy this so I don't make any errors so it's video/ webm with a colon semicolon here and c o d CS equal to vp9 okay and then I'm going to say on data available so we're going to say media recorder do on Dat available equal to on data available um where do I have this one okay so before we create the on data available we want to make sure that our socket is set up now this is why I said the first video is so important okay so go back all the way to the starting and watch that video If you skipped it it's still not late go watch it okay only after you watch that will all of this make sense so first thing is we're going to need socket IO so let's go ahead and import the socket IO package and let me go ahead and grab that real quick so go ahead say npm I and I'm going to say socket IO client like this and then go ahead and install that and I don't think we need anything else all right no big deal if we need something we'll just go grab it okay and what we're going to do now is we're going to scroll up top right up top right here here and I'm going to say export const on data available so data available equal to an aror function and looks like there's another eror here okay let me just comment this out for now so this is an error function and this aror function is going to get a blob event okay so we're going to say blob event like this as a type and inside here we're going to essentially emit this uh event with socket.io so let's scroll all the way up top and I'm going to say import IO from socket IO client and I think we might need types okay we don't need types all right that's cool and down here we can essentially emit that data okay so we're going to say socket um or first we need to create a client uh we need to create a socket client right so let's go ahead and do that so down here I'm going to say const socket equal to IO and we're going to import IO uh invoke IO and then in here we have to pass in our URL that is the Vite socket URL okay and our Vite socket URL is pretty much the same thing as this one I believe let me just take a look so inside our environment file we're going to create V socket URL and we're going to set it to http localhost sl5000 okay 5000 and slash you can add this or remove it that's fine but don't forget to put it in here so let me bring this in here so we can see this now on top we're going to instantiate socket.io by saying imports. met. environment vit socket URL as string okay now that we have this let's scroll all the way down here okay so we need to create our media recorder so first thing I'm going to say is let's uncomment this media recorder. on Dat available and let me make sure I didn't make any spelling errors okay this is equal to on data available what we created up here okay and inside this blob we're essentially going to do the following so we need to First say socket. Emit and we're going to send something called video- chunks okay again please do not make any spelling errors even I'm going to copy this and paste it okay and we're going to get an arrow function as a call back so we're going to get this and actually sorry guys not an arrow function we have to pass it an object okay with the data so the Chunk in here so chunks is set to e. dat and we're getting E from this blob and then the file name is going to be set to the video transfer file name okay essentially what we created up here sorry right here okay cool now let's go down and where we're saying on data available after this we're going to say media recorder do onstop we're going to say equal to stop recording and stop recording is going to be another helper function so scroll up top right here and you're going to say const stop recording equal to an arrow function and in here we're going to essentially use the hide plugin and we're going to set it to false right and we also need to emit a socket uh event so I'm going to say socket. Emit and I'm going to pass in process-id and the object for this or the data for this is going to be file name and we're going to pass in the video transfer file name and the user ID okay user ID like this awesome now let's go back to our component also see an error here okay it's just some typescript stuff so I'm just going to do at TS ignore for now and it looks like expect error instead of this we'll do nothing okay so let's add that okay this did not do anything as well so we can just ignore it okay it should shouldn't make a shouldn't cause any problems for us now we have to go ahead and invoke the select resource right we have to call this so let's go ahead and at the on top here right above this use effect I'm going to create another use effect so let's create our callback function and this is going to be a dependency array with on sources passed into it and in here we're going to say if on sources exist and on sources. screen exist then we're going to invoke the select sources and pass in on sources as well as video elements okay nice now we also need to return a cleanup function so I'm going to say return and inside this I'm going to say select sources and I'm going to invoke it and I'm going to pass in the on uh sources as well and the video elements too okay and you can put this in here if you see an error okay nice now let let's scroll down or just restart the server and when you click on this button it's going to ask you for Access so I'm going to say allow and there we go now we can see our screen how awesome is this and you can change to whatever screen you want so if I change to screen number one as you can see um I don't think you can well you can see it's the you can probably see the cursor right it's moving in there so it is a screen recording itself and you can also change this to screen two so we can record this screen and again you can see the cursor on this screen as well okay awesome guys looks amazing now another thing is inside our main. typescript if you scroll down you're going to find something called resize window okay so essentially when this is being fired we want to set the studio size to the following so let's go back and also fire this event okay and for that we're going to need the a helper called resize window so I'm going to create a use effect and inside the use effect I'm going to pass in preview like this and in here I'm going to say if or actually we don't need to check I'm just going to create the resize window Helper and pass in preview for now so let's copy this and I'm going to go into my uols file right here and at the bottom I'm going to essentially say export const resize window equal to an equal to an aror function and we're going to have a Boolean here called shrink and inside this we're going to send the event with the IPC renderer so we're going to say IPC renderer do send resize uh resize studio and we're going to pass in the Boolean okay now let's go back in here and let's import our resize window Helper and we also need to well since it's an event handler or I mean it's an event emiter I think we all yeah we also have to return this right so I'm going to say return and invoke resize window and pass in the preview so now that I look at this you may not actually need this because the reason why I needed this in the first place is and again guys the the whole confusion is happening because of different devices right um first coded this in Windows so we're going to have that discrepancy so if you can see here if I click on this essentially what we're doing is we're firing the set preview and that's going to invoke our resize window and essentially we're accommodating for the square that's basically what's happening so technically speaking you don't even need this right and I'm just going to select something in here for now so it brings this up and the reason is because we can essentially click on the um we can click on this oh I think I accidentally moved okay so you can click on this and you can drag it or you can set the height or whatever you need right oh also we need to refresh everything so now you see it does not remove it so completely up to you it's just personal preference I think this looks great so I'm going to keep it like this now the other component or the other file that we need to load is the webcam right so let's go ahead and try to set that up as well so first thing is we're going to go into our webcam main. TSX and click on this app right here here and now we need to build the component itself the webcam itself inside this so remove whatever is in here and let me increase the screen size so you guys can see clearly and I'm going to call this webcam okay so let's copy this open up our folder structure and inside Global components I'm going to create another folder call it webcam and then index. TSX file TSX file and inside this I'm going to do the following so the first thing is I don't need any props so I'm going to remove this and in here I'm going to say const cam element equal to use ref not use reducer it's use ref like this and we're going to invoke that and we're going to pass a null and this is going to need a type right so the type is HTML video element or it's going to be null so essentially what we're doing guys is we're just going to R something exactly like this but we're just it's not like we're individually recording that element and then streaming whatever is coming through the through the webcam but we're just placing it like an overlay okay but this will be hidden I believe and this one will not be hidden right so essentially all we're doing is we're placing the camera and we're just kind of making it an overlay all right so next thing is in here I'm going to say const or let's just go down here first and let's return the video element right so I'm going to say video like this and inside this I'm going to pass in my ref so the ref is equal to cam elements and I also need a class name so my class name is going to say height screen draggable like this okay we're going to say object cover rounded large aspect video border 2 relative and border white and now if I put something in here you may not be able to see this uh let me see if I can find this element okay so I need to First import this component right so once I imported it now I can see it but you're not able to let me go ahead and show you all right there we go looks awesome right so it's going to show up kind of like in the bottom left corner something like this okay all right now the next thing you're going to do is go into your main. typescript file and if you scroll up top right here essentially we say window. set visibility on all workspaces and also we put it on full screen devices we need to do the same thing for our floating device okay floating webcam so you're going to say floating webcam floating webcam like this copy this and do the same thing for this as well okay now I'm going to give it a second to spin up and I'll show you what it does as well so as you can see when all our resources show up now we have this circle right and all we have to do is do exactly what we did with this part which is fill it with the video that's pretty much it okay so let me go ahead and do that as well so inside this webcam component essentially when it spins up we need to have we need to have a use effect that will stream our web camera into that element right so first thing we're going to do is we're going to create a use effect like this and we're going to give it a empty dependency array and when it first streams uh when it first gets set up we have to we have to call a function called stream webcam so I'm going to go ahead and call this and this is of course the um helper function that's going to do all of this so right here for now I'm going to say const stream webcam equal to an arrow function and this is going to be an async function as well and in here I'm going to say const stream equal await Navigator Dot media devices. getet user media and I want to invoke it and I'm going to pass in some information I'm going to pass in the video set it to true and the audio itself okay so it's already calling this so I'm just going to hit allow okay and I also want to set the audio and set it to true as well so it might ask for that too okay it's not asking good to go and down here I'm going to say if we have Cam if we have the cam element right so there's something inside cam element. current then we're going to say cam element. current. Source object equal to the stream and then we're going to await cam element. current. playay okay very similar to what we did for the other um for the stream for streaming the video cam as well and there you go guys that's me how's it going so as you can see the camera is also set up and um if you got that prompt just make sure to click allow okay if that goes away then make sure you go into um you want to go into your settings and you want to change it from there okay so I'm going to move this now all right awesome our application is working amazingly well now the next thing we need to test which we haven't tested yet is our socket and to see whether it's emiting all of these values now I know for fact that it's going to because socket does work okay socket will do what it's intended to do which is it will just simply emit this event but I want to make sure that my on data available is being invoked based on the interval that we gave it okay that is every second so all I'm going to do is I'm going to say alert running in here and I'm also going to say npm runev and if everything is working and when I click the record button I should see the um I should essentially see an alert message and the timer so I'm going to bring these two up here and I'm also going to select a screen so I can see a screen right here okay awesome and now I'm going to click on record all right we see our timer awesome and we also see the alert message showing up every single second great job guys now go ahead quickly open your open up your terminal and just quit the terminal so it doesn't you know that keeps spamming you but that's it that's all we needed to do now all we need to do now is send these chunks to that endpoints and we're already doing that right we're emiting this to this specific endpoint so once we have our Express server that's listening for these events that are going to come in we're going to take these chunks and then do whatever we need to do on the express server and then we'll store it as a file and then we'll upload it to to our S3 buckets okay so many cool things you're learning in this one single video so I'd really really appreciate it if you supported us by Smashing that subscribe button okay all right let's move on now all right so go ahead and create a folder wherever you like I'm just going to put it in the same place where I have all of the projects related to this uh opal project and I'm going to call this one Express so first I'm going to say opal D web prodigies Das Express okay and next thing is I'm going to go in here and open a new window okay awesome and I'm going to bring this window right here and I'm going to drag this folder and put it inside this file okay next you're going to open up your terminal and you're going to say npm in it and I think we just need this this should be fine and for the package name you can pretty much set whatever you want I'm just going to go ahead and hit enter for version it's going to be one for this description you can put whatever you want but I'm just going to go ahead and hit enter for the entry point I'm going to change this if I can in here okay it's not letting me do anything so I'm just going to hit enter for the test command hit enter get repository just hit enter for everything okay awesome and now you should see a package.json inside this and you see it's actually uh send the index.js as the root file but we're going to be using a server.js file okay it doesn't really matter you can use index.js if you want as well but I'm going to call this server.js okay awesome and in here we need we're going to need to also install a couple packages so just go ahead and follow with me so I'm going to say n npmi the first one is axios then we're going to need cores then then EnV Express we need fix Das webm duration put space then you're going to need honed then you're going to need nodemon and open Ai and then we need socket uh I think I made an error here it's open Ai and then you're going to put space say socket.io and then we need Zod okay all right and we're also going to need oh we also need AWS stuff so we're going to say aws-sdk then you're going to say at aws-sdk client DS3 and you're going to put space and aws-sdk SL li- storage okay and go ahead and hit enter and that's going to install a bunch of stuff for us and let's just give that a second okay so I made an error here guys this is not uh two dashes it's just one dash so remove this right here and hit enter one once more and that should do the job all right so before we begin I want to just give you a quick overview of the libraries that we're using in our express application because I know there were a ton and most of you guys already know what this stuff is but for those of you who don't who you know have absolutely no idea I'll try my best to give you a quick Glimpse okay so first the first three packages which is the AWS client S3 and the AWS SDK the lib storage these are tools to help us store and manage files on um Amazon S3 buckets okay so it's basically like a cloud storage service and if you went to if you watch the first part of this course which is the first video it explains every single thing right but this is basically where we will keep all the videos for our application and we'll store it inside this S3 bucket okay next the AWS SDK is needed in this application because it's it's slightly an older tool actually but we need this to essentially connect our app to the different services that AWS is providing so for S3 we're going to need this SDK to pretty much connect to that bucket okay then axios you guys already know so I'm not going to explain axios is just to make API requests now what is cores here so in short cores is well first cores stands for cross origin resource sharing okay and what this means is when you are sending a request from two different domains it's going to get blocked because it's it's like a security principle okay and we want this we want this Coors library to essentially make sure that our applications can safely connect to different domains or services without running into this specific security error okay it's in my opinion it's very annoying but it's super super helpful okay you need this you need this to secure your app and also make sure that uh it also helps you not get you know a bunch of calls from someone that's not authorized to call your application that's why we need course next environment so this helps us essentially uh keep sensitive information right so passwords and keys and stuff like that and the EnV is essentially going to help us locate a environment file and pretty much do whatever we need with them next Express so this is what we use to build our backend server okay it handles things like routing or um deciding like what happens to what happens when users you know hit a points and end point right so Express is also kind of like U it's basically an API for your server think about it that way then what is fix webm duration so this is a small tool it's not a big package but it's a small tool that makes sure that the video files um the video files in the webm format have the current have the correct length Okay so that way the video doesn't cut off uh too soon or too long or you know too too late and that way we get the exact number that's the only reason why we we need this okay now Hound or Hound how however you want to call it this essentially helps our app listen and interact with audio or speech okay and um it's like think about it when when you want to control something using voice commands you'd probably want to use this okay and it's going to come in handy in our application then we're going to need nodon nodon is a tool that pretty much starts a server right it starts our Express server and that way we can listen for you know end listen to for calls that come to our endpoints open AI you guys know um socket IO you guys know and Zod I'm sure you know as well right if you don't know what open AI is I am sorry you live under a rock but essentially open AI allows us to connect to AI Services okay and AI models for generating text descriptions all that kind of stuff okay hopefully that description really helped now in the script section we need to use no to essentially run our application so right here go ahead and change this to First we're going to create a script here called Dev okay so you're going to say Dev and this one is going to say nodemon server.js and we're going to have one more script that's going to essentially run node server.js and this one is called start okay so let's go up here and put a comma after this and you don't need a comma after this okay so make sure you add that and now we can go into our server JS and pretty much do whatever we need to do now before we do that I also want to create a environment file okay so you're going to say EnV and inside this we're going to do the following so first I'm going to need the next API host and this is going to be Local Host 3000 API and then we're also going to need the electron host okay so this is the Local Host 5173 okay this is where our app is running our electron app specifically let's go into our server.js file and the first thing is we're going to need to spin up our server so I'm going to say cons server equal to htdp Doc creat server and I'm going to need to pass in an app and since we're using Express here we can instantiate an Express app by saying const app equal Express okay now that we have this next we need to wire up cores so I'm going to say app.use cores and I'm going to invoke this and now of course we need to import C so we're going to say cores uh const cores equal require cores just like this okay file is in commonjs yes I know it may be converted okay I know that as well we don't need to do that it's totally fine so now that we have cores uh pretty much connected with our app we can go ahead and also grab HTTP okay so HTTP is going to help us create the server itself so I'm going to go in here and say HTTP equal require HTTP so now we have pretty much everything that we need so you can go down to the bottom and you can say server. listen you're going to invoke this and you're going to pass in 5,000 and after this you want to pass in a callback function and in here I'm going to say console.log and I'm going to pass in a green icon so I know that everything is good let me say green like this green circle okay and I'm just going to say listening to Port 5,000 okay awesome now we can go ahead and say npm Run start or npm runev and that should spin up our nodemon server okay so it looks like something went wrong with Express let's just take a quick look oh all right turns out we I did not even import Express in the first place so on top here we're going to import Express as well and now nodemon is going to automatically spin this up so let me go ahead and see what our next error is okay so this is already in use so let me quit the server okay so I think this is because I'm unac and if you have AirPlay for some reason 5,000 is taken now this is what stack Overflow says even though I think 5,000 is not taken but um if it is all you have to do is change the port number so I said 50001 and now you see I'm listening on 50001 and because we made this change we want to go into our electron application and we also want to change it in here okay so now that that is done our application is essentially listening nice so now let's go ahead and import our socket so I'm going to say server equal requir socket.io and let me also increase the size so you guys can see clearly okay and let me shrink this a little bit more nice so now we have the server and we can create that um instance of socket.io so here after the app.use I'm going to essentially say const IO equal to new server we're going to invoke this and we're going to pass in our server that we just created and we're going to pass in some some um properties some options the first one is cores so for Cores we're going to set the following so origin is going to be set to process. environment. electron host okay and just to make sure we have electron host in here awesome and now that we have this the next one is the methods so for methods we're going to set get and post because that's all we need for now right so now essentially socket IO is creating where I mean we're creating an instance in here so we can use IO inside this application and listen for events so first event we want to listen to is on a connection so I'm going to say on and it's for a connection specifically and for this connection we're going to get a callback function and this callback function is going to give us access to the socket itself now once this is connected I'm just going to show a message saying console.log okay I'm going to copy this little green icon and I'm going to say socket is connected okay so now let's go ahead and try to connect um socket with our application all right guys so the reason why we're not able to connect is because we did not invoke EnV so go ahead and say EnV like this and you want to say require EnV and then you want to configure it by saying. configure okay and once this is done you also want to go into your environment variables and you want to remove this backslash The trailing backslash okay and then make sure this is running so go back and save it once more so it kind of like refreshes and then you want to go into your application your electron application and you want to say npm run Dev okay and there you go our socket is connected so the problem here was both the EnV and our environment variable as well okay so now there there are going to be different events that we need to listen to from socket IO right the first one being the video chunks so I'm first going to say um socket do the socket from here right socket Doon we're going to invoke this and we're going to listen to video chunks and this is going to be an arrow function because we're going to get a callback function that it fires and in here I'm going to pass in I'm going to make this an async function and I'm going to call this um right here I'm going to say console.log and in here I'm going to say video chunk is sent okay and this is also going to give us some data so I can pretty much print the data if I want as well um sorry this is data not date okay the other event we we are going to need to listen to is process video right so let's go ahead and listen to that event so process video and finally disconnect so let's go ahead and say disconnect all right and for disconnect I'm just going to say let's remove this and say socket. ID is going to be uh socket. id okay. id like this and you can pretty pretty much say is disconnected okay and for this one we'll say processing video okay cool now let's go into our application and first I want to make sure the soft socket is connected okay so if I try to record there we go so every second I'm getting sent these chunks guys this is the most beautiful site I have ever seen in my entire life take a look at that so all our chunks and the buffer data is being sent in real time so as the user is essentially um recording we're getting all the the buffer data and it's being sent into our Express server and all we have to do is pretty much convert this in store it okay as a file so I'm going to stop this so it doesn't burn my computer okay and the reason is because I have some other video processing tools that are running in the back end so now that we have this we know that this is working right and when I clicked on stop I also want to make sure that the video is hm we're supposed to get processing video we did not get that event if I'm if I'm not wrong let me try to do this once more so I'm going to record and let me stop okay so processing video is sent first and then I think okay and then I think we're sent the final chunk this one so I don't think we're going to need to care too much about it and if we do of course we'll come back to it okay so now let's go ahead and first handle the CH the video chunks being sent okay so in here first thing is we're going to need to create a WR stream so I'm going to say const right stream is equal to fs and Fs is file storage right file system for that we're going to need to go all the way up top and require or import our file storage and down here we're going to say fs. create WR stream and we're going to invoke this and now essentially we have to pass in all of the data right but before that I want to create an array here that can keep um record record of all of our chunks I'm going to say const recorded chunks equal to an empty array and now I'm just going to append all of the chunks I get to that okay so first let's also finish this so first thing is I'm going to create a folder here or a file here like this called tempore upload and I'm going to put a backs slash and I'm going to say Plus data or actually let's remove this data. file name okay and this data is coming from here so file name like this okay and once I have this I want to push these chunks into this array so I'm going to say recorded chunks. push data. chunks okay next we're going to need to create a blob so let's go ahead and say video blob equal to new blob and we're going to pass in the recorded chunks and we're going to say type video webm and we're going to pass in the code uh code CS of vp9 okay and after this we're need we're going to need to create the buffer right so what we're going to do now is we're going to say const buffer equal to buffer. from await video blob and we're going to get the uh we're going to get the array buffer okay and next thing is down here we're going to create a read stream and from that we're going to read this buffer info so you're going to say const read stream okay equal to readable is it giving it to me okay it's not giving it okay so I need to get readable from the stream package so I'm going to go up top and I'm going to say readable equal require stream like this okay then I'm going to scroll down and let me also shrink this a little bit so you guys can see okay and inside this we're essentially creating the readable stream so we're going to say readable. from we're going to pass in our buffer data and now after this we have to pipe our readable stream to the right stream right so I'm going to say readable stream. pipe and in here I'm going to essentially pass the right stream and after that I'm going to haveon and when this is done so finish like this when it's completed it gives us access to a c call back function that will it will invoke so I can pass in the console.log in here okay and I'll take the same thing from here and I'll just put this in here saying chunk saved okay and now that we know the data comes back I'm also going to remove this so it's a little clearer and we can understand what's going on okay nice awesome now I'm going to remove this one as well and for this it's fine it can stay but that's pretty much it so let's go ahead and give give it a shot and let's see what happens so I'm recording now as you can see it says the app crashed waiting for a file changes before it starts so it's saying there's no such file or directory called temp upload okay and something is undefined which is the file name itself okay so it looks like when I just console. logged the messager data it looks like file name was misspelled okay so this is why I said don't make any spelling errors like me okay so I'm going to go in here and I'm going to go into recorder. typescript and I'm going to change this to file name okay now um socket is also connected and let me try I think I also might need to create the folder but I'm not sure if it does it on its own let me just give it a shot okay so we need to create that okay so go down here and create a folder and we're going to call this folder video sorry we're going to call it temp un uh underscore upload and that's pretty much it okay and let's go ahead and try to record now also we need to save our application so let me go ahead and save this and there we go so it saved some files it looks like I did it twice so it kind of created two different files so I'll delete this and I'll delete this one as well and now let's go ahead and start from the top so I'm going to save this so it starts all over all over again all right socket is connected and it looked like it created two connections and the reason is because I went in here and I used the hot reload right so I'm going to quit this app I'm going to redo my nodemon okay and now I'm going to open up the app once more all right socket is connected that screamed in my ears oh my God that gave me a heart attack okay and now I'm going to try to record okay processing the video chunk saved awesome guys take a look at this how amazing is this to you so now when I stop this boom done the chunk is saved and everything is pushed into this file right here we did every single thing from scratch this is why this application is going to stand out on you know on your resume or even you know on YouTube no not a single person on YouTube is showing you how to do this they're probably using something like a streaming platform and you know they're they're essentially using something like OBS and they're just showing you how to stream it from them from that right but we're showing you how to do it from scratch so if you like this video please do give us a thumbs up and subscribe that would mean the world to our team okay all right so now once this is done the next step is processing right so let's go ahead and do that part so when socket.io gets this event fired which is the process video in here essentially we're going to do a bunch of things for example we're going to need to also read the file and we're going to need to of course upload it to our database remember all the steps right and also AWS related stuff so for now let's get the code up and running and then we'll go get all the variables that we need right because we have to go into AWS we have to get the bucket name the region some access credentials and all that kind of stuff so let's go ahead and do that first so first thing I'm going to do is I'm going to set recorded chunks to an empty array okay then I'm going to read the file from F from file storage so I'm going to say fs. readfile and I'm going to invoke this I'm going to say temp uh tem _ upload going to put a backs slash and then I'm going to say plus data. file name and this is going to give us a callback function so I'm going to make this an async function like this and this is going to give us any error or the file itself and inside this first thing I'm going to do is I'm going to going to say const processing like this is equal to a weight axios and we're going to need to import axio if you go up top you should see axos um where was that let me do it from scratch actually so I'm going to say const axios equal required axios okay and now let's go down and after this we're going to say axios dopost dopost hm something seems to be wrong guys just give me a second okay I think everything is correct I'm not sure what's going on but I thought it would give me some type intelligence but I guess we're not getting anything in here so it's fine no problem now we're going to say post and we're going to put the endpoint so we're going to say dollar sign and make sure you have the back ticks process. env. next aior host and inside our environment file we have the next API host variable in here okay so now inside this we're going to say recording okay and then slash dollar sign like this data. user ID and then slash processing okay cool awesome next after this we're going to say if we're processing the data so this has to be inside this guys or maybe well yeah it has to be inside it so let's move this inside this so if processing is equal to or if processing. dat. status is not equal to 200 then we want to return console.log and I'm just going to put an emoji in here maybe a red color emoji and I'll say error something went wrong with processing uh with creating the processing file okay and then after this down here I'm going to hit enter and I'm going to say const key equal data. file name okay and this is all a lowercase and next we need the bucket so I'm going to say const bucket equal process. env. bucket name and this is going to be inside our environment variable but because we don't have it for now it's totally fine I'm just going to set it and I'll come back to it when I when I get those keys okay and after this I'm going to say const content type equal to video/ webm okay and then I'm going to get a command here so I'm going to say const command and this is equal to something called put object command which comes from s SW from our AWS SDK okay so let's go ahead and I'm going to go up top and import all the AWS related stuff so I need the S3 client and put object command okay so I'm going to grab this and here first of all I made a spelling error so let me fix that spelling error I'm going to say new put object command I'm going to invoke it and inside this I'm going to pass in the key I need to pass in the bucket and we can also quit this we no longer need the terminal to run and or the server to run and then I'm going to say content type like this and then I'm going to say body and I'm going to pass in the file okay all right now after this down here I'm going to say const file status equal to await s3. send now for S3 we also need to create an instance so let's go ahead and do that so you want to scroll up here maybe somewhere around here this should be good so we're going to say const S3 equal new S3 client S3 client we're going to invoke it and inside this we're going to need to pass in some credentials so I'm going to say credentials which is an object the access key ID is going to be process. environment. access key ID and I'm going to go into my environment variable and I'm going to create this one right here and then after this I'm going to need the secret access key which is going to be process. env. secretor key and let's go ahead and also copy this one and I'm going to paste it inside my environment variables I can't type today guys today's a really bad day today's an amazing day sorry never say that okay so and after this I also need to pass in the region so I'm going to say region is process um I have to put a comma here first so region is process. environment and we're going to say bucket region okay and we're going to go ahead and put that variable in here as well okay now after this let's scroll down now now we can invoke this S3 bucket and we can upload our data we can send our data so I'm going to say s3. send I'm going to invoke it and pass in the command okay nice now after this down here we're also going to need all of our AI related stuff right so we're going to need to transcribe um and pretty much whatever whatever we need to do to give the user that AI related titles and you know description all that kind of stuff so for this we will be using open Ai and Whisper AI whisper AI is going to help us transcribe our video and open AI is going to help us pretty much get a summary of um a summary of you know the title and the transcript itself so first thing we're going to do and of course we need to create the instance and all that stuff but let's just get the setup right so I'm going to say if file status so if everything is good to go and in here we're need going to need to get metadata and we're going to say hdp status code is equal to 200 then we're going to console.log and I'm going to essentially copy this right here paste it remove this I'm going to say video uploaded to AWS okay so this means we're we're good to go everything is uploaded successfully okay and then after that let's go ahead and start this process so we're going to say processing data. plan if this is equal to Pro Plan then we're going to say file storage. start so fs. start like this it's giving me stat oh it is stat guys not start and in here we're going to pass in the location so tempore upload and we're going to put a backs slash like this plus data. file name and this is going to to give us again you guys know it's going to give us an arrow function right a call back function so we're going to pass it an arrow function like this and this is going to be an async function and inside here we're going to check to make sure there's no error so if there's no error okay and this error comes from here so error and Stat this one okay so if there's no error only then are we going to pretty much Start The Whisper AI transcription so the most important part here and this is this might be a restriction well it's not really a restriction but you just have to know how to send it for now we're only going to be doing 25 megabytes okay so this is a restriction right now and I think this is just whisper ai's restriction you can't really do anything about it okay so what we're going to do down here is first we're going to do that and and you need to do this in order to avoid any errors right so so we'll make sure it's less than 25 MB and then we'll check for the file size before transcribing so we're going to say if stat. size is greater or less than 251 2 3 4 5 6 okay so make sure you type this correctly so there should be six zeros okay so if it's less than this only then are we going to do the following so first we're going to say const transcription equal to a wait and now we're going to need the open AI related stuff so let's go ahead and grab all of that all right guys so this is how we can get our open AI keys so one thing to keep in mind is from now I'm no longer going to open my environment file okay because there are some important keys in there and I want you to remember that this is private so do not share these keys with anyone okay so if I tell you to p paste the values inside your environment file you have to understand um you have to just read the code and see the environment key and then put that key inside the environment file if you don't have it uh or if you do have it just learn how to populate it okay that's pretty much it so first thing is you're going to go ahead and look for open Ai and you're going to click on login here this is the fastest way and once you're done with that it's going to take you to a login page go ahead and login to the uh create an account then you want to click on API right here and that's going to take you to your uh dashboard now you might have a different dashboard that's completely fine things change every single day okay the most important part in here is you need an API key so first thing is click on dashboard right here this one and then in your left side menu you should see API keys in here okay click on this and then click on create new key then it's going to give you an option to give a name for the key put the name for the key and then just hit enter it's going to show a popup okay and I don't have that of course but it's going to show you a popup and you want to make sure that you copy that and instantly paste it in your environment file okay because if you lose that key it's gone it's never going to come again so you'll have to delete it if something happens you can always go delete that API key key and bring up uh create a new one okay but like I said just copy that key and paste it in your environment file all right then the next thing is you want to go ahead and put in your credit card so the first thing I would suggest is you want to click on let me see Okay click on settings here and once you click on settings you should find limits so click on limits and then scroll down and you see something called usage limits right you want to add $5 as the monthly budget and $5 here as the email notification threshold okay so if your organization exceeds this threshold um you will essentially be you will get an email and that way they'll tell you hey you crossed $5 right but we already set this $5 budget in here so any API requests that go higher than this will not be considered now you need to put a minimum of $5 I think this is how it works works so just put five here and put five right in here as well okay awesome now don't be afraid to just invest five bucks on yourself trust me it's going to be worth it's going to be worth the $5 okay you're going to learn so much more and your $5 are going to do absolutely nothing in your bank account all right so get your credit card and put it in here you're going to learn so much more than just having five bucks and spending it on stupid McDonald's or something okay so put five here and five here don't forget this step okay then you're going to click on billing of course and then go in here and add a payment method okay put your card put your credit card and once you're done you should get a confirmation everything should be good to go and now that you have your API key you can go back to the code base go to environment of course I'm not stupid to open it but go into your environment file and paste the API key and you're going to call the variable if you don't have it um you want to call it open AI key okay it's this one right here so open AI key and you want to set it to that value that you just copy pasted okay that's pretty much it so now that we have our open AI key we can go ahead and start our transcription process so in here we going to uncomment this and we're going to say await and now we need to create the open AI object right instance so you want to scroll up top all the way here and below the env. config and you probably want to move this to the top I think that's better so let me move this here and move this here as well and the app can be here this is fine okay and actually the app should be all the way up top this is usually how I do it and everything else should be okay so now first thing I'm going to do is I'm going to say open AI equal to new and now we need to get the open AI API right we just imported that Library so we're going to go up here and we're going to say open AI like this and let me make sure I actually in install this so we have open AI okay awesome so import that from your uh import it like this okay and you want to say open AI require open AI then down here we're going to invoke this and inside this we're going to pass in an object and we have to pass in our API key okay and our API key is going to be that new value which is process. environment. openen key okay don't forget if you make a spelling error I cannot save you okay of course you can show up in the Discord and the chat bot should help you get everything up and running if you find any errors but just try to try to not make any spellings please okay don't be like me now I'm going to copy this open Ai and I'm going to go all the way to the bottom here and now we can make this request so the first thing I'm going to say is await open ai. audio like this do transcription transcriptions do creat and I'm going to invoke this and inside this I'm going to pass in the file okay why is this not entering okay I have to pass in a file actually but let me just make sure everything is good to go before we do that so we have open AI we're importing it okay this should be good usually it should give you some sort of type intence but if it's not that that's totally fine but let's go back down so we're going to say create and in here I'm going to create the read stream okay so I'm going to say file is fs. create readstream I'm going to use the backt and say temp upload dollar sign data. fil name and down here I have to say the model that I'm using okay and the model here is whisper ai1 okay actually it's whisper one so wh h i s p e r one this is what they have right now you can take a look at their API and change it if it ever changes in the future or you want to use something even more powerful okay and then I'm going to say response format is going to be text now after this down here inside this if condition itself right we're doing it inside this orange bracket we're going to say the following so first thing is we're going to say if transcription so if transcription exist everything is good to go then we're going to do this so we're going to say const completion equal to await open AI open AI do chat do completions do create and I'm going to invoke this and inside this I'm going to pass in GPT okay and the model we're using is GPT 3.5 turbo so I'm going to say model GPT 3.5 turbo and the response type response format is going to be J on object and then we're going to need a message right so we have to send this into our GPT engine and it's it's kind of like a prompt right so we're going to tell it that you need to generate a title and a nice description uh using you know the speech to text all that kind of stuff so right here I'm going to say message messages actually let me copy this so I don't make any errors here so I'm going to say messages and it's an array and it's going to take in an object and in here I'm going to say roll system like this what seems to be the issue here okay this is any type that's fine so system and here you are going to generate a title and a nice description using the speech to text transcription provided and the transcription is this so inside this dollar sign and curly bracket transcription and then return it in Json format as title like this okay the title you gave and summary the summary you gave okay that's it next we're going to hit enter so inside this if condition itself so we're going going to hit enter after this and we're going to say const title and summary so title and summary generated right here and I'm going to say this is equal to await axios dopost request and inside this I'm going to need to pass in our API endpoint so I'm going to say dollar sign proc process. env. next API host like this and then after this I'm going to say recording slash dollar sign like this data. user ID slash transcribe okay and let me make sure I don't make any spelling errors here all right nice so essentially we're sending an API request to our nextjs application to save all of this data in the database that's pretty much it so we're going to have an API point in there okay and after this we're going to also need to pass in the data itself right so after transcribe we're going to create an object like this and inside this object we're going to pass in the file name all in you know small letters in lowercase so data dot um where is the data okay data so we're going to say data. file name and inside this we're also going to need to pass in the content and content is going to be completion. choices z. message. content and then the transcription is also going to be passed in here okay I made an error here let me fix this and cannot find transcription I think I just completed transcription what seems to be the error so I made an error here guys I made a spelling error and this is why I say you should never do this and this is why I hate typing okay but transcription here okay so make sure you have the correct spellings and this one is transcriptions okay so now that we have passed in this transcription it's so weird I have to say it that way I'm going to say if the title and the summary generated. dat. status equal to or not equal to 200 then we're going to say console.log something went wrong and I can use the red emoji I got from here and let's go down and I'm going to say console.log something went wrong when creating the title titles and title and description okay awesome and cool and now after this down here you see we have a bracket right here right we're going to hit enter and inside this we're going to do the following so let me also remove this bracket this one is unnecessary we don't really need it and 1 2 3 4 five so after this blue one I'm going to say const stop processing equal to A8 axios dopost going to invoke that I'm going to pass in an object sorry I'm going to pass in the string first for the URL endpoints and I'm not going to make any spelling errors again so I'm going to copy this and paste it here okay and this one is process. environment. next API host recording and we're going to pass in the data. user ID SL complete okay and then after this we're going to pass in an object and this object is going to have the file name set to data. fil name all right nice and now after this one I'm going to hit enter here okay and here I'm going to say if the status is not equal to to 200 again I'm going to copy this and say something went wrong during processing okay so when we're trying to complete the video so something went wrong when stopping the process and trying to complete the processing stage something like this okay and after this I'm going to hit enter and I'm going to say if stop processing do status equal to 200 then we're going to basically unlink the file so I'm going to say fs. unlink okay going to invoke it and we have to give the folder so I'm going to say temp tempore upload slash plus data. fil name and this is going to take in an arrow function so let me also make sure this this is the right place okay this should be correct and this is going to essentially give me the error message so in here I'm going to say if there's no error then sorry guys this is not like this this is e r r I'm going to say console.log okay was that was so laggy so console.log and I'm going to say data. file name plus just a space plus another string here delete deleted successfully okay awesome and let me copy a green emoji and put that in here as well where is that okay nice cool now after this so we have this if condition after this down here we're going to say else or H actually not this one it's for this all right so else we're going to say cons cons. log and I'm just going to say something happened all right so error upload failed okay process aborted okay and I'm going to make sure I have this correctly written so this is here let me see where's the if condition for this all right I think this should be good to go so that's pretty much it now we also have our um our AWS stuff pretty much set up and we also have the the open AI stuff also set up so let's go ahead and grab our AWS Keys what's up prodigies just a quick reminder the remaining eight spots that we have left to get unlimited lifetime access to mentorship and every single premium course we ever create in the future including the prodigies university community is going to expire soon now the last time we did this we ran out of spots in less than 3 minutes so if you ever looking to join prodigy University and get guidance from SAS developers and business owners that are making over $60,000 per month this is your opportunity to join so by joining today you're paying a one-time fee so you never have to pay on a subscription base and you get unlimited access to weekly coaching calls and every single premium course we ever create and just as an added bonus for this enrollment period for the eight people who sign up today we're going to give you unlimited lifetime access to a CRM software that cost $497 per month this software is going to help you run run your entire SAS business including unlimited funnels unlimited websites unlimited automations unlimited email marketing forms and so much more you're going to need this anyway you might as well invest now join today so you can get access to all of this bonus value please keep in mind this is only for now so if you're joining in the future or you saw this video maybe two years from now we probably don't have this offer out so the best way to figure out what we have in today's offer is to click the link in the description and take a look at our website web prodigy.com and you can see what we have to offer so if you want to join this is the opportunity click the link and get started and I will see you inside prodigies University all right guys now let's go ahead and set up AWS and our S3 bucket and cloudfront and everything we need to host and stream all of our videos now AWS is one of the most requested features on the last poll and if you don't know what this is you are missing out on the opportunity to get your ideas featured on web prodigies okay so I know you already subscribed but if you don't click the Bell notification there's no point because the whole point in this is to get notified when that poll comes out okay and that poll is super valuable because people jump in there and they suggest the features that they want in the next project okay and we also show you um what the different options are the different ideas that we created um which we believe that are going to be amazing for YouTube and for your learning career as well okay my goal is to give all of this away completely for free because I want you guys to succeed I want each and every single Prodigy here to quit the round of five and pretty much run a SAS company because anyone can do it okay that's my goal and where I come in is when you're ready and you want to kind of scale your SAS if you're already at you know around 20 to $30,000 per month and now you want to make more money out of it then I can come in there and pretty much help you guys scale okay that's my goal so that's why I'm giving you all of this value completely for free so go ahead and turn that Bell notification so you can get all that value when it comes out on your feed okay so first look up AWS all right now there's a reason why I cannot actively search and show you in real time because I'm going to end up leaking some very important credentials that are crucial and you're not supposed to share anything from AWS with anybody okay I'm just showing you because I want you guys to learn but I'm not going to be able to show you the keys of course so just understand and I'll I'll also give you some guidance okay so look for AWS and it's going to take you to a Pages like this go ahead and create a free account all right so put your email address um and your AWS account name whatever you want it doesn't really matter but um go ahead and verify the email and there are a bunch of steps okay I think there are five steps and you're going to need to put your credit card of course um that's just how AWS works and once you're done with with that um you can then proceed to the next steps okay AWS is a monster of a service and you know they have I mean technically speaking all the third all the third party libraries that you see out there all the third party tools that help you do uh stuff like security scaling all that stuff under the hood it is AWS nothing else all they do is make it their own and they sell that service that's literally it okay so don't get overwhelmed but AWS is probably I mean it's it's big but you're going to learn a lot in just this one video okay so go ahead sign in create the account and once you're done creating account putting your credit card you're going to see something here called um the um the plans essentially of course click on the free plan okay and go ahead and click on complete sign up all right and once you're done it's going to take you to a congratulations page click on go to the AWS Management console okay and it's going to look something like this don't get overwhelmed but the first thing you want want to do is just scroll up top right here and you want to search for S3 buckets okay just look for S3 and it's going to show you the different services and go ahead and click on S3 all right S3 is essentially I mean you can read all the description and see what it is but you can store files inside this bucket that's pretty much it okay so go ahead and click on create bucket right here and that's going to take you into a file that looks like this um for the file name just put I mean the second you click on this is is going to give you like a file name or whatever just put the name of the bucket and that's pretty much it okay and click on create bucket and then it will take you to a page that looks like this so the first thing is you want to make sure that block all public access is selected and guys this this will change all right keep in mind this is constantly changing it's never going to be the same however the idea of an S3 bucket is pretty much the same okay so go ahead and block all public requests because we want our s re bucket to be private all right then for bucket versioning you want to make sure you click on um enable Okay I think this is so before this you'll see something like this okay so you can put the bucket name right here you can put opal web prodes application or backend whatever you want doesn't matter so put that in there and then uh make sure this acl's disabled is selected and then of course you know right click on the block all public access and then in here enable enable bucket versioning okay and then down here next for encryption we're going to enable server side encryption with AWS managed Keys okay not this one the one on top and then for the bucket key we're going to click on enabled then that's pretty much it everything else can stay as is just go ahead and click on create bucket do not click on anything else all right click on create bucket uh create bucket and it's going to take you to a page like this and it'll show your bucket in here okay next we're going to need cloudfront so click on um the search bar and just search for cloudfront and then click on this one cloudfront right here and that's going to take you to a page that looks like this but first before we create Cloud front itself we need to actually create an origin access distribution and cloudfront will use that distribution to basically distribute content okay so click on this sidebar and down here you're going to click on Origin access okay that's what we're creating so go down click on this and then it's going to take you into a page like this and then you want to click on no origin controls okay so once you're done clicking on this oh sorry guys you want to click on the create control settings I was actually reading this and I accidentally said that so yeah you want to click on create control settings and that's going to take you into a page that looks like this so go ahead put the name I'm just going to call it video streaming um OAC okay origin Access Control right that's it so put something for the name and here you want to click cck on sign in request okay so click on this and here the origin type has to be set to S3 and then go ahead and click on creates and that's going to create our um our distribution sorry our origin access like this and now that this is done you can click on distributions and then we can go from there okay so click on distributions right here inside the nav bar or sidebar and then that's going to take you back to cloudfront okay so once you're on this page now you can click on create cloudfront distribution now if you've already used all of this you probably are not going to see this introduction page right you will just see a table that looks very similar to something like this and just click create on the side okay so click on create cloudfront distribution it's going to take you into a page that looks like this the first thing you want to set is the origin domain so for this you're going to click on the drop- down and you're going to click your S3 bucket okay so click on that and next if you scroll down you're going to find this origin access right here click on Origin access control settings okay and then down here you're going to hit this drop down and you're going to create that origin access that we just created and the second you do that it's going to show a message that looks like this that says You must update the S3 bucket policy and don't worry we're actually going to do it later not right now but just um make sure you change this one the drop down right here to that new OAC that we just created then down here I think everything else should be fine you can leave this stuff um okay so for viewer protocol policy you want to set it to redirect HTTP and to https okay that's just a secure way and that's that's what I recommend you do and then in here you're going to have web application firewall now this is the I think this was a newer UI previously they never had this but I just selected do not enable security protection and if you want to learn about this guys in AWS I mean a WS is pay as you go for everything right but usually when you are when you're trying to click on something you don't know what is paid and what's not this info is a hint okay if you click on info they'll show you AWS WF pricing and that way you can see what's the pricing involved and all that stuff anyways it's just like couple cents and stuff like that so you shouldn't really matter again read that and then that's the true source of all truth okay so select do not enable security protection so that way we don't get this extra stuff right here and then everything else can stay as is just make sure you have the same options on your end as well and once this is done you can go ahead and click on create distribution okay nice now it's going to take you into a page that looks like this okay this is where your distributions are and in here you can see it's probably still going to be deploying so if it is don't worry just keep proceeding because we also have to create the policy right so you'll see the nav bar right here they'll show you this thing you want to copy this policy it'll they will give you the policy Okay click on this copy this policy and then you see this link right here you want to click on the go to S3 bucket permission link okay so click on this one it's going to take you into the policy page and that's going to look something like this right or actually for you what's probably going to happen is it's going to redirect to a page that looks like um I mean it's probably going to be be the bucket itself okay so if you see right here you have permissions right this is the permissions Tab and click on the permissions tab not objects or anything else this one okay because by default it's going to redirect you to the buckets uh Slash you know your bucket itself so click on permissions and down here just scroll down okay scroll all the way down you're going to find the bucket policy right you're going to find this bucket policy here you want to scroll to the right and you want to click on edit okay and once you click on edits it's going to take you into a page that looks like this in here you want to just paste your policy so click and paste and then click on Save changes at the bottom right here okay and once that's done let's go to the next page okay once that's done it's going to take you into a page that looks like this and this is essentially the policy and uh I mean this is basically your your distrib bution and as you can see now mine is already completed for you it might take some time right but um now it's completed and now that it's done we can go to our bucket to essentially upload a new video if you want okay so if you click on the uh let me see right here okay so switch the tab right or you can go to buckets you can go back to S3 click on the search go to S3 and it's going to take you to Amazon buckets right go back into that and then you click on object objects and once you click on objects now you can go ahead and upload a video but we don't really need to do this part um because we're going to be uploading everything through our API through the API and the SDK right but if you wanted to test it out you can do this if you want but don't do anything right now because the next step is we need to get all our API keys from this and the access key as well okay all right guys so now that we have set up our S3 buckets and Cloud front we're going to need an a ACC key and a secret key okay so please follow this from start to finish and again do not share this credentials with anyone else okay so you're going to go back to your AWS console all right you can just click here or if there's a go back home button something just click there so it takes you here or you can just use the search field and you can look up users okay and that's going to show you I am feature I am am Okay click on this all right you want to click on users click on this one and it's going to take you into a dashboard that looks like this okay I stands for identify and identity and access management okay so we need to essentially create a user that can get access to our AWS console okay so you're going to go in here and you're going to click on create user and that's going to take you into a page that looks like this I'm just calling this super admin you can call it whatever you want I'm going to call it super admin and then I'm going to click next that's going to take me to this page where I'm going to first click on attach policies directly and the reason is because we are going to need to send uh we are using our node.js environment to call right AWS so we're going to need to click on attach policies directly so that way we can attach the exact policies that we need okay so if you don't see this it's because you have to first click on this so click this and then all the permission policies will show up here and then on the and then essentially you can look up only S3 look up S3 in here and then you want to select Amazon S3 full access that's what we need okay so go ahead and click on this policy and then you want to click on next and it's going to take you into a page that looks like this you can verify if you need but it should be correct and then go ahead and create the user and it might also send you into a p into another page with a description or something like that just just keep pushing all right just go to the create user Tab and click on create user done now you have this super admin right here right it's going to take you into the IM IM dashboard and you can see you have the super admin user click on this user and it's going to take you into a page that looks like this now you need to create the access key and you can create the access key in two ways One is using the shortcut here okay create access key or you can go into security credentials and then you'll have to scroll down until you find access key the header it sort of look like this and it'll say access keys and under that you'll see a create button and then you can create an access key from there but I'm using this because it's a shortcut so click on create access key and that's going to take you into a page that looks like this now our application of course is running outside AWS so for that reason you can click on this option right here okay which is you uh you plan to use this access key to authenticate workload running time in uh running in your data center or other INF structure outside AWS that's what we want so click on that and click on next and then it's going to ask you description tag value just skip over it click create access key and that's pretty much it now it's going to give you access key here like this you want to copy this and inside your uh environment variables you're going to find access key AC C sore key all in caps okay paste the value inside the access key and then for the secret key you're going to find another one inside your environment variable called secret key okay or just take a look at what it what it says inside your environment file and then you want to essentially copy this key and paste it in there okay and I'll also show you just in case uh how to get the right spelling so you don't make an error okay and I'll show you what it should look like and that's that's pretty much it okay and then make sure you click on done and that's it guys now you have your keys and you're all set ready to go all right now there's one more environment variable that we need and this environment variable is called bucket region okay and here you can also see the spelling of access key and secret key okay so do not make this spelling error now when you're passing in the region if you go into your AWS console and you can click on this and click on S3 or you can just look at S3 right here or you can click on buckets as well okay it's going to take you to this page right where you can see all of the buckets you have created and in here we just created this new bucket you uh where we just created a new bucket you're going to see the AWS region right here and the value is only this section nothing else okay us us east2 I don't think you need to put all of this just this part right here so mine is us east2 go take a look at yours so you know where yours is hosted and then get that string and populate your do environment file um under this specific key okay awesome now open up the terminal and I'm going to say npm runev for our Express server next I'm going to go to our desktop application and I'm going to say npm this is the electron right npm run Dev as well so run Dev and finally we also need the web application version so let me go ahead and grab that okay right here so I have this one set up awesome cool nice now hey I can see the video and I can also see this module right here and the other one our tray right here okay so we can go ahead and first ensure that our socket is connected and our socket indeed is connected so we're good to go on that side and our next step is we're going to need to try to record okay we're going to have to try to record and see what happens if everything works great if an error took place no problem we will solve that error okay awesome now go ahead and I'm going to put this in here and let me move this up here and let me record hey how's it going this is parin here from web prodigies and I am recording this video but unfortunately it crashed okay let me take a look at um what happened okay give me a second guys at our application which is our web application version and of course we didn't first create the endpoint right remember we were sending some data from our Express server right and we we have to listen to that on our web application version so go ahead and you want to open up this API folder in here and inside this API folder we're going to need to create a bunch of folders or routes that's going to help us accomplish this so the first one is called uh let me hit on this one more time okay we have to create a folder called recording okay so I'm going to say recording like this and inside the recording folder we're going to have a bunch of other routes that's going to help us accomplish this so first create another one which is a dynamic ID and inside that you have to create complete and then inside ID you want to create processing and then we also need transcribe right so I'm going to say let's create another one why did this do this okay don't make any spelling errors okay all right so complete processing and transcribe nice now first let's do the processing okay the processing route so I'm going to click on this and say create a new file and say routes oops what's going on here okay inside this one route. typescript and inside this first I'm going to export an async function okay async function and this function is called post all right and inside this we're going to first get our request which is going to be of type next request okay and we're also going to get some pams so which is the ID so let's go ahead and say pams and these pams are going to be as follows which is pams like this and that's going to have an ID which is going to be a string and I'm also going to hit enter here because I like to have actually no that looks horrible let me keep it like this never mind okay so first we need we're going to need to get the body from this so we're going to to say const body equal to await request. Json we're going to invoke that and then we're going to get our ID from the params as well so I'm going to say params okay um sorry equal to like this we can destructure we can also destructure directly in here but I'm going to do it down here and then I'm going to say const personal workspace ID equal to await client. user and client comes from Prisma client so let's grab that and I'm going to say user. find unique we're going to invoke that and in here we're going to pass in where and I'm going to say ID is the same ID and we're going to select the following info so we need the workspace like this and in here we're going to say where the user's workspace is of type personal and from from that we want to select this information we want ID set to true so we're going to get the ID and then we want to order by created at in this ascending order okay so ASC awesome now scroll down here and after this and guys also you should definitely put everything in a TR catch block okay I made this error before and it was just really annoying it doesn't I mean it's not going to break any I it is going to break something if you don't have TR catch but it's going to make it so much easier to debug right so in here you see we can just console and print the error right so I'm going to copy this and I'm going to print saying error in processing okay or let's remove this so we know this error is coming from this endpoint right so error or I'm just going to keep it error in processing video okay and let me go in here now and also print the error so I'm going to say error like this so after this hit enter and we're going to say start processing now so start processing video equal to await client. workpace do update and now what we're going to do is we're going to say where and we're going to say ID is personal workspace id. workspaces at z. ID okay and then the data we want to update is for videos and we're going to create and a placeholder right so we're going to say the source is going to be body. fil name file name okay all lowercase and then the user ID is going to be ID okay and after this green bracket or after let me see so this is a green bracket this is a blue okay so after videos right here after data you want to say select and in here we're going to select the user okay and for from user we're going to select the subscription and from the subscription we're going to select the plan itself so plan is going to be true okay and now after this down here you're going to say if start start processing video was successful then we're going to return next response. Json Json and we're going to invoke that and we're going to pass in the status of 200 and our plan is going to be start processing video. user. subscription. plan and if nothing happened here we're just going to return a status of 400 okay awesome cool now that we finished the processing route let's finish the transcribing route okay so we're going to click on transcribe and inside here we're going to create route. typescript we're going to export an async function called post and this function is going to do the following so first we need the request so I'm going to grab that so it's of type next request all right and inside this I'm going to also oh oh sorry we're also going to get the pams right so pams and this is going to have pams which is going to have an ID of string okay and now inside this function I'm going to say const body equal await request. Json and then I'm going to destructure ID from the pams okay and once this is done I'm going to say transcribe so const transcribe transcribed equal await client. video. update and in here I'm going to say where our user ID is going to be ID and the source is going to be the body. file name okay but we want to update the following data so we're going to say data is title and this is going to be the content and this content is going to come from our body right so I'm going to say const content equal json.parse body. content okay like this and now I can say content. tile okay and after title description is going to be content. summary okay I might need to change this let me let me zoom out a little bit I think I zoomed out zoomed in too much for you guys let me take a look at the other application and what are we doing in here so summary summary my passing any summary anywhere okay so I made the error here okay let me see if I have this spelling somewhere okay so all of this is going to need to change to this so so let me first click on this one change it to summary this one I'll also change this here as well a y okay summary and summary in here as well okay and that should not leave us with any errors okay no errors awesome okay not sure if that is going to cause any problems but I took a look at this in here and maybe it will because we have title and summary right and we have the title and summary as well so I just want to make sure I fix that okay all right then after this we also need the summary which is going to be the transcript so I'm going to say transcript and we're getting our transcript um from whisper AI okay awesome now after this down here we're going to say if transcribed if this is successful then first I'm going to print a message saying storing storing in KB okay and after this I'm going to need to get some options so const options equal to and the method is going to be post our URL is going to be um actually we can also see if this works first because H let me think guys give me a second okay so instead of this what we'll do in here is I'm just going to say if this is good to go everything is successful then I'm just going to return a 200 and I'm also going to put a work in progress flat flag and say wire up AI agent okay all right we need an AI agent to essentially enable communication between the the transcript and the video and the customer right because we're going to have this super cool AI feature where the user can also text the the AI and get responses right so we're going to need an AI agent that can handle the knowledge base and stuff like that so for that right here I'm just going to say next response Json like this and I'm also going to say console.log and we're going to print a green color icon and say transcribed okay all right awesome so now that now that we created this let's also do the complete process so inside complete route. typescript I'm going to export an async function called post we're going to invoke this and then here we're going to pass in the following so first we need a request from the pams I'm going to say request is next request okay and then after this we're going to have the pams so pams and this is going to be of type pams and ID which is going to be string and inside this we're going to say const body8 request. Json and we're going to destructure ID from pams and then I'm going to say um complete processing and this is essentially what we're going to do in here is we're going to go into our database and remember I told you in the starting that we're going to create that placeholder entry right we just need to update that uh that Boolean property processing to false so I'm going to say const complete processing equal await clients. video. update for this user ID and the source where it is this file name and we're going to change the data from processing which was true to false okay and if this is successful we're going to return 200 response and we're going to say next response. Json and return 200 and if it wasn't we'll return 400 let me see if I'm doing okay if this is not I'm going to return 400 and I'm also going to console.log a message here saying something went wrong okay encryption went wrong all right awesome okay so now that we have this let me also make sure we have all other end points if not I'll come back and create that's totally fine okay let's go ahead and try once more guys so I'm opening up the terminal here make sure this is running make sure our Express is also running okay socket is also completed and I'm going to save this once more and try to connect the socket again all right nice or I might need to quit first guys sorry let me first quit and then I'm going to restart so npm run Dev you're going to see a sudden burst in volume give me a second okay all right cool now that we have this I'm also going to show you so everything is running here okay and we can try once more and see how it goes so you see socket ID was disconnected nice and we connected a new socket again all right so this is the video and I'm going to go ahead and try to record so I'm recording with this device and the screen that I'm recording with is going to be let me change it well not screen okay screen Well Screen two not screen one okay cool is it recording all right it is recording cool all right guys ready 3 2 1 app crashed again waiting for file changes before starting and it said status 500 so I'm going to stop this all right guys so something looks wrong I need to go ahead and fix this first so let me do that and then we'll continue okay so I found the error and it's super super annoying I'm just going to show you what exactly happened okay so first problem is I noticed that when I looked at the console the message or the error message that I was getting it wasn't very descriptive which means it's because the I mean the node modon is pretty much crashing and that's exactly what happened received 500 the other thing I noticed is we did not get this type of error so what that's telling me is the error is probably happening in some part in our application above this place because this is the first type of error that we're printing right and the other thing is I'm not printing any data like I'm not saying console.log data or anything so this data I'm getting is an eror log that noon is trying to give us that's pretty much it so what I did is I essentially hid everything so I commented out everything in our file and one by one I tested each and every single line okay only up till here because I know the problem was happening somewhere around this area and I also tested this section first and you don't want to test each line right you want to test each section and then based on each section then you go into it right so I tested this section this was good to go so video chunks were being saved but our processing had an error so I commented out everything in here and I knew it was going to be in here somewhere and then I noticed that this line wasn't here so if I mean if we don't provide any data here that also means that on our web application we're supposed to get a unexpected end of Json error right and that's exactly what we got in here right you see unexpected end of Json on so the fix here was just to say file name data. fil name and you want to pass it in here and that's pretty much it that was the fix okay so I'm going to try once more going to scroll all the way to the bottom want to make sure I'm recording the right screen all right and my socket is connected awesome and now let's go ahead and record hey how's it going this is parin here I'm recording this video to show you the power of opal now you can use opal if you want want to just send a friend or a family a good message or pretty much whatever you want you can also use it for client Outreach and in fact that's what I use when I want to help out clients in the field of SAS okay awesome so if you like this video and you like the software you can go ahead and you can go to opal web prodigies on YouTube and you can learn more about how we built this full stack application okay so I closed it and if you take a look at the file structure rure we see a temporary file okay and it looks like it also deleted it or did it hm so video chunk was saved something okay let's just take a look let me go into my AWS console and I'm going to do that off camera of course so just give me a second all right guys so I found the problem so you see here this is the order first we need to get the first chunk right so socket connected then first chunk then the chunk has to be saved and then every chunk that comes in has to be saved accordingly right in the right order and then when we hit stop the video should pretty much stop and we have to process the video and then upload it to AWS and then also delete it from the file structure this is what we should do now if you look inside our code you're going to find this beautiful error that we made here this right here was renamed to on start so what we did is we passed the on on the stop recording function which is right here which essentially emits the process video event we assign that to the on start instead so when we were recording what was happening is it was instantly stopping the video so because of that of course we're not even getting any of the thumbnails or we're not even getting the video itself so that's the first fix okay and I'm going to show you something right here so you can take a look at this let me move this into I'll just keep this out for now okay there you go you see our video looks amazing right and if you click on it it takes you into the video section and you can see you know pretty much the title whatever now the second error that we had to fix was inside our application itself so not this one we're going to go into let me see not this either okay this one and you're essentially going to put your cloudfront url okay if you don't know how to get the cloudfront URL I'm going to show you in just a second okay so you want to go into cloudfront inside your AWS console so you can search literally search for cloudfront in here and then you're going to find this uh option click on it and then you want to click on the distributions so it's going to take you into this page and then you want to click on your distribution okay the one you created and this right here is your cloudfront url okay so copy this URL and then you're going to go into your EnV and you want to add that URL without the trailing uh backslash okay and that's essentially going to help us render the video in the first place so that's why we weren't seeing any any video okay I'm seeing this error so I'm just going to refresh my front end and let me go ahead and say Bun Run Dev I can't type okay and let's also refresh this and let's give it a second okay there you go awesome so that fixed our problem where the video was not being saved and that's why if you had an opportunity to take a look at your dashboard you would find the video being created because we were processing it first and then we were saving the chunks okay so the video itself wasn't getting pushed to AWS okay it was only like the first section itself because when processing gets fired it does everything okay now the other problem I found is with the microphone so you're going to notice that the AI is still working it's working it does its job but there's no transcript of transcript for our video that's because I think there's no audio okay so you see right here I'm recording something and I was singing a song but nothing was working okay so our audio transcript is not being created so that's the next bug I need to solve which is why is it not even sending and I think it's something to do with electron and after that I think all the major bugs are pretty much solved and then we can move on to hopefully no more bugs okay all right guys awesome I will see you in about 10 minutes cuz I need to go get some food and I am starving peace out all right guys so I'm not entirely sure as to where the audio error was coming from but the first thing I changed was in here I had a if condition and I was rendering something else I think I was probably rendering false or something right so yeah I was rendering false if this does not exist and it doesn't really matter I just added that in there and I think that's not the problem I think it's the microphone that I'm using that is not compatible because it has a software and all that kind of crazy stuff so I think maybe that's what's going on okay because I recorded a video right here and as you can see all the way at the bottom testing out new microphone okay all I did was change my microphone input and that just fixed the problem so that could that's probably what's going on okay now if you click on it just to show you that it works um okay it looks like I also got oh I'm getting this because I'm out of memory my entire computer is getting fried let me go ahead and spin this up again okay there we go so first thing title it's exactly what I was talking about then we have the description which is pretty much it's pretty decent it does a job okay and if you click on transcript you can see it's giving us the transcript as well all right so a bunch of stuff is going on and I think the transcript might be wrong I think what I'm doing is I'm setting the transcript and I'm kind of mixing the transcript and the description so that's something that I might need to change but apart from that if I click on this hey how's it going just T microphone there you go you can hear it's a horrible microphone okay I'm just using the Mac the MacBook microphone but you can see it works okay so that's it for this part now we have a couple more things we need to fix um let me also go ahead and see if I can fix the description and the transcript bug okay all right guys now go ahead and quit your node modon server and also your electron server as well okay we don't really need it for now and you're going to open up your folder structure in your web application version and you're going to go to videos preview index. TSX and you're going to scroll down here and you're going to notice we have this editor component right so go in here and unmute uncomment this okay and if you don't have it just go ahead and type this out and um essentially we're going to build out this component and one more thing is scroll down here and if you notice inside transcript this was actually description you want to change it to summary okay and now let's go up all the way up here and we're going to copy this and we're going to open up our folder structure and inside the videos component we're going to create edit. TSX and now inside this I'm going to return a component using tsrce and let's rename this component now this is of course going to need those props that are being passed in so we need the title description and the video ID and I'm also going to go ahead and destructure these values and inside this component we're essentially going to render a model okay and this model is going to have a form where you can pretty much edit the video elements so let's import this uh edit video component let's go back into the component itself and now we can render out this component so let me see if I can okay here you go edit video see this right awesome so let's go ahead and return a modal component okay and this modal component is going to need a title and a description so I'm going to say title and I'm going to set something edit video details and you know description as well doesn't really matter just put something for now and then we need the trigger so for trigger I'm going to set this to a button component and this button is going to have variant of ghost not value variant of ghost okay and then we also need class name name so border 2 like this and inside this we're going to create an edit button okay so I'm going to use the edit icon so it just shows like this and you can give it a dark color if You' like let me go ahead and set one right now okay and you can also probably we can probably just remove this border right it looks horrible and maybe we can change this make it slightly darker okay all right that does the job job I think people understand right so when you click on it we can show all the details and we can go ahead and edit these items okay so the first thing is we're going to create a component inside this model called edit video form now I'd also like for you to take up a small challenge now the ideal user experience would not be this experience right here which is basically you know having a model and the user has to update the information through the model remember how we had the rename functionality for folders that would be the best experience okay so I'd like for you to try to see if you can create the same experience for this and what that means is when they user double clicks the title here they can directly change it and when they click outside it saves okay and the same thing for the description as well so I think this would be a great feature to have and I personally love it when I have to do that and I hate models okay so now let's go ahead and create this form component so open up your folder you want to scroll into forms right here and you're going to create a folder called edit Das video and inside this an index. TSX and you guys know a schema. typescript and let's return a component here and I'm going to rename this component and this component is going to need the video ID the title and the description so I'm going to grab all of this so that way I can populate it as default values right and in here I'm also going to destructure these values okay and now we're going to use a hook called use edit video so open up your folder structure go to Hooks and in here I'm going to create use edit video. typescript and I'm going to say export const use edit video okay and this is going to be an arrow function let me zoom in a little bit more so you guys can see clearly and in inside this again it's we're going to need to pass in all of the values right the video title and description that way we can set the default values using uh Zod forms so in here I'm going to say const and set this to use Zod form okay I'm going to invoke it and now I'm going to get access to a bunch of values so I'm going to go ahead and grab as many as I can get okay like this if we don't need something we can remove it I mean actually we don't need anything other than form submit register and errors so let me remove this watch we don't really need this just this is good enough okay and now we need to pass in the a schema so let's open up our folder structure and I'm going to go into our form why why did I lose access to the form oh okay it's right here so scroll up into your forms component and inside the schema we're going to say import I think you guys already know this stuff right so no need to type important stuff so we're going to get the Zod object and then we're going to create our schema so export const edit video infos schema is z. object with the title description and that's it okay title is z. string with minimum of five characters and if and we can also provide a message here saying the video title must be at least five characters and this will be used for the error message and for description we're going to say z. string. Min 100 and the video description must be at least 100 characters now let's go back and let's quickly pass in the schema like this and let's import the schema okay and next after this we also have to pass in the mutate function now for mutate we're going to get it from use mutation data so I'm going to say const use mutation data and we're going to invoke that and now we're going to get access to mutate and is pending so let's grab these values vales and now we can pass those values in here so after this we can say mutate like this and then we're also going to need to pass in some default values right so I'm going to pass those in as well so I'm going to say title and description okay now for the use mutation data in here I'm going to pass in the mutation key first so this is edit Das video and then we're going to need a callback function and this callback function is going to give us access to data which is going to have our title which is going to be a string and our description which is going to be a string as well and after this we're going to basically pass in a server server action that's going to help us change this data so This Server action is called edit video info okay and we just need to pass in the information that we have so far so first thing we're going to need inside This Server action is of course the video ID so we can update for that video ID then the next thing that we need is the data so data. tile and data. description okay awesome so now that this is done let's go ahead and create that also we need to just pass in the the key for the mutation not mutation key but the query key so I'm going to go ahead and say preview Das video okay all right now let's go ahead and build this out so I'm going to open up my folder structure going to go into actions into workspace and inside here I'm going to say export const edit video info which is going to be an async function and inside this first thing we're going to need to do is we're going to need to capture the user information right or actually we don't even need to do that what I would suggest guys is you take this server action and try to figure out a way to just put it in another server server action so we can just fire some default data okay like verify user okay something like that so down here I'm going to essentially get those values that we're passing in as arguments right so let's grab those and then I'm going to pass in a TR catch and inside the TR catch I'm going to say const video equal to await client. video do update so essentially first we're trying to um we're trying to essentially find this video with the video ID that's passed in right so you're going to say where okay where the video ID sorry guys where the ID is like the video ID that's passed in and after this we want to pass in data and for data we're going to just pass in the title and the description so these are the fields we want to essentially update and after this if we got a response and everything is good to go we'll return 200 and say video successfully updated if not will return 404 and say video not found or in here will return another 404 as well okay that's pretty much it now let's go back and import our beautiful server action did we already have this of course I don't think we have it yeah what am I saying never mind okay I just s thought I saw something it was a little confused there okay so now that this is done this Hook is created we also have to return all this data so I'm going to say return and then an object on form submit register errors and is pending okay now let's go back and now inside our edit video form we can use our new hook so const we're just going to use this for now and then I'm going to say use edit video and now we can destructure all the values so error is spending on form on form submit and register and now I need to pass in our video ID the title and the description so once this is passed in I can now create my form so form like this if it will give me okay thank you now I have to pass in my on submit which is going to be the on form submit and the class name is going to be Flex Flex Das column Gap D y-5 okay and inside the form form element or the form itself we have to first have input Fields right so the first one is called form generator you guys know this magical component that we created right so let's go ahead and import this form generator component we need to pass in the register let me also open this so we can see what's going on okay pass and register and is it even rendering anything I don't think so okay that's because we haven't imported it so let me go ahead and import this component so now we can see what's going on okay nice so we have the form component form generator component in here and for register we're going to pass the register that we just got from our hook errors the name which is title input type the type which is text the placeholder and the label itself okay so now when you click on it you see there you go now for some reason default values is also not being set but that's something that you can just look into if you'd like but I think it should technically do it because of register let me take a look guys give me a second so use Zod form I have handle submit in here default values okay so if you want you can technically pass in default values into this just take this um you see the third one so schema mutation and default values right so schema mutation and default values so what's what why is this not really working it should work okay I think I know why all right it's not too big of a deal um you can take a look at one of the last videos I think I have a better approach to it but because you have to reset some values and stuff right I'm not really bothered too much um I just want to make sure that our elements are working as fine right as intended so the next one is the register again for the description so register label errors name input type is going to be text area and the number of lines you can reduce this to four or five I'm just going to put seven here or five sounds better and then placeholder we're going to say video description so the user can also update it directly from here okay and this is not hap this is Gap Dy of five that's it so now you can also update the elements of these uh the video file itself okay great job so now let's go back into our component right here because we need to pass in our props and we're going to pass in the video title and description oh that was okay never mind thank God I thought I had to go ahead and set up reset and reset form values or on all that kind of weird stuff weird stuff but okay so it's working sorry about that it's just because we did not pass in the video ID and the title and description here again apologies on that okay so let's go back and if you scroll down you're going to find another edit video right here so go ahead and unmute M this one as well okay so that way we can have that component show right here as well so you can edit here so yeah guys I would like to see you take this up as a challenge and try to do the uh double click for this as well I think that would be a really nice feature to have and just to show you our transcript is showing the right transcript now um and it looks like the description is pretty solid okay pretty AI generated but you can do some prompting I'm sure you can do that now there's one more amazing AI feature we need to still create this is the AI agent and in my opinion I absolutely love this feature because I myself would use it as much as possible the AI agent is smart because it's aware of the context of the video that means it knows every single thing that's mentioned inside the video itself super cool feature right so that means if someone wants to ask a question they can get answers from that video in the context of that video now this feature can be really useful in a course creation you know application SAS application for example let's say that course creation platform gave access to opal right they partnered up with Opel and said hey you can host your videos inside this let's create some partnership here right and essentially when you share your videos and you pretty much put it into opal sorry you put it into their platform you get you you can also give their students right their students access to this AI agent so if they have questions about course modules they can ask the AI agent and it will give them answers and another cool feature is let's say if they want the time stamp of a video that they want to revisit but they just forgot which specific module it is the AI agent is aware of all the knowledge and it can tell the user that you know this is the specific module and this is what I got from it this is going to help you right super helpful feature another one is imagine if we want to explain our modules or or not explain but basically communicate all of our modules but in different languages this is a complex task if someone doesn't understand something and you only explain in English well that's a big population that you also want to help out right but this AI agent can also explain in different languages so you see the possibilities are pretty much infinite and we are able to help more people by just having this AI agent feature right but before we build that I also want to show you another powerful feature or not a feature essentially it's just the homepage inside our dashboard and this homepage is going to act as a mode of communication between you and your customer okay that means in this page we're going to have a way to not essentially send email marketing but Market in a less aggressive Way by also conveying the message and the power of using opal and they themselves will see how powerful it is because of the features we're going to put inside the homepage okay so let's go ahead and get started with that now go ahead and pause what you're doing I'm going to explain some Concepts that are going to help you build smarter and much more scalable user experiences for your website or your SAS application now in most SAS applications we're going to have a mode of communication right between our SAS and our customer some might even choose to have multiple for example customers can maybe subscribe to an email marketing channel and they can get email messages right emails that essentially show them the new cool features that our SAS offered right or we could have another Channel which is a YouTube channel right and we can probably share new messages new features inside this as well another form could be something like a newsletter right so there you see there are different ways of us communicating with our customers now in my personal opinion what better way to show them the power of opal other than just using opal itself to deliver our message if we could figure out a way to deliver our message to our customers without them having to look into their your email or a YouTube channel or subscribe to a newsletter that would mean that we have successfully showed the power of opal to our customers so I decided to have a homepage and the homepage is going to render out a bunch of videos that are recorded by the team by the opal team okay and this is a much better less aggressive approach to speak to our customers because first they get to see the power and impact that opal makes because they themselves are learning how to use opal by just watching this video cuz we can have like a tutorial in here teaching them how to use opal or we can also showcase new features so you could essentially have a section here called new features and you could share the new videos down here right this brings infinite possibilities and also you're able to build something a little more interactive right it's not just hey here's an email take a look at it this is a new feature go by right nobody cares we want to build a relationship with customers and what better way for the CEO to literally take a video and say hey this is me using the software I just want to show you the power of opal and I just want to send a message across to teach you how to use it that would make a big difference and we need to make this work inside our application but there is a problem sure we can go ahead and just create a video and then we can store all of those inside a separate table inside our database and we can render out that data on the homepage we can do that of course but that brings a lot of restriction to what we can show on this page first we would need to either build a full front end right that means we would have to have a whole different page or like sort of like a dashboard like an admin dashboard to give access to different entries right we can have different entries in this table and the user or the admin would have to go in there and populate it but now essentially we're creating a whole different application so we would need to build a whole team to essentially handle this aspect which is our admin dashboard because our other Dev team is going to be focusing on building the product which is our which is basically our primary source of income and we're also going to need to make this admin dashboard secure that means authentication is going to need to be strict we're going to need to test it we're essentially pushing ourself back probably 2 3 months just putting in time and effort into something that's not a direct return on our investment and if you ask me I'd rather have my team focus on building a stronger product delivering a powerful message and improving the user experience providing more features and in turn you know increasing the lifetime value of my customer than just creating something that doesn't do anything and there's a lot more things that we're going to need to do in order to manage this data and the other thing is is the other option is the user can just I mean our one of our admins can go directly into the database and populate the database itself but that in itself just doesn't sound like a good solution or something that can be scalable what if you have a Content marketing team or someone that knows how to manage the content on your website you would also want to give them access to that portal or to that admin portal so that they can go directly in there and change whatever dat the whatever data they want and the data will automatically populate on the front end I'm sure you guys know what I'm talking about but this is CMS which is a Content management system that can essentially help us manage data in a user interface and also populate the data on the front end that means it's sort of like a like a no code solution but that brings up another problem if we need to render this stuff on our web application we're going to need to connect the CMS itself into our application and usually this is a restriction with most CMS providers and what I mean by that is usually what you find online is they give you access to a website hosting service or some sort of a web Builder or something like that where you cannot extract this feature in itself and use it inside your web application and that's when Wix Studio comes in so Wick studio is also supporting this video so that's why I want to give them all the support by by showcasing their amazing CMS features so with the help of Wick Studio we're going to get access to a CMS feature that is Standalone that means we don't have to leverage their web pages right we can use our own web application because we get access to the Wix data API and because we're getting access to this we can essentially communicate with their CMS but we can also make queries we can filter and sort data the way we like and since we're already powering up stuff with AI we can also use this feature and we can connect it with AI and get much more tailored responses and I've also taken a look at other options out there for CMS and Wick Studio does a pretty good job because other CMS providers you're going to need to upgrade in order to get maybe 5,000 or even 10,000 or even 50,000 items but Wick Studio can get you up to 100,000 CMS items that's a lot of data and we can we can pretty much render every every single page inside opal if you were just using Wick Studio CMS offer right and yeah guys they also have plans that have unlimited bandwidth so you can pretty much handle all the traffic that comes into your Cs and you probably don't have to care about scaling and stuff like that as well and again Wick Studio offers so many more features of course but um another great feature is you can connect all of your Wix applications into your web application as well right so for example there is something called Wix app collections inside the CMS and this is essentially like a database that you know gets added to your site or to your uh to your app where you can essentially get Wix applications inside that right so an example is Wick stores which basically come with product collection so you can essentially create a product store and you can put that on your website right and another example would be Wix bookings so essentially you are getting access to all these applications that you can leverage using this API another great use case of wix's CMS is what if you are using a custom form Wick studio also has a custom form offering that means with the power of custom forms you can leverage that and embed it directly into your site so you can capture user information and you can store it inside CMS items and you can give access to your team so they can essentially probably do email marketing imagine this right imag imagine if clients signed up and instead of you sending an annoying email marketing campaign your you had someone that's in charge of you know client relations and they send an opal video to every customer that's crazy right that's so nice no one's ever doing that so we will be leveraging Wick Studio to build out this section inside our homepage this is going to give us the ability to launch campaigns introduce new features or even have an onboarding experience to teach teach our customers how to use opal and the best and most important part is we can Outsource all of this work to another member of our team who gets access to a beautiful dashboard and a beautiful CMS UI right that comes from Wick studio and they can just go in there change all the data or launch new campaigns and that's going to instantly update our homepage okay so let's get started all right guys now go ahead and scroll to the description you're going to find a link called wix Studio dashboard okay and this is going to take you directly into our dashboard which is the workspace dashboard not the website dashboard okay then you're going to go ahead and click on create new site and click on Studio project okay Studio blank project and that's going to spin up a project for us let's so let's just give that a second okay now that is completed we can go ahead and instantiate uh CMS items inside our project now the cool part is you can use the website and also render the CMS items on that or you can use the power of the JavaScript SDK and you can essentially you know access the Wix data directly in your code okay so first thing click right here and then click on ADD CMS items and that's going to add CMS into this project and once this is done just like that you can go ahead and close this out and you can click on dashboard if You' like and I'll show you where you can go to essentially access your CMS items so down here you're going to find a link called CMS okay you can click on this and you can basically start creating your CMS items but I also want to show you another documentation page so you can read more on this or you can follow along with us okay so you can quickly search up gohe headless on Wick Studio documentation and you're going to find a link to this documentation page and you can click on this tutor tutorial called JavaScript SDK tutorials and then click on data quick start this is what we need to essentially set up um to set up Wick Studio inside our application okay so the first thing I'm going to do is go back to our CMS items all right right here and my website is essentially called my site number six so you can change it if you want I'm just going to keep it like this and I'm going to create a collection next click on start from scratch click on next and the name of this collection is web prodigies opal videos okay and you want to copy that or let me just make it short I'm just going to call it opal dvideos okay like this and I'm going to copy this and next I'm going to click on a single item okay how many items do you want to store in your collection well actually we're going to have multiple items and you can't change the number of items okay so let's just click on multiple items and then click on Create and that's going to spin up sort of like a table structure for us okay now let's go ahead and close this and as you can see this is going to be the title and we're also going to need an ID field okay so what I'm going to do is I'm actually going to just delete this CU we don't need a title or I can just rename this like this and rename it to ID okay where's the field name there we go so ID like this and that's pretty much it now there also is an ID field but that's only a number and what we want is essentially to host not the video even then you I mean even though you can you can actually do that in here but we want to just store the ID in here because we're using opal itself right so we're just going to have this one field which is ID and we can create multiple you know collections or whatever you want to call that you can essentially create multiple entries right that's pretty much it so now let's go back to the documentation and I'm going to open up my terminal I'm going to open another tab right here and first thing is I'm going to install these two packages so I'm going to say bun add copy this one Wix SDK and I also need the other one so I'm going to copy this one as well so I'm going to say bun add Wix /data and that's going to install the two packages that we need okay for using npm pretty much the same thing then we are using JavaScript so we don't have to pretty much do anything else um but I mean we're using react so we don't have to install react of course and we also I'm not sure if we're going to need the JS cookie let me just make sure because it looks like if you want to handle session session cookies you're going to need to use it so let me just take a quick look okay let's just go ahead and install it okay um we might need it so bun adjs cookie all right awesome and now you can go ahead and create a collection um and you can select multiple items pretty much much the same exact thing and you can add the field or pretty much whatever you want okay awesome so the next thing I'm going to do is I'm going to go back into my dashboard and I'm also going to keep my opal dashboard ready to go and all we have to do now is populate these with different video IDs okay now you can go uh to a whole different level and you can essentially use an extraction tool or a helper function to basically extract the URL right you can exract the ID from the URL and you can do whatever you want but we are just going to make it easier just for now and we're just going to copy this ID from the URL itself okay so once this is done let's go back into our CMS collection and I'm just going to paste it in here so I'm going to create um it's saying add a field so let's go ahead and add uh actually we don't have to add a field we have to add an item right and I'm going to go ahead and add this right here and click on save all right right awesome there we go we first we just created our first CMS item okay now we can go into our code and pretty much render that route so open up the folder structure and you want to scroll up uh actually I'm going to shrink everything and then I'm going to open up the components sorry app folder dashboard workspace ID and inside this I'm going to create a homepage and let's also create a page. TSX and essentially in here we can render out whatever we need to so let's go ahead and return a component and I'm going to call this component home in the same page and this is not going to need any props but for now I'm just going to keep this in here and the first thing is we're going to need some helper functions or helper actions that are essentially going to help us get the Wix content and all the data that we pretty much need to render inside this page and we're going to use some more cooler tools to uh render more data in here but for now we're going to just use this one right so let's just finish this part which is const videos equal await get Wix content and this is a server action that we need to create and I'm also going to change this to an async component and let's go ahead and open up the folder structure and scroll up into actions and you can create a new file but I'm just going to put it inside the workspace action right here so I'm going to say export const sorry export const get Wix content and this is going to have a tri catch block inside here and the first thing is we're going to need to create a Wix clients okay so let's go ahead and say create client but this create client actually comes from Wix SDK so I'm going to scroll up top and I'm going to import the following so I'm going to say create client and oat strategy and we're going to import those from Wix SDK and down in here we're going to say const my Wix clients equals to create clients we're going to invoke it and we're going to need to pass in the modules and in here we're going to need to pass in something called items and these items come in from the Wix data okay the package we installed so let's scroll up top and we're going to say import items from wix's data and now let's scroll all the way back down and let's pass in items in here okay awesome so now that we have this we also need to pass in the oot strategy so I'm going to say Au in here and this is going to be o o strategy we're going to invoke this and in here we're going to pass in the client ID now this is going to be an ooth key that we're going to get from our dashboard so let's go ahead and grab that key so I'm going to go back into this documentation and in here they show a page called headless settings okay so you can find the ooth app client ID inside the uh projects setting so I'm going to click on headless settings and let it take us to this page okay so we see the my site six I'm going to click on this site and it's going to take me into our dashboard and inside settings I can essentially create these API keys but what we need is not this API key actually we just need the Headless client because it says create a client to connect to external interface via VIA the oo app right and use client IDs and install sdks to authenticate your visitors and whatever so I'm going to go ahead and click on create new client and it looks like it needs an oath name I'm just going to call it opal go ahead and create the new client and hopefully that gives us an ID okay there we go we have an ID in here let's go ahead and copy this ID and I'm not going to show my uh environment file because remember I had a bunch of uh important values in there but you're just going to create a value uh like this I'm going to say process. environment env. Wix o oore key that's it okay and set this as string and go ahead and add this value uh add this value right here to this key inside your do environment file and we'll go from there okay there we go and I'm also going to go ahead and shut down the server and say bun runev all over again and you also want to refresh guys that's something that I want to let you know as well when you're restarting refresh the browser and then do this okay cuz if it does have any cache or any data it's going to use the same data we don't want that so go ahead and reload and then reload once more okay so now that we have that we can go ahead and proceed right here so let me shrink this so we can see and down here I'm going to say const videos equal to awaits my Wix clients which is the client we just created up here and we're going to say we're going to in actually we don't need to invoke this we have to say items dot query data items and we need to pass in the data collection ID okay so let's go ahead and find that as well so I think this is essentially the name right so I'm going to add the data collection ID in here and set it to opal videos and if you don't know where I'm getting that from it's essentially the CMS title itself okay I think I think this should be it we'll see how it goes but I think that should be fine and I'm also going to change this to an async component because we're using a weit in here and it looks like okay we need to First invoke this right so we're using query data items on this collection and we also need to say doind and invoke this as well okay now once this is done we're going to say const video IDs equal to videos sorry this is video IDs equal to videos do items do items. map and for each of them we're essenti essentially going to return data or sorry it's v. dat so v. data. tile okay and I don't think we have this in here so let me go ahead and change this to the following so what I'm going to do here is I'm going to say do ID and now I'm also going to add this condition right here so it doesn't scream at me and once this is done we can go ahead and find this video inside our database so I'm going to say const video is equal to await client. video. find many and we're going to find where the ID is like the following so it's in the videos ID okay and once we get this we're going to select the following information we're going to select the ID we're going to set this to true we're going to select created at we're going to set this to true as well we're going to get the title and we're going to set this to true the source set this to True processing why is it not doing that for me okay we need processing the workspace ID set these to true as well and then we're going to also need the user data so I'm going to say user but from that we're going to select first name last name and image and then we also need the folder so down here we're going to say folder select ID and the name okay and after this down here if everything was successful we're going to say a video and the videos. length is greater than zero then we're going to return 200 if not we'll return 400 meaning something went wrong okay uh 44 and then down here we can also return 400 so this is essentially saying that there's no data we could not find this video that's why it's 404 okay awesome now let's go back and let's import the get Wix content and let's try to render out this component so I'm going to click on the homepage and okay it's showing me a beautiful 404 let me see what's going on so slome does not exist why is that the case let me take a quick look guys just give me a second okay so it looks like I named this file pages. TS xx and you guys know I am very fond of making spelling errors so let's go ahead and Shrink this once more and let's refresh the page and there we go we can see some data in here awesome all right guys so it looks like I made a mismatch in the title name right and not sure why that error happened I think it's because the ID of this field is stored as title right because right now essentially what we're doing is we are saying ID and this do ID does not exist on this data in Instead This is renamed to title right here okay so we need to essentially just change this to title okay and now that's going to give us some data let's go ahead and see there we go we're getting data okay so that was the error there and I figured that out because I was printing the error out and now let's go back into this page and just like that now we have the exact video that we need to render so I'm going to go ahead and give this a class name I'm going to say grid grid of grid columns 1 LG Grid callums 2 and gap of five and inside this I'm going to say the following so I'm going to say videos also I change this to videos because it's multiple right and I'm going to say videos. status if this is equal to 200 then we're going to do something in here or we'll do something else so if this is true we're going to map over the videos. data and we're going to say map okay map and for each of this we're going to return the following so I'm going to say video in here and I'm going to return our video card component so video card from Global components okay and now um what seems to be the issue here videos. dat videos is possibly undefined okay so in here just put a question mark like this and in inside this we now have to pass in the props so let me quickly just bring this onto a next onto the next line and I'm going to pass in first the key which is equal to video. ID and then we also need everything else that's inside this so I'm going to say dot dot dot video like this and then we also need the workspace ID which is going to be the video. workspace ID okay so what seems to be the problem in here string and null is not assignable to type string type null is not assignable to type string H okay so let's just do this and that should solve this problem okay awesome so what seems to be the problem in here it looks like you're importing a component that needs use effect it only works in a client component but none of its parents are marked as a client component interesting but video card hm Let me refresh this let me just see where this is coming from all right guys so the problem is stemming from our video card component so this component can um is essentially rendering out an element called card menu but this card menu is passing down some elements which are client based components right and we can't we can't pass a callback function down so let me show you what I mean by that so if I change this to a used client component component you're going to see another error that says button which is probably in one of these elements somewhere here it essentially is saying you can't pass down something called you know on copy clipboard uh because you need interactivity right so what we need to do is go back to our video card component and we're going to need to change this to a use client component and that's going to uh pretty much solve our problem now if you think this is going to convert this to client side rendering and it's going to take time to load or something like that it's not and the reason is because we are technically passing in data on the first paint the first load right this is essentially called pre-rendering on the server client components are also pre-rendered on the server with the data that's being passed in here okay and then when it comes to the client essentially it has holds which it will fill with all the data that it has that's pretty much okay so as you can see we are now rendering all of these components on the page so I'd like for you to go ahead and take a moment to just use your application and create four videos that teach your users how to use opal okay pause this video and take you don't need to take too much time just take like 2 minutes create a couple videos right or maybe a couple seconds just as a practice or if you want and you're genuinely serious about launching your SAS you can just create a couple videos videos here and just teach users how to use opal and then we can move on to the next stage as we all know the driving source for any SAS is revenue and as entrepreneurs we need to do everything in our path to increase conversions on our platform and today we're going to be using a blazing fast Cloud hosting platform that's going to help us accomplish this cloudways is a managed Cloud hosting platform for WordPress websites and applications and they make managing these Services a total breeze so how it works is cloudways is kind of like the person in between the servers on Google Amazon Digital ocean linode and vulture and they simplify the entire process from start to finish while also providing you with a ton of amazing features they set up everything for you within your dashboard so that you can control your project with just one single click all you have to do is click on ADD server in the dashboard select the type of application let's say WordPress set the project name and the details select the type of server you would like and if needed set the server size and you're done one of the standout features of cloudways is the cloudflare Enterprise CDN this Advanced content delivery network is specifically designed for Enterprise users delivering exceptional performance improvements compared to tradition additional CDN by leveraging a reserved Network the cloudflare Enterprise CDN ensures faster Global content delivery reduced latency quick loading times and substantial bandwidth cost savings they also offer 247 live chat assistance by a growing team of highly trained experts you can also add premium support as an add-on and with this you and your team can directly call and speak to a senior support engineer at any time you can troubleshoot application Level issues including Plug-In or theme troubleshooting investigating any server errors or optimizing performance right from the dashboard you also get a free SSL installation with just a single click this SSL service ensures that your website is equipped with a trusted certificate fulfilling all https requirements without any additional costs in collaboration with their technology partner malare cloudways provides bot protection for your WordPress website this feature safeguards your site from malicious traffic in Bots Brute Force login attacks dos attacks and many more and here's a really cool feature as your WordPress website or application grows you need to expand on resources and cloudways enables seamless vertical scaling of your servers with just a single click cloudways also allows you to create staging environments or backups with their application and server cloning capabilities with just one click you can clone entire servers or make copies of individual sites completely with their files and the databases and also get a new staging URL this is great because you can reuse Logic for different WordPress sites and you don't have to write hundreds of lines of code so if you already have a WordPress site hosted on a different provider cloudways offers a free WordPress migrator plug-in and even better cloudways is completely free to get started today and when you're ready to get access to such amazing features you can use this code at checkout to get $20 worth of credits of free hosting awesome so go ahead and scroll to the description you're going to find my link and if you use my link you can essentially grab the $20 worth of free hosting credits okay so thank you so much cloudways for making this possible for the prodigies community and let's get started so as you all know you can use cloudways to host your WordPress website but I also want to show you something where you can essentially use cloudways and WordPress as the um as a headless Ems for our application so if you want to also you know bring in data from your cloudways uh dashboard you can do that so if you have an application in cloudways if you have a WordPress site you can use a plugin and also fetch that data and load it into opal as well so I'm going to show you how you can do that and the first thing we want to do is go ahead and log in so go ahead create a free account it's completely free to get started and you don't even have to put your credit card so I've already created an account so I'm going to go into that account make sure you'll log in and then we'll proceed from there so go ahead open up this nav bar and you're going to scroll down in here and click on my projects okay now go ahead and create a project inside this and go ahead and click on create project and once that's done it should take you into a page that looks like this so go ahead and click on the project itself and you see I already have the application but for you you're not going to see this of course so what you would want to do is create an application inside this so first go to my servers uh right here click on my servers and then you want to click on ADD server and from the drop-down we're going to select WordPress and you can give it a name I'm going to call it opal production like this and I'm just going to call this opal server and you can select the project directly from here okay so you don't even have to move it into that uh specific folder and that's it now you get to pick your server so I'm just going to leave it at digital ocean this is the server size so you can essentially scale depending on you know how much traffic you anticipate and then you can go ahead and click on launch now now this is doing a whole bunch of stuff on digital ocean so so we need to give it at least 7 minutes to pretty much set up everything so let's just give it the time it needs to set up the server and then we'll get started okay now my server is completed I'm going to go ahead and click on the server itself and it's going to take me into the uh the server dashboard and let's also verify that our application is created in here as well okay as you can see if you click on this icon it shows the application that is installed on the server next go ahead and open up a new tab and you want to type in headless CMS cloudways okay and go ahead and hit enter and it's going to take you to let me quickly find that okay right here so it says headless WordPress using react for a CMS web app so I'm going to click on that and it's going to take me to this blog post next you're going to scroll down here to step number two which is down here and you're going to click on this ZIP file okay we're going to need this plugin so go ahead and download this plugin okay so it took me to the GitHub page I thought it was going to instantly download something but I totally forgot it's going to take you into a repository you want to click on this green button and click on download zip and then just go ahead and click allow if you are on Mac and that should install our plug-in okay next you want to go back into your dashboard and you want to click on my applications and go ahead and click on the opal production app that we just created it's going to take you into another um dashboard essentially and now you want to scroll down here and you see we have the admin panel right this is going to have a URL and we need to essentially open this dashboard again so go ahead click on this dashboard and I'm not going to show you the other page but you just have to put a username and password which is your credentials and you should be good to go and if you don't know what's the username and password it is right here get your username and your password all right now I'm going to go ahead and log in and and not now and that's going to take you into our WordPress dashboard now go ahead and scroll down here where you see plugins you want to click on this and click on add new plugin and then we need to essentially upload the plugin that we just installed so go ahead and drag and drop this in here or you can just import this uh plugin and then we'll move on from there and just as a quick pointer guys you want to make sure the file that you're uploading is not a folder but it is a DOT zip file okay or it's not going to install it's going to say the link is invalid or something like that okay so go ahead and do that and you should see this page next I'm going to click on activate plugin like this and that should take you into this page all right now go ahead and click on plugins again and you want to click on add new plugin and you're going to look up custom post types okay custom posts type like this and you're going to find another plug-in in here go ahead and install this plugin as well and make sure that it's active awesome and I'm just going to go ahead and activate this plugin as well and then you want to click on add/edit post types and I'm going to click on the first field and I'm just going to call it test posts for now and same thing in here as well so test posts and for singular we're just going to call it test post next you want to scroll all the way down to these options and if you also want the author you can select that as well you can pretty much grab whatever data you want from these posts okay and let's go ahead and say add post type and now you're going to be able to find this this new test post type right here so go ahead and click on this right it's going to take you into a page like this and then you can click on the add new post and that's going to take you into the WordPress editor and for the content of this post I'm going to use chat gbt and with the help of the option and spacebar command on Mac you can actually directly open chat gbt but I think you need to install and probably upgrade your your Mac OS as well okay but if you don't have a Mac that's totally fine I'm just saying it's a cool thing that I found out right and essentially I have a um a a prompt that I'm just going to paste in here and it's just going to help us get all the data in markup so I'm going to say give me this in markup okay and I'm just going to hit enter and that's going to generate something for me all right I'm going to copy everything and I'm going to click right here and just paste it for now okay it doesn't really matter we just want some data to show up in the front end and I'm sure you can you can do a great job by making it look nice and all that kind of stuff all right so for now just paste all the data you get in here and let's move on to our application all right and one more thing really quick guys essentially once you're done with this um you want to click on publish post okay and let me make sure that it's showing the data correctly all right it looks like this is text a paragraph This is the title okay looks good so go ahead and click on publish it's going to give you something in here just go ahead and publish once more and now you can also click on this link and you can view your post okay awesome so now I'm going to click in here and it's going to take me back to our test posts and as you can see this one is now published and good to go now let's go back to our application and I think I can still use Thunder client to make this work let me see and let me just give it a shot and see what happens okay so essentially Thunder Kleine is just like Postman but this is something that I've just found recently and I think I already introduced it to you guys right but I'm not sure if I can make an API request to an external site I'm not sure if it only works inside the codebase let's just give it a shot okay so go ahead and create a new request like this and now now we're going to need to get this um the URL that we have to make the get request to or you can just get it from here actually so if you go into your WordPress dashboard you can click on this link just right click it and say copy link I think this should work as well so now I'm going to go in here and I'm going to paste this endpoint and I need to add some values to this as well so in here we're going to add wp-json WP and then I'm going to put put another slash and I need to add the title which is test posts right so test posts like this all right guys so the problem here was this one uh right here after WP we want to say V2 and say slash and then put test post and now if you go ahead and call the end points awesome we are getting a 200 response with all of the posts essentially and we can render them inside our homepage okay great job now here's what you're going to do you're going to go into your environment file and you're going to create a variable called cloudways poost and you're going to store that value which is that URL that we just made a get endpoint a get request to right we're going to store that URL inside this key that's it okay and now I'm going to go back to the homepage and let's also open up uh open up local host and for now I'm just going to hide all of our video cards so that we can see this clearly and down here we're going to need to now fetch all this data so I'm going to create another server action this one is called const posts and we're going to say await how to post and I'm going to open up my folder structure I'm going to go into workspaces and I'm going to scroll to the bottom and I'm going to do the following so export const how to post equal async and it's an async arrow function we're going to need axos to make this work so we're going to say await axios doget process. environment cloudways post as string okay the essentially the new environment variable that we just created and if everything looks good we're going to return the title and the content to the front end if not we'll just return a 400 um error okay so let's go back and quickly import the server action and we're going to render out a component called how to post so go ahead and open up your folder structure you want to go into Global components and you want to create a new folder in here called how- to post and inside that an index. TSX sorry this should be a file looks like I created a folder so index. TSX and I'm going to return a component like this and just render this out next I'm going to go back and quickly import the how to post component and now I can go back into this and pretty much render all of my data okay awesome you can see it right there so first thing is this is going to need the title and and the HTML body right so I'm going to so I'm going to get two props here called title and HTML and I'm going to go ahead and also destructure these from our props and now I'm going to need to render these elements out so I'm going to say div class name Flex Flex D column Gap Dy of 10 LG column Das span D2 Mt of 10 okay and inside this we're going to return return H2 and that's going to have a class name of text- 5xl font D bold and we're going to need to render the title in here okay finally we're going to have a div and this div is going to have the following class name so I'm just going to go ahead and copy this so you can pause the screen essentially type okay so if it's greater than H2 then we're going to say text 3 XL and if not uh if it's if it's essentially greater than H2 here we're going to say margin top of five we're going to also give it margin bottom of three and then uh for paragraph we're essentially giving it text space so we're essentially setting certain type of elements itself right it's called CSS normalize and that's pretty much where you set a specific tag or a element like div or paragraph tag and you reset the styling itself okay so if um this greater than symbol is essentially in CSS like how we do h and then we do something right that's pretty much it okay so we're just resetting the Styles and now in here we're going to say parse I'm going to invoke this and this parse is going to come from a package called HTML react parser okay it's a very small package so let's go ahead and install that so I'm going to quit the terminal okay and I'm going to say bun add HTML react parser and that's going to give us this package and now I can go ahead and in uh import our parser from here and all I have to do is parse our HTML data so I'm going to say parse HTML data like this and let's also say Bun Run Dev and let's refresh the browser and I'm just going to set a default value in here inside the parameter okay um that way if we don't have anything we don't have an error down here okay or you can also render this this one's fine as well I don't think this is a good practice anyway so yeah you can do something like this and now let's go back and we need to pass in are props I'm going to say title is post title and the content is the post content okay and that's pretty much it so if you have a WordPress websites and you want to make use and take advantage of the $20 worth of free hosting credits today you can use the link down below and cloudways also has a simple uh plugin that can essentially help you move your WordPress site and transfer directly into cloudways okay and it's very simple they have everything inside the dashboard so you don't have to you know go crazy crazy trying to move your site okay so yeah that's pretty much that just wanted to show you the power of cloudways because you can also bring your WordPress site and I use that also as a CMS for your application awesome let's proceed now all right and now for the next AI feature this is our AI agent which we're going to call AIA okay sounds like a cool name so I'm just going to call it AIA and this AIA feature is essentially a chatot for viewers who are watching an opal video they can ask questions and the AI agent will respond accordingly with context of the video that means it knows what's happening in the video okay super super cool feature imagine this right imagine if I took this entire tutorial this full course and I plugged it into this AI agent you would just have to ask it questions at any time you want and it would answer every single thing right it can probably also tell you where it found it from whatever you instruct to so this is a powerful feature especially for courses so I thought this would be a great feature to have inside our application and I want to show you how you can do it I mean the most important part is we're not going to spend a lot of time that means we can do this in just a couple minutes how cool is that if you guys remember we built something called Corina AI in the past and Corina AI took us about 3 months to build cuz we built every single thing from scratch and 3 months in a SAS is horrible you're not supposed to spend more than 2 weeks building an MVP okay a feature should not take a lot of time if it's your MVP okay so we have found a creative solution on how we can accomplish far more than Kina AI that does not take more than 15 to 20 minutes how awesome is that right your users get to experience what it feels like to use AI Automation and stuff like that and essentially you get to know if they find it valuable so you can focus more on you know building the full feature itself Standalone inside your app in the future if you need to okay so essentially how we can make this work is we're going to need to grab context from a video so if we have a video right here we need to figure out a way to connect this video into this AI agent okay now where do we plug in all of this video related data or where can it go it's going to be really hard to take each of these and plug it into the AI and then get data out of this instead we have access access to our transcript all we have to do is pass this transcript into a smart AI bot that can pretty much do every single thing for us and to accomplish this we're going to need help from a third party tool so that way we don't sit and waste 3 to four months building a AI chatbot right and we'd also probably want more cooler features right we don't just want only an AI that can respond you might want to build AI automations or you might want to build spe specific AI generated um maybe voice messages there's so many benefits of using a thirdparty tool and the tool that we'll be using today is called voice flow and voice flow is also the sponsor of this video so voice flow is essentially going to give us access to our AIA and voice flow allows you to build workflows and in this workflow you can use a automation like Builder where you can build different stages different steps as to what you want the AI agent to perform and it's essentially just going to follow that right it's it's pretty straightforward but it's super powerful because you can plug it into anything you want you can build AI agents to respond to your customer support or let's say if you if you're building an application for an insurance company you might need a couple of steps to file an insurance claim right you can use an AI chapot to handle all of this um step by step okay so voice flow is super cool so we will be using this tool to set up inside our application and at the moment they have a generous free tier which is amazing because we get access to 50 knowledge based requests per agent and 500 table rows that means we can upload a lot of videos Okay so let's go ahead and build a voice flow into our application all right so I just created an account using the link in the description and that is my link again so if you go ahead and click on that um it's going to going to take you directly into this page okay so it's going to tell me to essentially create a workspace and that's exactly what I'm going to do I'm going to create a new workspace in here and just call it web prodigies like this so you are getting some templates that you can reuse as you can see we have a retail purchase web chat super cool and the support chat bot this is already done for you right so you could literally leverage this and use it inside your application so first thing I'm going to do is I'm going to click on new agent and I'm just going to call this opal like this and go ahead and get started and it's saying you can import knowledge base about your company by just providing the website URL but we're going to go ahead and skip over this because we are using the knowledge base in a slightly different way okay so go ahead and skip this and that's pretty much it so now it's going to take you into this specific um into this specific project next go ahead and click on the workflows and you see they already have some templates in here but we're going to create a new workflow in here and guys you can see this you can create um a support ticket in case a customer reaches out to you or let's say if they had a new feature request this is really powerful right so you can do a bunch of stuff not just what we're trying to accomplish I just want you to understand that that there's so much more in voice flow so just take some time and research the tool just see how you can leverage it in your SAS because you're going to need a way to handle scenarios like this and you can't always be there to sit in type and text your customers right you're going to need to automate all of these tasks and the best way to do it is with AI go ahead and click on new workflow up top here and I'm going to say opal again in here and just go ahead and create this workflow and now it's going to send you into a page that looks like this so how this works is when the user asks a question the AI agent will essentially trigger this trigger function right here and this action will then fire all the other blocks that are attached in the sequence that's pretty much it so it's just like an automation Builder okay and now that we have access to the user's question we can process this data in the way we like so for example let's say we were trying to build a chatot that can handle everything a user would ever need to communicate with us for right so for example refund requests and we can probably categorize that into purchases and support right then we can have feedback on the software so feature requests and maybe support tickets for technical bugs right so when the user essentially sends this question through the AI agent we can then create a block in here for example something like AI uh response or logical you know responses as well and based on the logic which is if it is a support ticket or if it is you know customer care whatever that is we can fire up a a whole different sequence so you can see how powerful this can get right but for this specific scenario all we're doing is we need to First optimize the user's question right because they can pretty much ask anything they want right so we're going to optimize that and then we're going to search the knowledge base and if you don't know what a knowledge base is it is essentially just a table right think about it like a table and it stores all the data um that you feed it right and the cool part is you can store data based on a URL as well okay so once that's done it's essentially going to grab all of that data that it found and we can then create another block that's going to take the data and the question right and it's going to send it into AI using prompt engineering we're going to create a really nice prompt we're going to pass it into that Ai and the AI is essentially going to read all this data and generate a response that we can take and send over to our customer okay that's pretty much it and the other thing we need to keep in mind is we also want to remember the sequences that means we also want to remember the conversations that the AI uh Ai and the customer had in you know previous um you know engagements right so we also want to remember every single thing now if you were to build all of this this would really take a lot of time so this makes it really simple for us to create a chatbot like experience um in our application okay so go ahead and drag and drop or you can also click on these blocks right here and the first thing that we're going to need is something called the set AI okay so I'm going to go ahead and drag and drop this right here and the first thing I'm going to do is I'm just going to give this a label so I'm just going to call this optimize and we can also give the same label in here so I'm going to say optimize question for the knowledge base right awesome and then make sure you click on data source AI model and for the prompt I already have a prompt in here this came from their templates so I'm going to go ahead and copy this and paste it in here and guys I'll put this prompt inside the Discord channel so if you join the Discord you'll just pretty much have it in there right when you join okay it'll be probably inside the support chats or in the general chat or just ask the prodigies community and they'll help you out okay so I'm going to go ahead and pass in the generated question um I'm sorry the prompt right in here and then we can apply this prompt to a specific variable so I'm going to call this the optimized question so essentially it's going to store that response inside this variable okay really really cool stuff and you can also create multiple prompts in here so you see we just created one right here right I'm going to create another one like this and it's going to show up at the bottom and now I can pass a different prompt into this and I can assign it a different variable so I'm going to call um I'm going to click on this and I'm going to paste a prompt that I got from their template as well and it's essentially I'll also read what it does but it's just prompts that essentially help the the chat Bots okay and we're going to apply this to a specific variable called language. language Json okay so please follow along with me that way you understand how to build these workflows and once this is done you can click on preview and you can give it you know some values in here if you'd like and I mean I'm just going to skip over this for now and just click outside here and that should still save that for us okay awesome now go ahead and also connect these blocks by dragging and connecting these cables together and the next thing we're going to need to do is search the knowledge base so let's go ahead drag and drop and I'm going to search for knowledge base which is under Dev so KB search okay awesome and now go ahead and rename this I'm going to say search knowledge base and I'm going to create this question in here okay now this question is essentially the optimized question that we got from the first step so I'm going to say optimized question like this so you see how we're also passing variables between different blocks right super cool stuff and now we want to save the chunks itself which we're getting from the knowledge base inside a variable so I'm going to use the chunks variable and store that in here as well and now what if we could not find any path or we could not find find any data right you can turn this on and now you can provide an pretty much like an an an else statement right so it's like a no block so in here I'm just going to say respond if no info found okay and now you can click on this block and you can essentially tell it what to do but I'm just I'm not going to do it right now because I I just wanted to show you that you can also do that in there okay so let's go ahead and now click on this and I'm just going to turn this soft for now and the next step is we're going to need to craft a response and this action or this block is called set AI so click on this AI response right here and you want to drag and drop the set AI block and now I'm going to change this to say craft response okay and you can click on this and now I'm going to give it a label so just say craft response as well what am I typing craft response okay and make sure you click on the AI model and same thing guys now I'm going to have a different prompt in here and I'm going to explain this prompt um in more detail and I'll also go over the other one as well but this prompt is essentially just you know giving some guidelines and how it should help the customer so you are an AI customer support bot helping a customer with questions so when communicating with guests follow these guidelines okay but these are all just guidelines like ensure the response strictly contains information from the trunks only and is not your own version right things like that right and the most important part is the input data in here the input data that were're passing in has the customers questions which means all the last occurrences or the utterances right and we also have the details from the chunks and the conversation history so this is their last question and here we have the history of the customer and the chatbot so it's going to essentially know what happened before and for I think it's 10 uh conversations that they had in the past and it'll essentially just use that as context okay and you can also pass in languages so um I'll go ahead and show you the other one as well right the other prompt but before that let's go ahead and apply this to a variable so I'm going to call this KB response okay and that should do it you can go ahead and click outside or you can click preview and you can assign variables or values to that but for now I'm just going to go ahead and connect this and our final step right now is we need to give the output right so go ahead and drag and drop click on talk and click on the message box and in here all we need to do is essentially pass in this KB response right that's pretty much it so I'm going to click on this text field and I'm going to say KB response so we just passing in that variable and that's pretty much it okay awesome now just to show you what this um prompt looks like it's pretty much the same thing just saying you know gener generate a single question from their you know from their big question if they ever ever asked anything and we're just telling it to format it right that's pretty much it so Focus solely on the aspect mentioned by the user do not include additional topics or comparisons unless specifically requested so this is how you should you know write prompts right should be in great detail and should give the AI enough information and in here same thing we're just showing the input data and the input data is the conversation history and the most recent question that the user asked okay and now once you have done connecting everything and also completing all of these steps you can go ahead and click on the Run button and you can test out this AI okay so let's go ahead and give it a shot so I'm going to ask it what is web prodigies let's just give that a second and let's see what it let's just give that a second and let's see what it has to say okay so it ran through all of our responses and as you can see it has a detailed message printed out right uh this is where you can get premium access to courses mentorship and stuff like that and if you go back all the way to this dashboard and click on knowledge base and in here you can add a data source so you can add a URL a Sit map or just a PDF file I just added web prodigy.com and it automatically knows every single thing about the website okay so if you ever have have questions on documentation guys you can do this right just copy nextjs documentation paste it in here and you can ask questions yourself okay how awesome is that I'm going to do that thing that's a cool idea all right cool awesome so now let's go ahead and use this uh workflow that we just created inside our project now go ahead and open up your folder structure you want to scroll down to the bottom inside your lips folder and by the way this is our web application version Okay click on voice flow Js and in here we're going to have a um a function a helper function that's going to help us inject a script okay now just for Simplicity sake I'm going to show you how to render the chapot on the website okay I want you to be a little more creative and take the idea and the knowledge you're getting from this course and figure out a way how to put it into either the dashboard or inside the activity panel I think that would be really cool right you could have your own uh chat Bots pretty much embedded inside that right so I want you to think above and beyond just this course but for Simplicity sake we're going to render this out on the website so let's go ahead and create that helper function that's going to help us load the script so I'm going to say export const load voice flow agent and this is going to be equal to an arrow function but we're essentially going to create an iffy in here okay if you don't know what this is you you probably have to learn JavaScript okay but anyway I'm going to create a function like this and this is going to help us create an execution context and immediately U pretty much Implement and get this script and inject it okay so I'm going to put this into a bracket and I'm going to invoke the function itself okay this is what an if means it's just an immediately invoked JavaScript function okay think about it that way and in here we're going to get access to two parameters which is the document and some value okay and in here first we're going to say VAR V equal D.C create element and inside this we have to pass in T and after that we're going to say why is this not going up here okay so let's create another variable too called s and this one is going to be d. get Elements by tag name and we're going to pass in t again and we're going to get the first value from here okay and now once this is done we're going to say V Dot onload and let's change this to onload this is lowercase all right guys it's equal to another function and this function is going to do the following so inside this we're essentially going to load our component so we're going to say window. voic flow. chat. load you want to invoke that and inside this we're going to pass in verify and this verify is just a property it's not from crypto I don't know why it's from crypto so we're going to say verify and inside this we have to pass in a project ID so I'm going to say project ID like this and this is equal to an environment variable that we're yet to of course create but this environment variable is called next public voice flow key so I'm going to say process.env dopu voiceflow key okay and I'll show you where to get that just give me a second let's just complete this first and then the URL that we're going to send this to is essentially the following which is H cdps /gen runtime. flow.com and after this we're going to pass in uh another property called version ID so I'm going to say version ID and set it to production and guys please do not make any errors because this is a Javascript file you're not getting typescript intelligence okay and after this we need another uh another variable actually we're adding The Source property to the V object to this element so you're going to say v. Source equal to https CDN .vo flow.com widget bundle. MJS okay and next the type of this uh the script essentially or the type of this element is Javascript okay so text/javascript and then we're going to say s. parent node so this element. parent node. insert before V and we're going to pass in this value in here as well okay now inside this we have to when we're invoking it we have to pass in the document so essentially we're giving access to uh we're passing the values that directly get passed in here so this like I said is document and this is an element we're trying to find so we're going to need to create the script and the script I think actually the script is coming from them I don't think it's ours but the element is essentially going to have a tag name called Script okay so we're going to say document and we're going to pass in script like this all right so this is how we're invoking it and passing this data inside this next you want to scroll up top right in here and you're going to find something called workspace ID let's go ahead and Shrink this actually we don't need that one we need the website and inside this you're going to find the page. TSX so inside here which is our home we only have the landing page and we have this um main page right here right we really did not create anything yet um so let's go ahead and say voice flow oh why can't I type okay voice flow agent and this is a new component that we need to create okay so I'm going to copy this component and I'm going to open up my folder structure so I'm going to say voice flow inside the components so inside Global components you can say voice flow and inside that an index. TSX and let's go ahead and return a component and I'm just going to call it voice flow agent okay now inside this we're going to need the use effect that's essentially going to help us Mount this component so I'm just going to return return a react fragment for I mean for now I mean you can return nothing if you want it doesn't matter but I'm just going to return a fragment and I'm going to create a use effect so use effect invoke this and inside this use effect we're going to pass in our load function now this needs to be use client because we're using use effect so let's go ahead and do that as well and inside this we're going to invoke our load voice flow okay our voice flow agent for some reason is not being exported or did we exported let me take a quick look so inside our Libs file right here we are exporting it okay not sure why it's not letting us do that but I'm just going to go ahead and do it manually so I'm going to say import voiceflow agent from lib at lib voiceflow okay just like this and now we can invoke our voice flow agent which is load voice flow agent and that should do the job okay so now we're mounting that uh file we're injecting it and that's pretty much it okay there's still more to do though um just keep follow through just just keep following uh through with us uh because we have to also create the um the routes that can listen to essentially when we're making the changes from our Express server right because we want to import and send all the data directly to the trans uh with the transcript directly to an endpoint so that's another thing we need to create as well and another thing we need to do is we have to create that script tag right because if we don't it's not going to be able to find that element when it's trying to load so so first thing is we're going to go into the app folder okay right here and we're going to create a route but this is using the underscore and we're going to call it scripts okay and inside that we'll create a voice flow. JS file and this is going to export a variable called voice flow agent I keep typing agency I've been doing too much agency stuff lately I think anyway so voice flow agent and inside this we're going to return a script tag okay so return script but this script comes from next script okay and inside this first is we can pass the type so I'm going to say type text JavaScript like this and inside this we're going to go ahead and pass in a function okay and this is pretty much the exact function that we had in our Libs folder but in here we're essentially going to do the following so just follow through with me okay we're going to need to create another iffy in here okay so I'm going to say function and I'm going to wrap this inside this and then invoke it okay and this is going to have a function body so let's grab that as well so again we're going to need to essentially insert this element right here okay so I'm going to say d and T so I can pass in these values you can pretty much copy the last um you know the the function we just created and paste it in here guys that works as well um let me go ahead and do that okay you can also pause the screen and type if you want to learn but I'm going to go ahead and copy and paste it in here all right guys now we need to populate a few values right inside our environment file the first one is the voice flow API key and this API key can be found from right here okay so click on this copy the key and paste it in here as well and then you're going to have some more options which is the voice flow knowledgebase API and that's a endpoint so you want to just go ahead and type this so pause the video and please type this out and then we're going to need the next public voice flow key okay this is essentially our project ID or a project key but the way to get it is actually through this and I totally forgot you can grab it right from here okay so I'm going to grab this and I'm going to paste that in here as well and now we can reuse this variable anywhere we want so let's go back to our code and this snippet guys the snippet that we created in the script is essentially the same thing that you see right here okay so I'm going to copy this project ID you can use the environment variable but I'm not sure if this component is going to get access to that but um I mean it should I don't know why but just for safety I don't want anything to break right now so I'm just going to go ahead and paste this ID okay so you can go ahead and do the same thing which is exactly what they're telling us to do all right awesome now I want to go into my page. TSX which is the website and I'm going to go ahead and import ort this this component now an important step to keep in mind is you have to be in production for this to work okay uh as you can see they literally say it I think they tell it in the documentation as well which is you would have to be in production and only then can you access the chatot right there you go you need to launch the production okay so if you don't you're not going to be able to use this and it makes sense everything just has to be more secure all right now I want to show you how this can work and first of all we don't really need this voice flow file I just realized that um there's two ways to do it right you can render out a script tag like this and you can do the same process that we have in here and you can render out this uh component on the you know the homepage right that's one way of doing it and the other way of doing it is which is in my opinion much more simple which is inside the page or just rendering The Voice flow agent using the use effects right so there's two different approaches the other one is if you're using this method right just render out this component that's pretty much it so both technically do the same thing because here we're creating a script tag and we're essentially you know creating an um an immediately invoked function and then we're passing in variables in here right so it's still going to do the exact same thing so because we don't need this in here sorry sorry about the confusion I'm just going to go ahead and delete this folder okay it's not important we just need this main file which is the voice flow component itself and that's going to essentially help us render now go back to your page. TSX and just make sure you're importing the right components okay it's from the global component which has the use effect all right awesome all right guys so turns out that it also renders in a local environment which is really good so if for some reason you don't see this um this chatot that means you know you need to be in production okay but just keep in mind that it's not going to it probably is not going to access the knowledge base because it is is in developments okay I think the chatbot will render but it's still not going to get access to the knowledge base okay so just keep that in mind now after this we also need to pass in the headers so I'm going to say headers like this and let me go ahead and complete this okay headers and we have to pass in accept and the accept here is application SL Json the content type is application Json and the authorization is the API key that we just pasted inside our environment variables okay next we're going to create the data so we're going to say data is going to be as follows and by the way if you're wondering what we're doing right here we're essentially creating the options and uh the options that we can pass into the axios request okay that's why we have to do all the setup so inside this data we're going to need to create another data object and this data object is going to get access to the schema which is the title and the transcrip script and then we're going to need the name so let's go ahead and pass in the name as well so name is content. tile and then we're going to need the items so I'm going to say items are an array with the title content. tile transcript body. transcript okay and those come up from here essentially all right now once this is done we can go ahead and create our axos response so let me figure out which is the last line okay right here we're going to say const update knowledge base equal to axos await axios do request and we're going to pass in those options okay now if we got a 200 response back from this only then are we going to return a 200 request okay if not we'll respond back with a 400 that's pretty much it okay awesome all right guys with a heavy heart I think we're coming to the end of this amazing course and I hope you had fun but there's one more thing that we need to complete complete before we part ways it is the work in progress flag that I have right here which is for the AI hook now this is very very simple all you're doing essentially in here is we are looking to see if the user is on a free plan right so in this section right here and if they are on a free plan we're going to give them an opportunity to try the AI feature okay so they can try these AI features even on a free pre plan and that's only going to happen once so if you look at our Prisma schema let's go into Prisma click on schema you're going to find something called trial this trial is not for the user's subscription this trial here is to see if the user has tried the AI feature or not okay and this can help you even in email marketing you can pretty much do whatever you want um you can upsell whatever right you guys know what to do you guys are marketers anyway so all you need to do is you would have to check if the user is first on a free plan like this are they on a free plan if they are then have they already tried the AI feature if no then we're going to give them the opportunity to try so we'll have a try button that will allow them to essentially do the exact same thing that we're pretty much doing inside our Express server okay now I want to leave this up as a challenge for you okay because I have taught you so much I've given you all the knowledge that I have in building SAS applications you need to now take action and build this out for yourself that's the only way for you to learn now I'm also going to do you know most of the work and probably just I'm probably going to give out the solution inside the Discord anyway so if you have any problems and you don't know how to do this for some reason you're confused you can hop in the Discord but I want you to try Okay the answer will be in there but I want you you to try okay now I'll also tell you what you need to do in here the first thing is you need to do use mutation I'm not going to give you too much you know too much of a hint right just just enough so you can at least try for yourself so you're going to need use mutation and this is essentially going to give you access to mutate right and through that mutate you can pass in the um the new data and also you'll need a server action okay so I'm going to say server action and This Server action is to generate titles and description that's it very simple okay and after this down here you want to wire up the if conditions depending on what you want to show in here okay and if you want you could also limit the AI feature to be performed only when the user clicks generate in here rather than automatically updating all the AI features in um in our Express server that's another thing you can do if you want okay all right guys now for deployment unfortunately we are out of time okay we cannot do it in this video because this tutorial this free course is already more than 13 hours long and YouTube is not going to allow me to upload such a big video okay so fingers crossed hopefully I can get this out in one part but what I will do is inside the Discord I'm going to record the deployment section or our team members will record the deployment section and we'll post it in there okay you guys can just go ahead and grab it it's completely free if you join the Discord you can also get support from our AI chatbot so if you ever get stuck you can get 24/7 support and the the community is amazing it's all SAS developers and business owners you're going to get a ton of support and that's pretty much it and once you're done with that you are done with building opal I hope you had fun building this entire project this was one of the most challenging projects because we built three different type of applications I mean guys look at the date I have been I have I've literally been recording for the past 2 weeks and my intentions here are very clear all I want to do is give away all the value that people charge thousands of dollars for completely for free because I truly believe that we need more SAS developers in this world I believe that anyone can scale from $0 to $10,000 per month and the best way for me to do that is to build the application for you that's exactly what I did I spent two to three months I did every single thing and I gave it away for free so you now have access to every single thing all that's left for you to do now is start you need to start getting customers start helping people and launch your SAS the most difficult part in your SAS Journey is already done for you I have invested thousands of dollars into the production of this video that way you can get access to all of this free value and not have to invest even a single dime or waste any of your time this way you have zero excuses to take action and hopefully in the future when you're ready to scale to the moon and once you've hit 10 20 or even $30,000 per month through your SAS that's when yours truly can come in and I can essentially invest my time and my energy into your SAS company and help you scale to the Moon okay that's pretty much it guys I hope you enjoyed this video and I will see you in the next one